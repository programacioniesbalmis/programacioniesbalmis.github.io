<!DOCTYPE html><html><head>
      <title>Programación 1º DAM Unidad 17</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css">
      
      
      
      
      
      <style>
      @import url(https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css);
code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAfIAAsAAAAADDAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAARAAAAFZW7kosY21hcAAAAYAAAADTAAACjtP6ytBnbHlmAAACVAAAAxgAAAQ4zRtvlGhlYWQAAAVsAAAALwAAADYRwZsnaGhlYQAABZwAAAAcAAAAJAeKAzxobXR4AAAFuAAAABIAAAA8OGQAAGxvY2EAAAXMAAAAIAAAACAG5AfwbWF4cAAABewAAAAfAAAAIAEfAERuYW1lAAAGDAAAAVcAAAKFkAhoC3Bvc3QAAAdkAAAAYgAAAK2vz7wkeJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkPsQ4gYGVgYOpk+kMAwNDP4RmfM1gxMjBwMDEwMrMgBUEpLmmMDgwVLy4xKzzX4chhrmK4QpQmBEkBwAZygyweJzFkr0NwjAQhZ+TEP6CRUfHBEwRUWaQTICyQbpMwRCskA5RUIONxG0RnnNpKAIV4qzPku/8c353ACYAYrIjCWCuMAh2ptf0/hiL3p/gyPUWa3osqlt0L1zu9r71z8dGrJRykFoauXQd932Lj5vhG+MjxGeYI8MKETObMpslf5EyP8tg+vHun5r539PvlvXzaVhRFVQDTPEWKVQR90KhnnC5Ek67vUKN4VuFasM/ldARj43CCkCsEjpJSoVVgRyU0GVSK6wUpFFCx8lFgX0BiXpRPQB4nE2TTWjcRhTH3xttpDhxN7uxPlp3u/FK7moRPixafRijNosxSw/LUsIwNcaEHPZggo/FmEKMCKWU4kNOOftQSlhE8alnH0Ix9BqWnHooPRrTQ0+mnu2bXTu2pPdGM9LM/6c3fwECTM4gBBMYQNqxzLrZAjqYSlqu2TAHZQA0/DQJH6FtzqGDnvbt4Ggwvzw/nL8EfH8kW0fsuRqhgWXZnY7M1picaUL7Du5BHeDzMIl83dAt016wH1qmvtSMo5R6YRJHTR//FXsff/nj/tc/5K9P5d+nP22+fFK5u7v3K39SW3y+OtDKO3L85vD09PD9z5X17a2N1g4tqk01RlqX7gyoEmnsWQtVr4rtZMmukEaFBZxzefkCn11cyKMLZgshRwgTYNoLNXCBz2ja7HvZG7hDpPSNfoo5vs0knK/9hb+rNpu+8kHPgk/Ao4kK3tWtTpSEtvkA9c+wE6UaUdwieNkaHg55tBEtRiEPw1s0+FtrtTcc9two2lhMknV7PZF/cs6+uUFTmpTGbEx7sQCPSLOttHS3GRltqp7SNzVSKzl6aWnZT/CX5k6/v9N3Hh8fHBwffJVjhrC6OgH5dkIt/tPsq+d/PD5Qz7G7efzq1THFjdZVPe/N6ulQ3JnDWSE5junsFsVIiFwL/htf1S5gJ3BfOcUxfHKLnzqpFpyfZ9cX+/5WB6a+Y0pHpzkNrYNVDwMsikK+y7WuLCRg/oFHkA8VT3rDg5ZnU6ktzzINymV0m74Xd5pfIGXyFeVEQSShkzqG7TBBa2OxVRKitLXv7h3uuftXnXq7lz2tZ/WnWa9dx9dCjDhHzmuVQATlmljr9dZErUydSo2Hbi/b1vXtrOeGCk2/8s3ZlO8+ueJT8BVlw5pGw2oYccdSiHHqx0RlabHqdNR9jAETl6PreJcPBnnfpTLnOQ8C3OV8AmQGzouV1iZdeb5SSIoVc8W8/kcDtksUH5FrU6/aqBqNWcMEzxG4DAQ14qRQhi9mWU0rzepKezbjfgCwQKxVYq5ajRgpRqy45CqwkJydcEkbTkvRz8P5/2ZpDTN4nGNgZGBgAOKb6v+/xvPbfGXgZmEAgeuB2kkI+v8bFgbmKiCXg4EJJAoAPyAKhQB4nGNgZGBg1vmvwxDDwgACQJKRARXwAwAzZQHQeJxjYQCCFAYGFgbSMQAcWACdAAAAAAAAAAwALgBgAIQAmADSAQgBIgE8AVABoAHeAfwCHHicY2BkYGDgZ7BgYGMAASYg5gJCBob/YD4DAA/hAWQAeJxlkbtuwkAURMc88gApQomUJoq0TdIQzEOpUDokKCNR0BuzBiO/tF6QSJcPyHflE9Klyyekz2CuG8cr7547M3d9JQO4xjccnJ57vid2cMHqxDWc40G4Tv1JuEF+Fm6ijRfhM+oz4Ra6eBVu4wZvvMFpXLIa40PYQQefwjVc4Uu4Tv1HuEH+FW7i1mkKn6Hj3Am3sHC6wm08Ou8tpSZGe1av1PKggjSxPd8zJtSGTuinyVGa6/Uu8kxZludCmzxMEzV0B6U004k25W35fj2yNlCBSWM1paujKFWZSbfat+7G2mzc7weiu34aczzFNYGBhgfLfcV6iQP3ACkSaj349AxXSN9IT0j16JepOb01doiKbNWt1ovippz6sVYYwsXgX2rGVFIkq7Pl2PNrI6qW6eOshj0xaSq9mpNEZIWs8LZUfOouNkVXxp/d5woqebeYIf4D2J1ywQB4nG3LOw6AIBAE0B384B+PAkgEa+QwNnYmHt+EpXSal5lkSBBnoP8oCFSo0aCFRIceA0ZMmLFAYSW88rmvtMUjG3RiQ9HvpfusM6zWNmtc5H/iPewha50tOt5PS/QBx2IeSwAA") format("woff")}.admonition{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);position:relative;margin:1.5625em 0;padding:0 1.2rem;border-left:.4rem solid rgba(68,138,255,.8);border-radius:.2rem;background-color:rgba(255,255,255,.05);overflow:auto}.admonition>p{margin-top:.8rem}.admonition>.admonition-title{margin:0 -1.2rem;padding:.8rem 1.2rem .8rem 3.6rem;border-bottom:1px solid rgba(68,138,255,.2);background-color:rgba(68,138,255,.1);font-weight:700}.admonition>.admonition-title:before{position:absolute;left:1.2rem;font-size:1.5rem;color:rgba(68,138,255,.8);content:"\E3C9"}.admonition>.admonition-title:before{font-family:Material Icons;font-style:normal;font-variant:normal;font-weight:400;line-height:2rem;text-transform:none;white-space:nowrap;speak:none;word-wrap:normal;direction:ltr}.admonition.abstract,.admonition.summary,.admonition.tldr{border-left-color:rgba(0,176,255,.8)}.admonition.abstract>.admonition-title,.admonition.summary>.admonition-title,.admonition.tldr>.admonition-title{background-color:rgba(0,176,255,.1);border-bottom-color:rgba(0,176,255,.2)}.admonition.abstract>.admonition-title:before,.admonition.summary>.admonition-title:before,.admonition.tldr>.admonition-title:before{color:#00b0ff;content:"\E8D2"}.admonition.hint,.admonition.tip{border-left-color:rgba(0,191,165,.8)}.admonition.hint>.admonition-title,.admonition.tip>.admonition-title{background-color:rgba(0,191,165,.1);border-bottom-color:rgba(0,191,165,.2)}.admonition.hint>.admonition-title:before,.admonition.tip>.admonition-title:before{color:#00bfa5;content:"\E80E"}.admonition.info,.admonition.todo{border-left-color:rgba(0,184,212,.8)}.admonition.info>.admonition-title,.admonition.todo>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.info>.admonition-title:before,.admonition.todo>.admonition-title:before{color:#00b8d4;content:"\E88E"}.admonition.check,.admonition.done,.admonition.success{border-left-color:rgba(0,200,83,.8)}.admonition.check>.admonition-title,.admonition.done>.admonition-title,.admonition.success>.admonition-title{background-color:rgba(0,200,83,.1);border-bottom-color:rgba(0,200,83,.2)}.admonition.check>.admonition-title:before,.admonition.done>.admonition-title:before,.admonition.success>.admonition-title:before{color:#00c853;content:"\E876"}.admonition.faq,.admonition.help,.admonition.question{border-left-color:rgba(100,221,23,.8)}.admonition.faq>.admonition-title,.admonition.help>.admonition-title,.admonition.question>.admonition-title{background-color:rgba(100,221,23,.1);border-bottom-color:rgba(100,221,23,.2)}.admonition.faq>.admonition-title:before,.admonition.help>.admonition-title:before,.admonition.question>.admonition-title:before{color:#64dd17;content:"\E887"}.admonition.attention,.admonition.caution,.admonition.warning{border-left-color:rgba(255,145,0,.8)}.admonition.attention>.admonition-title,.admonition.caution>.admonition-title,.admonition.warning>.admonition-title{background-color:rgba(255,145,0,.1);border-bottom-color:rgba(255,145,0,.2)}.admonition.attention>.admonition-title:before{color:#ff9100;content:"\E417"}.admonition.caution>.admonition-title:before,.admonition.warning>.admonition-title:before{color:#ff9100;content:"\E002"}.admonition.fail,.admonition.failure,.admonition.missing{border-left-color:rgba(255,82,82,.8)}.admonition.fail>.admonition-title,.admonition.failure>.admonition-title,.admonition.missing>.admonition-title{background-color:rgba(255,82,82,.1);border-bottom-color:rgba(255,82,82,.2)}.admonition.fail>.admonition-title:before,.admonition.failure>.admonition-title:before,.admonition.missing>.admonition-title:before{color:#ff5252;content:"\E14C"}.admonition.bug,.admonition.danger,.admonition.error{border-left-color:rgba(255,23,68,.8)}.admonition.bug>.admonition-title,.admonition.danger>.admonition-title,.admonition.error>.admonition-title{background-color:rgba(255,23,68,.1);border-bottom-color:rgba(255,23,68,.2)}.admonition.danger>.admonition-title:before{color:#ff1744;content:"\E3E7"}.admonition.error>.admonition-title:before{color:#ff1744;content:"\E14C"}.admonition.bug>.admonition-title:before{color:#ff1744;content:"\E868"}.admonition.example,.admonition.snippet{border-left-color:rgba(0,184,212,.8)}.admonition.example>.admonition-title,.admonition.snippet>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.example>.admonition-title:before,.admonition.snippet>.admonition-title:before{color:#00b8d4;content:"\E242"}.admonition.cite,.admonition.quote{border-left-color:rgba(158,158,158,.8)}.admonition.cite>.admonition-title,.admonition.quote>.admonition-title{background-color:rgba(158,158,158,.1);border-bottom-color:rgba(158,158,158,.2)}.admonition.cite>.admonition-title:before,.admonition.quote>.admonition-title:before{color:#9e9e9e;content:"\E244"}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v28/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
@page a4landscape {
  size: A4 landscape;
  margin: 1cm;
}
@page a4portrait {
  size: A4 portrait;
  margin: 1cm 1cm 2.5cm 1cm;
}
.markdown-preview.markdown-preview .landscape {
  page: a4landscape;
}
.markdown-preview.markdown-preview .portrait {
  page: a4portrait;
}
.markdown-preview.markdown-preview .box_bg_lightgray {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .box_bg_lightgreen {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .salida_consola {
  background-color: #000000;
  color: aquamarine;
  border: 3px solid slategrey;
  padding-top: 15px;
  padding-bottom: 15px;
  padding-left: 10px;
  padding-right: 10px;
  margin-top: 10px;
  margin-bottom: 10px;
  border-radius: 5px;
  box-shadow: 3px 3px 6px 0 slategrey;
  font-family: "Lucida Console", Courier, monospace;
  font-size: 0.8rem;
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://balmisdigigs.github.io/digitalizacion.github.io/imagenes/fondos/quote.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: center;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    justify-content: space-between;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}
.markdown-preview.markdown-preview .galeria_imagenes {
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .galeria_imagenes {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .code-block-wrapper {
  position: relative;
  margin: 16px 0;
}
.markdown-preview.markdown-preview .copy-button {
  position: absolute;
  top: 8px;
  right: 8px;
  padding: 6px 12px;
  background-color: #2196F3;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  font-family: Arial, sans-serif;
  opacity: 0;
  transition: opacity 0.3s, background-color 0.2s;
  z-index: 10;
}
.markdown-preview.markdown-preview .code-block-wrapper:hover .copy-button {
  opacity: 1;
}
.markdown-preview.markdown-preview .copy-button:hover {
  background-color: #1976D2;
}
.markdown-preview.markdown-preview .copy-button:active {
  background-color: #0D47A1;
}
.markdown-preview.markdown-preview .copy-button.copied {
  background-color: #4CAF50;
}
.markdown-preview.markdown-preview .copy-button.copied::after {
  content: ' ✓';
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">

    // Configure Mermaid to load icon packs from Iconify

    const configureMermaidIconPacks = () => {
        window["mermaid"].registerIconPacks([
            {
                name: "logos",
                loader: () =>
                    fetch("https://unpkg.com/@iconify-json/logos@1/icons.json").then(
                        (res) => res.json()
                    ),
            },
        ]);
    };

    if (document.readyState !== 'loading') {
        configureMermaidIconPacks();
    } else {
        document.addEventListener("DOMContentLoaded", () => {
            configureMermaidIconPacks();
        });
    }

    // Copy to clipboard functionality for code blocks

    document.addEventListener('DOMContentLoaded', function () {
        initCopyButtons();
    });

    function initCopyButtons() {
        const codeBlocks = document.querySelectorAll('pre[data-role="codeBlock"]');

        codeBlocks.forEach(function (codeBlock) {
            const wrapper = document.createElement('div');
            wrapper.className = 'code-block-wrapper';
            codeBlock.parentNode.insertBefore(wrapper, codeBlock);
            wrapper.appendChild(codeBlock);

            const copyButton = document.createElement('button');
            copyButton.className = 'copy-button';
            copyButton.textContent = 'Copy';
            copyButton.setAttribute('aria-label', 'Copy code to clipboard');

            copyButton.addEventListener('click', function () {
                copyCodeToClipboard(codeBlock, copyButton);
            });

            wrapper.appendChild(copyButton);
        });
    }

    function copyCodeToClipboard(codeBlock, button) {
        const codeText = extractCodeText(codeBlock);
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(codeText)
                .then(function () {
                    showCopySuccess(button);
                })
                .catch(function (err) {
                    console.error('Failed to copy text: ', err);
                    fallbackCopyToClipboard(codeText, button);
                });
        } else {
            fallbackCopyToClipboard(codeText, button);
        }
    }

    function extractCodeText(codeBlock) {
        const clone = codeBlock.cloneNode(true);
        const text = clone.textContent || clone.innerText;
        return text.trim();
    }

    function fallbackCopyToClipboard(text, button) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.top = '0';
        textarea.style.left = '0';
        textarea.style.opacity = '0';

        document.body.appendChild(textarea);
        textarea.focus();
        textarea.select();

        try {
            const successful = document.execCommand('copy');
            if (successful) {
                showCopySuccess(button);
            } else {
                console.error('Fallback copy failed');
            }
        } catch (err) {
            console.error('Fallback copy error: ', err);
        }

        document.body.removeChild(textarea);
    }

    function showCopySuccess(button) {
        const originalText = button.textContent;

        button.textContent = 'Copied';
        button.classList.add('copied');

        setTimeout(function () {
            button.textContent = originalText;
            button.classList.remove('copied');
        }, 2000);
    }
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="unidad-17">Unidad 17 </h1>
<p>Descargar estos apunte en <a href="./u17_poo_gestion_de_errores.pdf">pdf</a> o <a href="./u17_poo_gestion_de_errores.html">html</a></p>
<h2 id="índice">Índice </h2>

<div class="md-toc">
<div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#índice" class="md-toc-link">
            <p>Índice</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#gestión-de-errores-en-poo" class="md-toc-link"><p>Gestión de errores en POO</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#introducción" class="md-toc-link">
            <p>Introducción</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#excepciones-en-csharp" class="md-toc-link"><p>Excepciones en CSharp</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#generación-de-excepciones" class="md-toc-link">
            <p>Generación de excepciones</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#captura-y-control-de-excepciones" class="md-toc-link">
            <p>Captura y control de excepciones</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#capturando-excepciones-diferentes" class="md-toc-link">
            <p>Capturando excepciones diferentes</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#liberando-recursos-con-finally" class="md-toc-link">
            <p>Liberando recursos con finally</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ejemplo-práctico-de-gestión-de-errores-en-poo" class="md-toc-link">
            <p>Ejemplo práctico de gestión de errores en POO</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#instrucción-using" class="md-toc-link">
            <p>Instrucción using</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#creando-nuestras-propias-excepciones" class="md-toc-link"><p>Creando nuestras propias excepciones</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ejemplo-de-creación-de-una-excepción-propia" class="md-toc-link">
            <p>Ejemplo de creación de una excepción propia</p>

          </a></div>
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#uso-inadecuado-de-las-excepciones" class="md-toc-link">
            <p>Uso inadecuado de las excepciones</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#excepciones-estándar-en-net" class="md-toc-link">
            <p>Excepciones estándar en .NET</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#anexo-i---ampliación-usando-encadenamiento-de-excepciones" class="md-toc-link"><p>Anexo I - Ampliación usando encadenamiento de excepciones</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#caso-de-uso-de-encadenamiento-de-excepciones" class="md-toc-link">
            <p>Caso de uso de encadenamiento de excepciones</p>

          </a></div>
        </div>
      </details>
    
</div>
<div style="page-break-after:always;"></div>
<h2 id="gestión-de-errores-en-poo">Gestión de errores en POO </h2>
<h3 id="introducción">Introducción </h3>
<p>Podemos decir que son la <strong>forma en que los lenguajes orientados a objetos realizan el control de errores</strong>.</p>
<p>Frente a la programación estructurada tradicional, nos ofrece:</p>
<ol>
<li><strong>Tratamiento asegurado</strong> de errores.</li>
<li>Posibilidad de recuperarnos de un error de forma <strong>centralizada</strong>.</li>
<li><strong>Claridad y simplicidad</strong>, ya que <strong>evitamos lógica adicional</strong> del caso de error.</li>
</ol>
<p>En la programación estructurada, el control de errores se hacía de forma <strong>dispersa</strong> y <strong>ad-hoc</strong> en cada módulo, lo que hacía que el código fuese más complejo y difícil de mantener.</p>
<p><strong>Con el control que hemos hecho hasta ahora con aserciones</strong>, no tenemos la posibilidad de recuperarnos de un error, ya que el programa finalizaba. Además, estas solo eran útiles en la fase de desarrollo y pruebas pues solo se producían con la versión de depuración.</p>
<div class="row">
<div class="col-sm-6 my-auto">
<p>Si por el contrario, intentábamos controlar los errores con <strong>códigos de error</strong> devueltos por los métodos, teníamos que añadir lógica adicional en cada módulo para comprobar si se había producido un error y actuar en consecuencia. Esto hacía que el código fuese más complejo y difícil de mantener como se puede ver en el diagrama de ejemplo donde se muestra una situación típica de la programación estructurada, el la cual si se producía un error en un módulo atómico como el <strong><code>Metodo3313()</code></strong> del ejemplo. Si queríamos recuperarnos del mismo en algún bucle de opciones por ejemplo en el <strong><code>Main()</code></strong>. El error debía propagarse hacia arriba a través de todos los módulos devolviéndose en todas las llamadas.</p>
</div>
<div class="col-sm-6">
<p></p><p align="center" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 12.2.0 (20241103.1931)
 -->
<!-- Title: G Pages: 1 -->
<svg width="250pt" height="250pt" viewBox="0.00 0.00 250.00 250.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.55 0.55) rotate(0) translate(9.93 447.67)">
<title>G</title>
<polygon fill="white" stroke="none" points="-9.93,6.87 -9.93,-447.67 444.62,-447.67 444.62,6.87 -9.93,6.87"></polygon>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<polygon fill="none" stroke="black" points="205.34,-436.8 151.34,-436.8 151.34,-400.8 205.34,-400.8 205.34,-436.8"></polygon>
<polygon fill="none" stroke="black" points="209.34,-440.8 147.34,-440.8 147.34,-396.8 209.34,-396.8 209.34,-440.8"></polygon>
<text text-anchor="middle" x="178.34" y="-414.6" font-family="Arial" font-size="14.00">main</text>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<polygon fill="none" stroke="black" points="93.69,-339.2 31,-339.2 31,-297.6 93.69,-297.6 93.69,-339.2"></polygon>
<text text-anchor="middle" x="62.34" y="-322.6" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="62.34" y="-305.8" font-family="Arial" font-size="14.00">1</text>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="gray" d="M153.17,-396.45C136,-381.88 113.09,-362.44 94.57,-346.74"></path>
<polygon fill="gray" stroke="gray" points="96.93,-344.15 87.04,-340.35 92.4,-349.49 96.93,-344.15"></polygon>
</g>
<!-- n2 -->
<g id="node3" class="node">
<title>n2</title>
<polygon fill="none" stroke="black" points="174.69,-339.2 112,-339.2 112,-297.6 174.69,-297.6 174.69,-339.2"></polygon>
<text text-anchor="middle" x="143.34" y="-322.6" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="143.34" y="-305.8" font-family="Arial" font-size="14.00">2</text>
</g>
<!-- n0&#45;&gt;n2 -->
<g id="edge2" class="edge">
<title>n0-&gt;n2</title>
<path fill="none" stroke="gray" d="M170.75,-396.45C165.9,-382.8 159.53,-364.9 154.15,-349.78"></path>
<polygon fill="gray" stroke="gray" points="157.6,-349.04 150.95,-340.79 151.01,-351.39 157.6,-349.04"></polygon>
</g>
<!-- n3 -->
<g id="node4" class="node">
<title>n3</title>
<polygon fill="none" stroke="black" points="295.69,-339.2 233,-339.2 233,-297.6 295.69,-297.6 295.69,-339.2"></polygon>
<text text-anchor="middle" x="264.34" y="-322.6" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="264.34" y="-305.8" font-family="Arial" font-size="14.00">3</text>
</g>
<!-- n0&#45;&gt;n3 -->
<g id="edge3" class="edge">
<title>n0-&gt;n3</title>
<path fill="none" stroke="gray" d="M190.68,-396.56C198.21,-384.43 208.46,-369.28 219.34,-357.2 222.5,-353.7 225.97,-350.24 229.55,-346.91"></path>
<polygon fill="gray" stroke="gray" points="231.7,-349.69 236.87,-340.44 227.06,-344.45 231.7,-349.69"></polygon>
</g>
<!-- n21 -->
<g id="node5" class="node">
<title>n21</title>
<polygon fill="none" stroke="black" points="62.69,-240 0,-240 0,-198.4 62.69,-198.4 62.69,-240"></polygon>
<text text-anchor="middle" x="31.34" y="-223.4" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="31.34" y="-206.6" font-family="Arial" font-size="14.00">2.1</text>
</g>
<!-- n2&#45;&gt;n21 -->
<g id="edge4" class="edge">
<title>n2-&gt;n21</title>
<path fill="none" stroke="gray" d="M120.14,-297.26C103.62,-282.92 81.22,-263.49 63.06,-247.72"></path>
<polygon fill="gray" stroke="gray" points="65.51,-245.22 55.66,-241.31 60.92,-250.5 65.51,-245.22"></polygon>
</g>
<!-- n22 -->
<g id="node6" class="node">
<title>n22</title>
<polygon fill="none" stroke="black" points="143.69,-240 81,-240 81,-198.4 143.69,-198.4 143.69,-240"></polygon>
<text text-anchor="middle" x="112.34" y="-223.4" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="112.34" y="-206.6" font-family="Arial" font-size="14.00">2.2</text>
</g>
<!-- n2&#45;&gt;n22 -->
<g id="edge5" class="edge">
<title>n2-&gt;n22</title>
<path fill="none" stroke="gray" d="M136.92,-297.26C132.68,-283.97 127.04,-266.29 122.24,-251.22"></path>
<polygon fill="gray" stroke="gray" points="125.59,-250.22 119.22,-241.76 118.92,-252.35 125.59,-250.22"></polygon>
</g>
<!-- n3&#45;&gt;n0 -->
<g id="edge20" class="edge">
<title>n3-&gt;n0</title>
<path fill="none" stroke="red" d="M250.32,-339.56C241.81,-351.37 230.47,-366.36 219.34,-378.8 216.41,-382.08 213.24,-385.42 210.02,-388.68"></path>
<polygon fill="red" stroke="red" points="207.75,-386 203.06,-395.5 212.65,-391 207.75,-386"></polygon>
<text text-anchor="middle" x="241.32" y="-362.6" font-family="Arial" font-size="18.00" fill="red">e</text>
</g>
<!-- n31 -->
<g id="node7" class="node">
<title>n31</title>
<polygon fill="none" stroke="black" points="224.69,-240 162,-240 162,-198.4 224.69,-198.4 224.69,-240"></polygon>
<text text-anchor="middle" x="193.34" y="-223.4" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="193.34" y="-206.6" font-family="Arial" font-size="14.00">3.1</text>
</g>
<!-- n3&#45;&gt;n31 -->
<g id="edge6" class="edge">
<title>n3-&gt;n31</title>
<path fill="none" stroke="gray" d="M249.63,-297.26C239.54,-283.45 225.99,-264.89 214.71,-249.45"></path>
<polygon fill="gray" stroke="gray" points="217.65,-247.55 208.93,-241.54 212,-251.68 217.65,-247.55"></polygon>
</g>
<!-- n32 -->
<g id="node8" class="node">
<title>n32</title>
<polygon fill="none" stroke="black" points="305.69,-240 243,-240 243,-198.4 305.69,-198.4 305.69,-240"></polygon>
<text text-anchor="middle" x="274.34" y="-223.4" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="274.34" y="-206.6" font-family="Arial" font-size="14.00">3.2</text>
</g>
<!-- n3&#45;&gt;n32 -->
<g id="edge7" class="edge">
<title>n3-&gt;n32</title>
<path fill="none" stroke="gray" d="M266.42,-297.26C267.77,-284.1 269.57,-266.63 271.11,-251.66"></path>
<polygon fill="gray" stroke="gray" points="274.58,-252.13 272.12,-241.82 267.62,-251.41 274.58,-252.13"></polygon>
</g>
<!-- n33 -->
<g id="node9" class="node">
<title>n33</title>
<polygon fill="none" stroke="black" points="386.69,-240 324,-240 324,-198.4 386.69,-198.4 386.69,-240"></polygon>
<text text-anchor="middle" x="355.34" y="-223.4" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="355.34" y="-206.6" font-family="Arial" font-size="14.00">3.3</text>
</g>
<!-- n3&#45;&gt;n33 -->
<g id="edge8" class="edge">
<title>n3-&gt;n33</title>
<path fill="none" stroke="gray" d="M283.2,-297.26C296.38,-283.18 314.16,-264.19 328.77,-248.58"></path>
<polygon fill="gray" stroke="gray" points="331.2,-251.11 335.48,-241.42 326.09,-246.33 331.2,-251.11"></polygon>
</g>
<!-- n221 -->
<g id="node10" class="node">
<title>n221</title>
<polygon fill="none" stroke="black" points="62.69,-140.8 0,-140.8 0,-99.2 62.69,-99.2 62.69,-140.8"></polygon>
<text text-anchor="middle" x="31.34" y="-124.2" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="31.34" y="-107.4" font-family="Arial" font-size="14.00">2.2.1</text>
</g>
<!-- n22&#45;&gt;n221 -->
<g id="edge9" class="edge">
<title>n22-&gt;n221</title>
<path fill="none" stroke="gray" d="M95.56,-198.06C83.94,-184.12 68.3,-165.34 55.36,-149.82"></path>
<polygon fill="gray" stroke="gray" points="58.17,-147.72 49.08,-142.28 52.79,-152.2 58.17,-147.72"></polygon>
</g>
<!-- n222 -->
<g id="node11" class="node">
<title>n222</title>
<polygon fill="none" stroke="black" points="143.69,-140.8 81,-140.8 81,-99.2 143.69,-99.2 143.69,-140.8"></polygon>
<text text-anchor="middle" x="112.34" y="-124.2" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="112.34" y="-107.4" font-family="Arial" font-size="14.00">2.2.2</text>
</g>
<!-- n22&#45;&gt;n222 -->
<g id="edge10" class="edge">
<title>n22-&gt;n222</title>
<path fill="none" stroke="gray" d="M112.34,-198.06C112.34,-184.9 112.34,-167.43 112.34,-152.46"></path>
<polygon fill="gray" stroke="gray" points="115.84,-152.63 112.34,-142.63 108.84,-152.63 115.84,-152.63"></polygon>
</g>
<!-- n223 -->
<g id="node12" class="node">
<title>n223</title>
<polygon fill="none" stroke="black" points="224.69,-140.8 162,-140.8 162,-99.2 224.69,-99.2 224.69,-140.8"></polygon>
<text text-anchor="middle" x="193.34" y="-124.2" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="193.34" y="-107.4" font-family="Arial" font-size="14.00">2.2.3</text>
</g>
<!-- n22&#45;&gt;n223 -->
<g id="edge11" class="edge">
<title>n22-&gt;n223</title>
<path fill="none" stroke="gray" d="M129.13,-198.06C140.75,-184.12 156.39,-165.34 169.33,-149.82"></path>
<polygon fill="gray" stroke="gray" points="171.9,-152.2 175.61,-142.28 166.52,-147.72 171.9,-152.2"></polygon>
</g>
<!-- n33&#45;&gt;n3 -->
<g id="edge19" class="edge">
<title>n33-&gt;n3</title>
<path fill="none" stroke="red" d="M348.02,-240.28C342.79,-252.64 334.83,-268.23 324.34,-279.6 318.84,-285.57 312.18,-290.98 305.34,-295.71"></path>
<polygon fill="red" stroke="red" points="303.76,-292.57 297.24,-300.92 307.55,-298.45 303.76,-292.57"></polygon>
<text text-anchor="middle" x="344.07" y="-263.4" font-family="Arial" font-size="18.00" fill="red">e</text>
</g>
<!-- n331 -->
<g id="node13" class="node">
<title>n331</title>
<polygon fill="none" stroke="black" points="353.69,-140.8 291,-140.8 291,-99.2 353.69,-99.2 353.69,-140.8"></polygon>
<text text-anchor="middle" x="322.34" y="-124.2" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="322.34" y="-107.4" font-family="Arial" font-size="14.00">3.3.1</text>
</g>
<!-- n33&#45;&gt;n331 -->
<g id="edge12" class="edge">
<title>n33-&gt;n331</title>
<path fill="none" stroke="gray" d="M344.19,-198.19C341.35,-192.55 338.5,-186.34 336.34,-180.4 333.09,-171.44 330.39,-161.44 328.26,-152.23"></path>
<polygon fill="gray" stroke="gray" points="331.72,-151.66 326.19,-142.62 324.88,-153.13 331.72,-151.66"></polygon>
</g>
<!-- n332 -->
<g id="node14" class="node">
<title>n332</title>
<polygon fill="none" stroke="black" points="434.69,-140.8 372,-140.8 372,-99.2 434.69,-99.2 434.69,-140.8"></polygon>
<text text-anchor="middle" x="403.34" y="-124.2" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="403.34" y="-107.4" font-family="Arial" font-size="14.00">3.3.2</text>
</g>
<!-- n33&#45;&gt;n332 -->
<g id="edge13" class="edge">
<title>n33-&gt;n332</title>
<path fill="none" stroke="gray" d="M365.29,-198.06C371.98,-184.51 380.93,-166.39 388.46,-151.13"></path>
<polygon fill="gray" stroke="gray" points="391.45,-152.99 392.74,-142.47 385.18,-149.89 391.45,-152.99"></polygon>
</g>
<!-- n331&#45;&gt;n33 -->
<g id="edge18" class="edge">
<title>n331-&gt;n33</title>
<path fill="none" stroke="red" d="M329.17,-141.11C333.73,-154.53 339.8,-172.43 344.96,-187.6"></path>
<polygon fill="red" stroke="red" points="341.49,-188.28 348.02,-196.63 348.12,-186.03 341.49,-188.28"></polygon>
<text text-anchor="middle" x="346.81" y="-164.2" font-family="Arial" font-size="18.00" fill="red">e</text>
</g>
<!-- n3311 -->
<g id="node15" class="node">
<title>n3311</title>
<polygon fill="none" stroke="black" points="254.69,-41.6 192,-41.6 192,0 254.69,0 254.69,-41.6"></polygon>
<text text-anchor="middle" x="223.34" y="-25" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="223.34" y="-8.2" font-family="Arial" font-size="14.00">3.3.1.1</text>
</g>
<!-- n331&#45;&gt;n3311 -->
<g id="edge14" class="edge">
<title>n331-&gt;n3311</title>
<path fill="none" stroke="gray" d="M301.83,-98.86C287.36,-84.65 267.79,-65.44 251.81,-49.75"></path>
<polygon fill="gray" stroke="gray" points="254.5,-47.48 244.91,-42.97 249.59,-52.48 254.5,-47.48"></polygon>
</g>
<!-- n3312 -->
<g id="node16" class="node">
<title>n3312</title>
<polygon fill="none" stroke="black" points="335.69,-41.6 273,-41.6 273,0 335.69,0 335.69,-41.6"></polygon>
<text text-anchor="middle" x="304.34" y="-25" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="304.34" y="-8.2" font-family="Arial" font-size="14.00">3.3.1.2</text>
</g>
<!-- n331&#45;&gt;n3312 -->
<g id="edge15" class="edge">
<title>n331-&gt;n3312</title>
<path fill="none" stroke="gray" d="M318.62,-98.86C316.15,-85.57 312.88,-67.89 310.09,-52.82"></path>
<polygon fill="gray" stroke="gray" points="313.61,-52.6 308.35,-43.4 306.72,-53.87 313.61,-52.6"></polygon>
</g>
<!-- n3313 -->
<g id="node17" class="node">
<title>n3313</title>
<polygon fill="none" stroke="black" points="416.69,-41.6 354,-41.6 354,0 416.69,0 416.69,-41.6"></polygon>
<text text-anchor="middle" x="385.34" y="-25" font-family="Arial" font-size="14.00">método</text>
<text text-anchor="middle" x="385.34" y="-8.2" font-family="Arial" font-size="14.00">3.3.1.3</text>
</g>
<!-- n331&#45;&gt;n3313 -->
<g id="edge16" class="edge">
<title>n331-&gt;n3313</title>
<path fill="none" stroke="gray" d="M333.5,-98.88C340.13,-87.22 348.88,-72.37 357.34,-59.6 359.16,-56.86 361.1,-54.04 363.08,-51.24"></path>
<polygon fill="gray" stroke="gray" points="365.91,-53.3 368.94,-43.15 360.24,-49.19 365.91,-53.3"></polygon>
</g>
<!-- n3313&#45;&gt;n331 -->
<g id="edge17" class="edge">
<title>n3313-&gt;n331</title>
<path fill="none" stroke="red" d="M377.7,-41.88C372.73,-53.79 365.64,-68.92 357.34,-81.2 355.29,-84.24 353,-87.27 350.6,-90.23"></path>
<polygon fill="red" stroke="red" points="348.09,-87.78 344.18,-97.63 353.37,-92.37 348.09,-87.78"></polygon>
<text text-anchor="middle" x="374.02" y="-65" font-family="Arial" font-size="18.00" fill="red">e</text>
</g>
</g>
</svg>
</p><p></p>
</div>
</div>
<p>Esto hacía, que muchos interfaces tuviesen que devolver información adicional con información sobre el error.</p>
<div style="page-break-after:always;"></div>
<h3 id="excepciones-en-csharp">Excepciones en CSharp </h3>
<p>Vale, ya podemos sustituir las aserciones por excepciones, pero... <strong>¿Cómo funcionan las excepciones en C#?</strong></p>
<p>Podemos decir que las excepciones en C# son <strong>objetos</strong> que <strong>contienen un estado con información sobre un error</strong> que se ha producido en tiempo de ejecución. Podemos destacar las siguientes características comunes a muchos lenguajes orientados a objetos:</p>
<ol>
<li>Todas derivan de la clase <strong><code>System.Exception</code></strong></li>
<li>Existen ya muchas <strong><a href="https://docs.microsoft.com/es-es/dotnet/standard/exceptions/?redirectedfrom=MSDN#common-exceptions">predefinidas</a></strong>.</li>
<li>Podemos definir <strong>excepciones propias</strong> mediante el mecanismo de herencia.</li>
</ol>
<h4 id="generación-de-excepciones">Generación de excepciones </h4>
<p>Utilizaremos la instrucción <strong><a href="https://docs.microsoft.com/es-es/dotnet/csharp/language-reference/keywords/throw">throw</a></strong> → <strong><code>throw new &lt;TipoExcepción&gt;(...);</code></strong></p>
<p>Veamos un <strong>ejemplo</strong> en el que vamos a usar la excepción ya predefinida <strong><a href="https://learn.microsoft.com/es-es/dotnet/api/system.argumentoutofrangeexception">ArgumentOutOfRangeException</a></strong> que indicará como su nombre sugiere que un argumento pasado a un método no está dentro del rango permitido.</p>
<p>En el tema anterior creamos una clase <strong><code>Empleado</code></strong> que tenía una propiedad <strong><code>Sueldo</code></strong>. Donde controlábamos, a través de una aserción en el <strong><code>set</code></strong> de la propiedad, que sueldo de un empleado estuviese entre 1200 y 3000 €.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Empleado</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IComparable</span><span class="token punctuation">,</span> <span class="token class-name">ICloneable</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name"><span class="token keyword keyword-double">double</span></span> _sueldo<span class="token punctuation">;</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-double">double</span></span> Sueldo
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-get">get</span> <span class="token operator">=&gt;</span> _sueldo<span class="token punctuation">;</span>
        <span class="token keyword keyword-set">set</span>
        <span class="token punctuation">{</span>
            Debug<span class="token punctuation">.</span><span class="token function">Assert</span><span class="token punctuation">(</span>
                <span class="token named-parameter punctuation">condition</span><span class="token punctuation">:</span> <span class="token keyword keyword-value">value</span> <span class="token operator">&gt;=</span> <span class="token number">1200D</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword keyword-value">value</span> <span class="token operator">&lt;=</span> <span class="token number">3000D</span><span class="token punctuation">,</span>
                <span class="token named-parameter punctuation">message</span><span class="token punctuation">:</span> <span class="token string">"El sueldo debe estar entre 1200 y 3000 euros"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            _sueldo <span class="token operator">=</span> <span class="token keyword keyword-value">value</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token range operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><p>Ahora vamos a sustituir la aserción por una excepción, de forma que si se intenta asignar un sueldo fuera de rango, se lance una excepción si lo deseamos podríamos recuperarnos del error, pero evitando que se asigne el valor erróneo al sueldo.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Empleado</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IComparable</span><span class="token punctuation">,</span> <span class="token class-name">ICloneable</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-private">private</span> <span class="token class-name"><span class="token keyword keyword-double">double</span></span> _sueldo<span class="token punctuation">;</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-double">double</span></span> Sueldo
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-get">get</span> <span class="token operator">=&gt;</span> _sueldo<span class="token punctuation">;</span>
        <span class="token keyword keyword-set">set</span>
        <span class="token punctuation">{</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token keyword keyword-value">value</span> <span class="token operator">&lt;</span> <span class="token number">1200D</span> <span class="token operator">||</span> <span class="token keyword keyword-value">value</span> <span class="token operator">&gt;</span> <span class="token number">3000D</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ArgumentOutOfRangeException</span><span class="token punctuation">(</span>
                    <span class="token named-parameter punctuation">paramName</span><span class="token punctuation">:</span> <span class="token keyword keyword-nameof">nameof</span><span class="token punctuation">(</span><span class="token keyword keyword-value">value</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token named-parameter punctuation">message</span><span class="token punctuation">:</span> <span class="token string">"El sueldo debe estar entre 1200 y 3000 euros"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            _sueldo <span class="token operator">=</span> <span class="token keyword keyword-value">value</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><p>Hemos creado un objeto en memoria del tipo <strong><code>ArgumentOutOfRangeException</code></strong> y lo hemos lanzado con la instrucción <strong><code>throw</code></strong> hacia algún punto de control.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>A partir de este momento, en todos los casos donde usábamos aserciones para controlar errores, <strong>deberemos sustituirlas por excepciones</strong>.</p>
</div>
<p>Otro ejemplo de uso de excepciones podría ser el <strong>control de casting</strong> donde hemos usado el operador <strong><code>o!</code></strong> para indicar <strong>que un objeto <code>o</code> anulable no es <code>null</code></strong> en ese punto del código.</p>
<p>Por ejemplo, cuando intentábamos hacer un downcast de una abstracción a una clase concreta con el operador <strong><code>as</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name">Articulo</span> a <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ArticuloReacondicionado</span><span class="token punctuation">(</span><span class="token string">"A005-R"</span><span class="token punctuation">,</span> <span class="token string">"iPhone 16 Pro"</span><span class="token punctuation">,</span> <span class="token number">950</span><span class="token punctuation">,</span> 
                                         <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token number">2025</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Foxconn"</span><span class="token punctuation">,</span> <span class="token string">"Cambio de batería"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Al usar ()! se generará una excepción de nulo si a no es del tipo ArticuloRebajado</span>
<span class="token comment">// pero no tenemos ningún control real de que estaba pasando.</span>
<span class="token class-name">ArticuloRebajado</span> ar <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token keyword keyword-as">as</span> <span class="token class-name">ArticuloRebajado</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>

<span class="token comment">// Ahora generamos una excepción más específica y además con un mensaje</span>
<span class="token comment">// que nos aporta más información.</span>
<span class="token class-name">ArticuloRebajado</span> ar <span class="token operator">=</span> a <span class="token keyword keyword-as">as</span> <span class="token class-name">ArticuloRebajado 
                      <span class="token punctuation">?</span></span><span class="token punctuation">?</span> <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">InvalidCastException</span><span class="token punctuation">(</span><span class="token named-parameter punctuation">message</span><span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">$"El artículo </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">a<span class="token punctuation">.</span>Id</span><span class="token punctuation">}</span></span><span class="token string"> no es un artículo rebajado."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h4 id="captura-y-control-de-excepciones">Captura y control de excepciones </h4>
<p>En la gran mayoría de lenguajes orientados a objetos se realiza con las palabras reservadas <strong><a href="https://docs.microsoft.com/es-es/dotnet/csharp/language-reference/keywords/try-catch">try y catch</a></strong>.</p>
<p>Una sintaxis básica de este tipo de estructura podría ser...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-try">try</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Código del que quiero controlar errores.</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">TipoDeLaExcepci</span>ó<span class="token class-name">nACapturar</span> e<span class="token punctuation">)</span> <span class="token keyword keyword-when">when</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>expresión con e<span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Tratamiento del error o excepción del tipo TipoDeLaExcepciónACapturar</span>
<span class="token punctuation">}</span>
</code></pre><p>Donde <strong><code>catch</code></strong> es un punto de control de errores, en el cual el identificador <strong><code>e</code></strong> será opcional y lo definiremos solo si lo vamos a usar <strong>dentro del bloque <code>catch</code></strong> o en una condición <strong><code>when</code></strong> (la condición <strong><code>when</code></strong> será <strong>opcional</strong> y específica del lenguaje C#).</p>
<p>Es importante tener en cuenta que no podremos, poner ningún bloque <strong><code>catch</code></strong> que no esté asociado a uno <strong><code>try</code></strong>. Además, en C# <strong><code>try</code></strong> y <strong><code>catch</code></strong> son <strong>instrucciones (statements)</strong> y no expresiones, por lo que <strong>no pueden</strong> formar parte de una expresión más grande o retornarse como valor de una función.</p>
<p>Veamos un ejemplo de sintaxis muy <strong>simple</strong> para ver cómo funcionan. Supongamos el siguiente código...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Introduce un número real: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> textoNumero <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-double">double</span></span> n <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>textoNumero<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Tu número es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">n</span><span class="token format-string"><span class="token punctuation">:</span>G</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Si lo ejecutamos e introducimos <strong><code>25</code></strong> obtendremos...</p>
<pre class="salida_consola">Introduce un número real: 25
Tu número es 25
</pre>
<p>Pero si introducimos el texto <strong><code>veinticinco</code></strong> obtendremos...</p>
<pre class="salida_consola">Introduce un número real: veinticinco
Unhandled exception. System.FormatException: Input string was not in a correct format.
   at System.Number.ThrowOverflowOrFormatException(ParsingStatus status, TypeCode type)
   at System.Double.Parse(String s)
   at EjemploExcepciones.EjemploExcepciones.Main() in C:\ejemplo\Program.cs:line 15
</pre>
<p>Si nos fijamos <strong><code>double.Parse(textoNumero);</code></strong> ha generado una excepción de tipo <strong><code>FormatException</code></strong> porque no ha podido pasar la cadena de entrada <strong><code>"veinticinco"</code></strong> a <strong><code>double</code></strong>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Para saber que errores/excepciones puede generar una llamada a un método, colocaremos el ratón sobre el método y mostrará una ventana emergente con la documentación del mismo donde se indicarán las excepciones que puede generar.<br>
<img src="assets/imagenes/ayuda_excepciones.png" alt="nombre" style="display:block;margin:0 auto;width:100%;max-width:500px;"><br>
También podemos hacer <strong><code>Ctrl + &lt;click izquierdo del ratón&gt;</code></strong> sobre el método y esto nos abrirá su definición y el la documentación del método podremos verlo.</p>
</div>
<p>En el ejemplo, la excepción ha sido capturada por el Runtime de C# (CLR), nos la ha mostrado y ha finalizado la ejecución. A efectos prácticos, <strong>es cómo si hubiera un bloque <code>try - catch</code> que englobara todo nuestro código y que <em>'barriera'</em> o capturase cualquier error/excepción que se pudiera producir aunque nosotros no lo hagamos</strong>.</p>
<p>Veamos cómo sería el código siguiendo la sintaxis del <strong><code>try - catch</code></strong> para capturar la excepción <strong><code>FormatException</code></strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Tendremos que definir la variable textoNumero fuera del bloque try </span>
    <span class="token comment">// e inicializarla si queremos que sea accesible desde el bloque catch.</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> textoNumero <span class="token operator">=</span> <span class="token string">"sin valor"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Introduce un número real: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        textoNumero <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> n <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>textoNumero<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Tu número es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">n</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">FormatException</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Como no usamos e no lo declaramos.</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Lo siento, el valor '</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">textoNumero</span><span class="token punctuation">}</span></span><span class="token string">' no es Real."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Si lo ejecutamos e introducimos <strong>'veinticinco'</strong> ahora obtendremos...</p>
<pre class="salida_consola">Introduce un número real: veinticinco
Lo siento, el valor 'veinticinco' no es Real.
</pre>
<p>También tendremos la opción de mostrar el mensaje de error que devuelven las BCL a través del <strong>objeto</strong> <strong><code>e</code></strong> que contiene la información de la excepción y que se creó al generarse la misma en el <strong><code>throw</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Introduce un número real: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> n <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Tu número es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">n</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">FormatException</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>        
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Mostrando el mensaje.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<p>Si lo ejecutamos e introducimos <strong>'veinticinco'</strong> ahora obtendremos...</p>
<pre class="salida_consola">Introduce un número real: veinticinco
Input string was not in a correct format.
</pre>
<p>Al especificar que capturamos solo la excepción <strong><code>FormatException</code></strong>, solo se entrará en este bloque catch si se produce la misma. Por tanto, cualquier otro error/excepción será capturado por el CLR.</p>
<h4 id="capturando-excepciones-diferentes">Capturando excepciones diferentes </h4>
<p>Si <strong><code>catch (FormatException e)</code></strong> solo captura las excepciones de formato de entrada incorrecto.</p>
<p><strong>¿Cómo haremos para controlar diferentes tipos errores/excepciones?</strong></p>
<p>Supongamos el siguiente <strong>ejemplo</strong> donde hemos creado un método <strong><code>Divide</code></strong> que genera una excepción <strong><code>DivideByZeroException</code></strong> al intentar dividir por cero. Pero si nos fijamos en el <strong><code>Main</code></strong> solo gestionamos <strong><code>FormatException</code></strong>.<br>
El programa principal nos pedirá 2 números e intentará dividirlos y si no puede finaliza.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-double">double</span></span> <span class="token function">Divide</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">&lt;</span> <span class="token number">1e-5</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">DivideByZeroException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Lanzamos la excepción</span>
    <span class="token keyword keyword-return">return</span> numerador <span class="token operator">/</span> divisor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Introduce el numerador: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Introduce el divisor: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"La división es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token function">Divide</span><span class="token punctuation">(</span>numerador<span class="token punctuation">,</span> divisor<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">FormatException</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Has introducido un valor que no es un número real."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<p>Al ejecutar el código e intentar dividir por cero obtendremos...</p>
<pre class="salida_consola">Introduce el numerador: 4
Introduce el divisor: 0
Unhandled exception. System.DivideByZeroException: Attempted to divide by zero.
   at EjemploExcepciones.EjemploExcepciones.Divide(Double numerador, Double divisor) in C:\ejemplo\Program.cs:line 11
   at EjemploExcepciones.EjemploExcepciones.Main() in C:\ejemplo\Program.cs:line 23
</pre>
<p>Si nos fijamos el programa finaliza porque la excepción es capturada por el <strong><code>catch</code></strong> del CLR.</p>
<p>Para capturar también este error, lo que haremos es añadir <strong>dos bloques</strong> <strong><code>catch</code></strong> <strong>consecutivos</strong> para el mismo bloque <strong><code>try</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-try">try</span>
<span class="token punctuation">{</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">FormatException</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Has introducido un valor que no es un número real."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">DivideByZeroException</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"No se puede dividir por cero."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Al ejecutar ahora, <strong>tendremos controlados los dos errores</strong>...</p>
<pre class="salida_consola">Ejecución 1:
    Introduce el numerador: 4
    Introduce el divisor: 0
    No se puede dividir por cero.

Ejecución 2:
    Introduce el numerador: 4
    Introduce el divisor: cero
    Has introducido un valor que no es un número real.

Ejecución 3:
    Introduce el numerador: 4
    Introduce el divisor: 2
    La división es 2
</pre>
<p>Si el <strong>tipo</strong> del primer bloque <strong><code>catch</code></strong> es una <strong>superclase</strong> del tipo del segundo. <strong>El segundo bloque catch nunca se ejecutará</strong> y además nos avisará con un <strong>error de compilación</strong>.</p>
<div style="page-break-after:always;"></div>
<p>Por ejemplo el siguiente código ...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-try">try</span>
<span class="token punctuation">{</span>
    <span class="token comment">//...</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">)</span> <span class="token comment">// Está cláusula catch nos producirá un error</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Hay un error."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">FormatException</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Has introducido un valor que no es un número real."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">DivideByZeroException</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"No se puede dividir por cero."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Generará el siguiente error ....</p>
<blockquote>
<p>❌ <em><strong>"Una cláusula catch previa ya detecta todas las excepciones de este tipo o de tipo superior ('Exception')"</strong></em></p>
</blockquote>
<p>ya que todas las excepciones heredan de <strong><code>Exception</code></strong> y por tanto <strong><code>FormatException</code></strong> y <strong><code>DivideByZeroException</code></strong> lo hacen. Lo cual implicaría que es un código inalcanzable, porque cualquier error entraría primero por el primer <strong><code>catch</code></strong>. De lo anterior se deduce que <strong>siempre podremos los <code>catch</code> excepciones más concretas primero</strong> y a continuación las excepciones más generales.</p>
<p>Si añadimos un único bloque <strong><code>catch (Exception e)</code></strong> en el <strong><code>Main</code></strong> controlaríamos cualquier error/excepción que se produjese y seguiríamos con nuestro bucle infinito.</p>
<div class="admonition warning">
<p class="admonition-title">Aviso</p>
<p>La <strong><a href="https://docs.microsoft.com/es-es/dotnet/standard/design-guidelines/using-standard-exception-types#exception-and-systemexception">documentación</a></strong> del lenguaje, no nos recomienda hacerlo fuera del <strong><code>Main</code></strong> por no ser una práctica que puede producir problemas.</p>
</div>
<div style="page-break-after:always;"></div>
<p>Por tanto, si probamos el siguiente código....</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Introduce el numerador: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Introduce el divisor: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> resultado <span class="token operator">=</span> <span class="token function">Divide</span><span class="token punctuation">(</span>numerador<span class="token punctuation">,</span> divisor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"La división es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">resultado</span><span class="token format-string"><span class="token punctuation">:</span>F2</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p><strong>También tendremos como resultado:</strong></p>
<pre class="salida_consola">Ejecución 1:
    Introduce el numerador: 4
    Introduce el divisor: 0
    Attempted to divide by zero.

Ejecución 2:
    Introduce el numerador: 4
    Introduce el divisor: cero
    Input string was not in a correct format.

Ejecución 3:
    Introduce el numerador: 4
    Introduce el divisor: 2
    La división es 2
</pre>
<div style="page-break-after:always;"></div>
<h4 id="liberando-recursos-con-finally">Liberando recursos con finally </h4>
<p>En ocasiones se pueden dar casos en los que queramos, <strong>independientemente de si ha producido un error o no</strong>, hacer algo siempre después de un bloque de instrucciones. Por ejemplo:</p>
<ul>
<li><strong>Liberar un recurso de memoria</strong> asociado a un fichero cómo una imagen o una fuente.</li>
<li><strong>Cerrar una conexión remota o a una base de datos</strong>, un fichero abierto por el sistema, etc.</li>
<li><strong>Parar algún proceso</strong> en paralelo iniciado.</li>
</ul>
<p>Para eso tendremos un bloque <strong><code>finally</code></strong> el cual es <strong>opcional</strong> y debe estar <strong>asociado a un bloque <code>try</code></strong>. Esto es, no necesita de un bloque <strong><code>catch</code></strong> para existir. Por tanto, libera o cierra los recursos usados dentro del un bloque <strong><code>try</code></strong> al que está asociado.</p>
<p>El bloque <strong><code>finally</code></strong> <strong>se ejecutará siempre</strong>, tanto si ha ido bien el bloque <strong><code>try</code></strong>, como si ha entrado por alguno de los bloques <strong><code>catch</code></strong> asociados al mismo o <strong>en un ámbito superior</strong>. Además, se <strong>ejecutará en último lugar</strong> respecto a sus bloques try-catch asociados en su ámbito.</p>
<p>En otras palabras, se puede tener un bloque <strong><code>try</code></strong> seguido de un <strong><code>finally</code></strong> (sin bloques catch), y realizar la captura de la excepción en un <strong><code>catch</code></strong> de ámbito más externo o incluso por el CLR. En este caso, el <strong><code>finally</code></strong> se ejecutará siempre y antes que el <strong><code>catch</code></strong> del ámbito superior.</p>
<p>Veamos en un simples ejemplos de código esquematizado.</p>
<div class="row d-flex justify-content-evenly">
<div class="col-sm-5 border rounded mb-3 shadow-sm">
<p>Caso más <em>'normal'</em> con <strong>try - catch - finally</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token comment">// Si correcto: BT -&gt; BF</span>
<span class="token comment">// Si error:    BT -&gt; BC -&gt; BF</span>
<span class="token keyword keyword-try">try</span>
<span class="token punctuation">{</span>
    <span class="token comment">// BT</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// BC</span>
<span class="token punctuation">}</span>               
<span class="token keyword keyword-finally">finally</span>
<span class="token punctuation">{</span>
    <span class="token comment">// BF</span>
<span class="token punctuation">}</span>
</code></pre></div>
<div class="col-sm-5 border rounded mb-3 shadow-sm">
<p><strong>finally sin catch...</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token comment">// Si correcto: BT1 -&gt; BT2 -&gt; BF2       </span>
<span class="token comment">// Si error:    BT1 -&gt; BT2 -&gt; BF2 -&gt; BC1</span>
<span class="token keyword keyword-try">try</span>
<span class="token punctuation">{</span>
    <span class="token comment">// BT1</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// BT2</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-finally">finally</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// BF2</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// BC1</span>
<span class="token punctuation">}</span>                                    
</code></pre></div>
</div>
<div style="page-break-after:always;"></div>
<h4 id="ejemplo-práctico-de-gestión-de-errores-en-poo">Ejemplo práctico de gestión de errores en POO </h4>
<p>En el siguiente ejemplo vamos a ver cómo plantear la gestión de errores/excepciones en una aplicación sencilla aplicando los conceptos vistos. Para ello, vamos a simular una aplicación de gestión de sesiones de usuario en un sistema remoto, donde se instancia algún tipo de recurso asociado a la sesión en el servidor que debe ser liberado al cerrar la sesión. Por ejemplo una máquina virtual, un contenedor, disco virtual, base de datos, etc.</p>
<p>Puedes descargar el código completo de este ejemplo desde el siguiente fichero: <strong><a href="assets/ejemplos/gestion_errores_con_recursos_ejemplo.cs">gestion_errores_con_recursos.cs</a></strong>.</p>
<p>Vamos a definir en primer lugar la clase <strong><code>Sesion</code></strong> que tendrá los métodos <strong><code>Login</code></strong> y <strong><code>Logout</code></strong> para iniciar y cerrar sesión respectivamente. Además, <strong>implementará la interfaz <code>IDisposable</code></strong> para liberar los recursos asociados a la sesión en el servidor. En esta clase se van a ir mostrando una serie de mensajes por consola a modo de log para ver lo que va ocurriendo.</p>
<p>Empezamos definiendo las propiedades <strong><code>Usuario</code></strong>, <strong><code>Clave</code></strong> e <strong><code>Iniciada</code></strong> en el constructor por defecto. Fíjate que no hace falta definir un constructor explícito, basta con inicializar las propiedades en su definición para ello.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Sesion</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IDisposable</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> Usuario <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword keyword-string">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
    <span class="token keyword keyword-private">private</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> Clave <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword keyword-string">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-bool">bool</span></span> Iniciada <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-private">private</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>En el método <strong><code>Login</code></strong> hay dos posibles errores que podemos controlar:</p>
<ol>
<li><strong>Que el usuario o la clave estén vacíos</strong>: En este caso usamos <strong>programación por contrato</strong> y tendremos una precondición donde lanzamos una excepción del tipo <strong><code>ArgumentException</code></strong> si alguno de los dos parámetros está vacío o es nulo.</li>
<li><strong>Que ya haya una sesión iniciada</strong>: En este caso, hemos usado <strong>programación defensiva</strong> y si ya hay una sesión iniciada, mostramos un mensaje por consola indicando que se cerrará la sesión actual liberando los recursos del servidor con <strong><code>Dispose()</code></strong> y se iniciará la nueva.<br>
<strong>En el caso de haber optado por programación por contrato</strong>, podríamos haber lanzado una excepción del tipo <strong><code>InvalidOperationException</code></strong> y sería <strong>quien llamase al método el que debería controlar que la sesión no estuviese iniciada</strong>.</li>
</ol>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Sesion</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IDisposable</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// ... código anterior</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Login</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> usuario<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-string">string</span></span> clave<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token keyword keyword-string">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>usuario<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword keyword-string">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrWhiteSpace</span><span class="token punctuation">(</span>clave<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ArgumentException</span><span class="token punctuation">(</span><span class="token string">"Usuario y clave no pueden estar vacíos."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>Iniciada<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Ya hay una sesión iniciada. Cerrando la sesión actual de </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Usuario</span><span class="token punctuation">}</span></span><span class="token string"> en servidor..."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        Usuario <span class="token operator">=</span> usuario<span class="token punctuation">;</span>
        Clave <span class="token operator">=</span> clave<span class="token punctuation">;</span>
        Iniciada <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Usuario </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Usuario</span><span class="token punctuation">}</span></span><span class="token string"> autenticado exitosamente. Registrando sesión en servidor..."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>En el método <strong><code>Logout</code></strong> si la sesión aplicamos la precondición de que <strong>debe haber una sesión iniciada</strong> para cerrarla. En caso contrario lanzamos una excepción del tipo <strong><code>InvalidOperationException</code></strong> el llamador debe controlar esta condición. Si la sesión está iniciada, mostramos un mensaje por consola y liberamos los recursos del servidor llamando a <strong><code>Dispose()</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Sesion</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IDisposable</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// ... código anterior</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Iniciada<span class="token punctuation">)</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">InvalidOperationException</span><span class="token punctuation">(</span><span class="token string">"No hay una sesión iniciada para cerrar."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Usuario </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Usuario</span><span class="token punctuation">}</span></span><span class="token string"> ha cerrado sesión."</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<p>Implementamos el método <strong><code>Dispose()</code></strong> de la interfaz <strong><code>IDisposable</code></strong> para liberar los recursos asociados a la sesión en el servidor y <strong>vaciamos el estado del objeto sesión si se ha quedado iniciada para evitar su uso</strong>. En este caso, simplemente mostramos un mensaje por consola y reiniciamos las propiedades de la clase. Más adelante veremos el <em><strong>'¿Por qué?'</strong></em> de implementar esta interfaz.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Sesion</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IDisposable</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// ... código anterior</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>Iniciada<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Liberando recursos de la sesión en el servidor..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Usuario <span class="token operator">=</span> <span class="token keyword keyword-string">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
            Clave <span class="token operator">=</span> <span class="token keyword keyword-string">string</span><span class="token punctuation">.</span>Empty<span class="token punctuation">;</span>
            Iniciada <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Definimos ahora una clase de utilidad <strong><code>RecursosProtegidos</code></strong>, que puedes encontrar más abajo, con dos métodos estáticos que simulan el acceso a recursos protegidos por sesión. Ambos métodos requieren como precondición de ejecución que la sesión esté iniciada para poder acceder así a los recursos. Si no es así, lanzan una excepción del tipo <strong><code>InvalidOperationException</code></strong>.</p>
<p>Fíjate que, a través de la documentación del método, es como se indica que el método debe cumplir la precondición de que la sesión esté iniciada. <strong>De esta forma, aunque no tengamos acceso porque está en una librería, el usuario llamador sabe que debe cumplir esta precondición para usarse sin errores</strong>.</p>
<div class="row">
<div class="col-sm-4">
<p>Como hemos comentado antes, al colocar el ratón sobre el método, se muestra la documentación del mismo y las precondiciones que debe cumplir el llamador.</p>
</div>
<div class="col-sm-8 my-auto">
<p><img src="./assets/imagenes/ayuda_excepciones2.png" alt="nombre" style="display:block;margin:0 auto;width:100%;max-width:700px;"></p>
</div>
</div>
<p>Fíjate además, que en <strong><code>AccederRecurso2</code> simulamos que se produce un error inesperado</strong> al acceder al recurso protegido lanzando una excepción del tipo **<code>InvalidOperationException</code> <strong>aunque la sesión esté iniciada</strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">RecursosProtegidos</span>
<span class="token punctuation">{</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// Accede a un recurso 1 protegido que requiere sesión iniciada.</span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sesion<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exception</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UnauthorizedAccessException<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exception</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>remarks</span><span class="token punctuation">&gt;</span></span>Si no hay una sesión iniciada, lanza UnauthorizedAccessException.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>remarks</span><span class="token punctuation">&gt;</span></span></span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">AccederRecurso1</span><span class="token punctuation">(</span><span class="token class-name">Sesion</span> sesion<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sesion<span class="token punctuation">.</span>Iniciada<span class="token punctuation">)</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">UnauthorizedAccessException</span><span class="token punctuation">(</span><span class="token string">"Acceso denegado a recurso protegido 1. No hay una sesión iniciada."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Acceso correcto a Recurso Protegido 1..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">AccederRecurso2</span><span class="token punctuation">(</span><span class="token class-name">Sesion</span> sesion<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>sesion<span class="token punctuation">.</span>Iniciada<span class="token punctuation">)</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">UnauthorizedAccessException</span><span class="token punctuation">(</span><span class="token string">"Acceso denegado a recurso protegido 2. No hay una sesión iniciada."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Acceso correcto a Recurso Protegido 2 se producirá un error inesperado ..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">InvalidOperationException</span><span class="token punctuation">(</span><span class="token string">"Se produjo un error inesperado al acceder al Recurso Protegido 2."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Por último, definimos el programa principal donde tendremos que tener en cuenta la gestión de errores/excepciones que se puedan producir en los diferentes métodos si se nos ha olvidado cumplir alguna precondición en la llamada.</p>
<p>Definimos en primer lugar un método estático <strong><code>Menu()</code></strong> que nos devolverá el menú de opciones a mostrar por consola.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> <span class="token function">Menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-return">return</span> <span class="token string">""</span>"
        <span class="token number">1</span><span class="token punctuation">.</span> Iniciar sesión
        <span class="token number">2</span><span class="token punctuation">.</span> Acceder a Recurso Protegido <span class="token number">1</span>
        <span class="token number">3</span><span class="token punctuation">.</span> Acceder a Recurso Protegido <span class="token number">2</span>
        <span class="token number">4</span><span class="token punctuation">.</span> Cerrar sesión
        <span class="token number">5</span><span class="token punctuation">.</span> Salir
        <span class="token string">""</span>"<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Veamos un poco la gestión del <strong><code>Main()</code></strong>, para ello, <strong>lee atentamente los comentarios del código</strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token comment">// ... código anterior</span>

    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Iniciamos la sesión fuera del try para que esté accesible</span>
        <span class="token class-name">Sesion</span> sesion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-try">try</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">Clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword keyword-bool">bool</span></span> salir <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-do">do</span>
            <span class="token punctuation">{</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">Menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Seleccione una opción: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword keyword-string">string</span><span class="token punctuation">?</span></span> opcion <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>

                <span class="token keyword keyword-switch">switch</span> <span class="token punctuation">(</span>opcion<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword keyword-case">case</span> <span class="token string">"1"</span><span class="token punctuation">:</span>
                        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Usuario: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> usuario <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>
                        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"Clave: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> clave <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>
                        sesion<span class="token punctuation">.</span><span class="token function">Login</span><span class="token punctuation">(</span>usuario<span class="token punctuation">,</span> clave<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span>
                    <span class="token keyword keyword-case">case</span> <span class="token string">"2"</span><span class="token punctuation">:</span>
                        <span class="token comment">// Debemos ser nosotros quienes verifiquemos si la sesión está iniciada antes de llamar al método</span>
                        <span class="token comment">// en optro caso, el método lanzaría una excepción por no cumplir la precondición de uso.</span>
                        <span class="token comment">// Podemos verlo en la documentación del método AccederRecurso1.</span>
                        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>sesion<span class="token punctuation">.</span>Iniciada<span class="token punctuation">)</span>
                            RecursosProtegidos<span class="token punctuation">.</span><span class="token function">AccederRecurso1</span><span class="token punctuation">(</span>sesion<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-else">else</span>
                            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Debe iniciar sesión antes de acceder al recurso protegido 1."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span>
                    <span class="token keyword keyword-case">case</span> <span class="token string">"3"</span><span class="token punctuation">:</span>
                        <span class="token comment">// Aquí no verificamos si la sesión está iniciada, para demostrar que el método lanza una excepción</span>
                        <span class="token comment">// si no se cumple la precondición de uso.</span>
                        RecursosProtegidos<span class="token punctuation">.</span><span class="token function">AccederRecurso2</span><span class="token punctuation">(</span>sesion<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span>
                    <span class="token keyword keyword-case">case</span> <span class="token string">"4"</span><span class="token punctuation">:</span>
                        <span class="token comment">// Cerrar sesión si está iniciada. Como antes, si queremos recuperanos del error,</span>
                        <span class="token comment">// este es el punto donde debemos hacerlo y no en el método Logout.</span>
                        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>sesion<span class="token punctuation">.</span>Iniciada<span class="token punctuation">)</span>
                            sesion<span class="token punctuation">.</span><span class="token function">Logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-else">else</span>
                            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"No hay una sesión iniciada para cerrar."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span>
                    <span class="token keyword keyword-case">case</span> <span class="token string">"5"</span><span class="token punctuation">:</span>
                        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Saliendo de la aplicación..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        salir <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span>
                    <span class="token keyword keyword-default">default</span><span class="token punctuation">:</span>
                        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Opción no válida. Intente nuevamente."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword keyword-break">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>salir<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>        
        <span class="token punctuation">{</span>
            <span class="token comment">// Gestion de errores centralizada.</span>
            <span class="token comment">// no se debe usar como control de flujo, sino para capturar errores inesperados.</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error inesperado: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">e<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-finally">finally</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Siempre se ejecuta, haya o no error.</span>
            <span class="token comment">// Nos aseguramos de liberar los recursos de la sesión.</span>
            sesion<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Ejemplo de ejecución <strong>produciendo un error inesperado una ves iniciada la sesión</strong>...</p>
<pre class="salida_consola">1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 1
Usuario: Juan
Clave: 1234
Usuario Juan autenticado exitosamente. Registrando sesión en servidor...
1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 3
Acceso correcto a Recurso Protegido 2 se producirá un error inesperado ...
Error inesperado: Se produjo un error inesperado al acceder al Recurso Protegido 2.
Liberando recursos de la sesión en el servidor...
</pre>
<p>Fíjate como se ejecuta el bloque <strong><code>finally</code></strong> liberando los recursos de la sesión en el servidor, aunque se haya producido un error inesperado al acceder al recurso protegido 2.</p>
<p>Ejemplo de ejecución <strong>intentando acceder a un recurso protegido sin tener iniciar sesión</strong>...</p>
<pre class="salida_consola">1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 1
Usuario: Maria
Clave: 1234
Usuario Maria autenticado exitosamente. Registrando sesión en servidor...
1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 2
Acceso correcto a Recurso Protegido 1...
1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 4
Usuario Maria ha cerrado sesión.
Liberando recursos de la sesión en el servidor...
1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 2
Debe iniciar sesión antes de acceder al recurso protegido 1.
1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 4
No hay una sesión iniciada para cerrar.
1. Iniciar sesión
2. Acceder a Recurso Protegido 1
3. Acceder a Recurso Protegido 2
4. Cerrar sesión
5. Salir
Seleccione una opción: 3
Error inesperado: Acceso denegado a recurso protegido 2. No hay una sesión iniciada.
</pre>
<p>Fíjate como hemos liberado bien al hacer logout y controlado por lógica (if-else) todos los posibles errores menos el caso de acceso sin iniciar sesión al recurso protegido 2.</p>
<div style="page-break-after:always;"></div>
<h4 id="instrucción-using">Instrucción using </h4>
<p>Se utiliza para instanciar objetos que contienen recursos no gestionados, esto es, que no son liberados por el recolector de basura. Para poder usarla, las clases que definen los objetos deben implementar el interfaz <strong><code>IDisposable</code></strong> y por tanto el método de liberación <strong><code>Dispose()</code></strong>.</p>
<p><strong><code>using</code></strong> garantiza que se llama a  <strong><code>Dispose()</code></strong> <strong>aunque se produzca una excepción</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Aviso</p>
<p>Dentro del bloque using, el objeto es de solo lectura y no se puede modificar ni reasignar puesto que dejaría de tener una referencia y no se liberaría.</p>
</div>
<p><strong>Sintaxis clásica:</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token comment">// Podemos usar varios recursos liberables en el mismo ámbito así ...</span>
<span class="token keyword keyword-using">using</span> <span class="token punctuation">(</span><span class="token class-name">TipoIDisposable</span> r1 <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token keyword keyword-using">using</span> <span class="token punctuation">(</span><span class="token class-name">TipoIDisposable</span> r2 <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token range operator">..</span><span class="token punctuation">.</span>
<span class="token keyword keyword-using">using</span> <span class="token punctuation">(</span><span class="token class-name">TipoIDisposable</span> rN <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token comment">// Ámbito de uso de solo lectura de r1, r2, … , rN</span>
<span class="token punctuation">}</span>

<span class="token comment">// También podremos anidarlos.</span>
</code></pre><p><strong>Sintaxis moderna:</strong></p>
<p>En la <strong><a href="https://docs.microsoft.com/es-es/dotnet/csharp/language-reference/proposals/csharp-8.0/using">documentación oficial</a></strong> sugiere que usemos un bloque ya definido como ámbito para el recurso liberable. Si esta dentro de un método, se liberará al salir del método y por ejemplo en un bloque <strong><code>if</code></strong> se liberará al salir del mismo.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>…<span class="token punctuation">)</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword keyword-using">using</span> <span class="token class-name">TipoIDisposable</span> r <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Bloque... </span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<p><strong>Interpretación real de la instrucción <code>using</code>:</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token comment">// Cuando instanciemos un objeto disposable de la siguiente manera en un método...</span>
<span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Metodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name">TipoIDisposable</span> r <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Cuerpo del método ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// Realmente será un 'syntactic sugar' del siguiente código.</span>
<span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Metodo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">TipoIDisposable</span> r<span class="token punctuation">;</span>
    <span class="token keyword keyword-try">try</span> 
    <span class="token punctuation">{</span>
        r <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Cuerpo del método ...</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-finally">finally</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>r <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> 
            <span class="token punctuation">(</span><span class="token punctuation">(</span>IDisposable<span class="token punctuation">)</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Ejemplo de uso de <strong><code>using</code></strong> con la clase <strong><code>Sesion</code></strong> del ejemplo anterior.</p>
<div class="row">
<div class="col-sm-6">
<p><strong>Podemos cambiar este código...</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code>    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Sesion</span> sesion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-try">try</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// ... código de la aplicación</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// ... manejo de excepciones</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-finally">finally</span>
        <span class="token punctuation">{</span>
            sesion<span class="token punctuation">.</span><span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div>
<div class="col-sm-6">
<p><strong>Por este otro.</strong> Donde la sesion se liberará automáticamente al salir del ámbito del <strong><code>try</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-using">using</span> <span class="token class-name">Sesion</span> sesion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ... código de la aplicación</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// ... manejo de excepciones</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>
<div style="page-break-after:always;"></div>
<h4 id="creando-nuestras-propias-excepciones">Creando nuestras propias excepciones </h4>
<p>En ocasiones nos interesará crear nuestras propias excepciones para <strong>capturar errores de tipos de excepciones específicos</strong> en nuestras clases, a la hora de <strong>pasar test por ejemplo</strong>.</p>
<p>En este caso las definiremos el tipo de la excepción nosotros y heredando de una excepción ya creada si queremos concertarla más o de la clase base para excepciones <strong><code>System.Exception</code></strong>.</p>
<h5 id="ejemplo-de-creación-de-una-excepción-propia">Ejemplo de creación de una excepción propia </h5>
<p>El convenio en C# es acabar el nombre del tipo de nuestra excepción con el sufijo <em><strong><code>Exception</code></strong></em> y en este ejemplo lo hemos hecho.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">EmpresaException</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Exception</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token function">EmpresaException</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> message<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword keyword-base">base</span> <span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>En el código de arriba hemos creado una excepción <strong><code>EmpresaException</code></strong> que usaré para saber cuando se ha producido un error dentro de una clase <strong><code>Empresa</code></strong>.</p>
<p>Ahora supongamos un método para imprimir nóminas de un departamento dentro de <strong><code>Empresa</code></strong>, donde no hemos contemplado un departamento de reciente creación como <strong><code>Marketing</code></strong> en el siguiente código.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-enum">enum</span> <span class="token class-name">Departamento</span> <span class="token punctuation">{</span> Contable<span class="token punctuation">,</span> Desarrollo<span class="token punctuation">,</span> Marketing <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Empresa</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">ImprimeNominas</span><span class="token punctuation">(</span><span class="token class-name">Departamento</span> departamento<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> datosNominas <span class="token operator">=</span> departamento <span class="token keyword keyword-switch">switch</span>
        <span class="token punctuation">{</span>
            Departamento<span class="token punctuation">.</span>Contable <span class="token operator">=&gt;</span> <span class="token string">"Datos nóminas contabilidad."</span><span class="token punctuation">,</span>
            Departamento<span class="token punctuation">.</span>Desarrollo <span class="token operator">=&gt;</span> <span class="token string">"Datos nóminas desarrollo."</span><span class="token punctuation">,</span>
            _ <span class="token operator">=&gt;</span> <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">EmpresaException</span><span class="token punctuation">(</span>
                        <span class="token interpolation-string"><span class="token string">$"No se pueden imprimir nóminas de este departamento de </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">departamento</span><span class="token punctuation">}</span></span><span class="token string">."</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>datosNominas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Otra posibilidad es crear excepciones personalizadas más concretas para una clase. Una forma de hacerlo sería <strong>definir la excepción más concreta de forma anidada dentro de la clase</strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Empresa</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Definición de un tipo anidado</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">GestionNominasException</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Exception</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-public">public</span> <span class="token function">GestionNominasException</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> message<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword keyword-base">base</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">ImprimeNominas</span><span class="token punctuation">(</span><span class="token class-name">Departamentos</span> departamento<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> datosNominas <span class="token operator">=</span> departamento <span class="token keyword keyword-switch">switch</span>
        <span class="token punctuation">{</span>
            Departamentos<span class="token punctuation">.</span>Contable <span class="token operator">=&gt;</span> <span class="token string">"Imprimiendo nóminas contabilidad."</span><span class="token punctuation">,</span>
            Departamentos<span class="token punctuation">.</span>Desarrollo <span class="token operator">=&gt;</span> <span class="token string">"Imprimiendo nóminas Desarrollo."</span><span class="token punctuation">,</span>
            <span class="token comment">// El tipo de la excepción es más especifico</span>
            <span class="token comment">// y su definición está dentro de empresa.</span>
            _ <span class="token operator">=&gt;</span> <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Empresa<span class="token punctuation">.</span>GestionNominasException</span><span class="token punctuation">(</span>
                        <span class="token interpolation-string"><span class="token string">$"No se pueden imprimir nóminas de este departamento de </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">departamento</span><span class="token punctuation">}</span></span><span class="token string">."</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>datosNominas<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Fíjate que al estar anidada en el tipo <strong><code>Empresa.GestionNominasException</code></strong> queda claro que es una excepción relacionada con la clase <strong><code>Empresa</code></strong>.</p>
<div class="row">
<div class="col-sm-6">
<p><strong>Ejemplo de uso de excepción general de la clase</strong>:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-var">var</span></span> d <span class="token keyword keyword-in">in</span> Enum<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetValues</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Departamento<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        Empresa<span class="token punctuation">.</span><span class="token function">ImprimeNominas</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">EmpresaException</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<div class="col-sm-6">
<p><strong>Ejemplo de uso de excepción específica anidada</strong>:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-var">var</span></span> d <span class="token keyword keyword-in">in</span> Enum<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetValues</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Departamento<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        Empresa<span class="token punctuation">.</span><span class="token function">ImprimeNominas</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Empresa<span class="token punctuation">.</span>GestionNominasException</span> ex<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Error: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ex<span class="token punctuation">.</span>Message</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>
<p>Pudes descargar el código completo de este ejemplo desde el siguiente fichero: <strong><a href="assets/ejemplos/excepcion_personalidada_ejemplo.cs">excepcion_personalidada.cs</a></strong>.</p>
<div style="page-break-after:always;"></div>
<h4 id="uso-inadecuado-de-las-excepciones">Uso inadecuado de las excepciones </h4>
<p>En ocasiones usar adecuadamente las excepciones es complicado incluso para programadores <strong>experimentados</strong>, y se han de establecer convenios y patrones en los equipos de desarrollo.</p>
<p>Aunque en este curso no vamos tratar más que los conceptos básicos. Si deseas profundizar, en el <strong><a href="https://docs.microsoft.com/es-es/dotnet/standard/design-guidelines/exception-throwing">siguiente enlace</a></strong> puedes encontrar una serie de <strong>instrucciones para la correcta generación  de excepciones descritas en la documentación oficial</strong>. Que además de ser una lectura complementaria interesante, puede ser <strong>extrapolable a otros lenguajes</strong>.</p>
<p>De entre los consejos del enlace anterior, destacaremos un uso incorrecto de las excepciones que se suele dar con frecuencia en programadores noveles y que debemos evitar.</p>
<div class="admonition warning">
<p class="admonition-title">Cuidado</p>
<p><strong>No utilice excepciones para el flujo de control normal, si es posible.</strong></p>
</div>
<p>Veamos <strong>un ejemplo similar al del inicio</strong> del tema, donde queríamos pedir dos números y mostrar su división.</p>
<p>Un código algo más modularizado, pero sin gestión de excepciones sería el siguiente:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Consola</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-double">double</span></span> <span class="token function">Lee</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> etiqueta<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">etiqueta</span><span class="token punctuation">}</span></span><span class="token string">: "</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-return">return</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Principal</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el numerador"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el divisor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"La división es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">numerador <span class="token operator">/</span> divisor</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<div class="box_bg_lightgray">
<p>❌ <strong>Código a evitar</strong></p>
<p>Si ahora nos piden filtrar la entrada de datos, para que no se generase error al producirse una entrada correcta. Una tentación sería implementar el método <strong><code>Lee</code></strong> de la siguiente forma...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-double">double</span></span> <span class="token function">Lee</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> etiqueta<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> textoEntrada <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-double">double</span><span class="token punctuation">?</span></span> valor <span class="token operator">=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-do">do</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-try">try</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">etiqueta</span><span class="token punctuation">}</span></span><span class="token string">: "</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            textoEntrada <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">""</span><span class="token punctuation">;</span>
            valor <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>textoEntrada<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">FormatException</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"El valor introducido </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">textoEntrada</span><span class="token punctuation">}</span></span><span class="token string">"</span></span> <span class="token operator">+</span> 
                              <span class="token string">"no es un valor real válido."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-while">while</span><span class="token punctuation">(</span>valor <span class="token operator">==</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span><span class="token keyword keyword-double">double</span><span class="token punctuation">)</span>valor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>En esta implementación, utilizamos excepciones para el <strong>control del flujo de código</strong> y no para una situación de error. Las excepciones deben reservarse para situaciones excepcionales y si está en nuestra mano generarlas en un determinado contexto, debemos hacerlo.</p>
</div>
<p><strong>¿Cual sería la implementación correcta del código anterior para no hacerlo?</strong></p>
<div style="page-break-after:always;"></div>
<div class="box_bg_lightgray">
<p>✅ <strong>Código recomendado</strong></p>
<p>La documentación oficial nos propone usar el <strong><a href="https://docs.microsoft.com/es-es/dotnet/standard/design-guidelines/exceptions-and-performance#try-parse-pattern">patrón try-parse</a></strong> en su lugar, de la siguiente forma...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-double">double</span></span> <span class="token function">Lee</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> etiqueta<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-double">double</span></span> valor<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-bool">bool</span></span> error<span class="token punctuation">;</span>

    <span class="token keyword keyword-do">do</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">etiqueta</span><span class="token punctuation">}</span></span><span class="token string">: "</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> textoEntrada <span class="token operator">=</span> Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">""</span><span class="token punctuation">;</span>
        error <span class="token operator">=</span> <span class="token keyword keyword-double">double</span><span class="token punctuation">.</span><span class="token function">TryParse</span><span class="token punctuation">(</span>textoEntrada<span class="token punctuation">,</span> <span class="token keyword keyword-out">out</span> valor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"El valor introducido </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">textoEntrada</span><span class="token punctuation">}</span></span><span class="token string">"</span></span> <span class="token operator">+</span> 
                              <span class="token string">"no es un valor real válido."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-while">while</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> valor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<div class="contenedor">
    <div class="fondo">
        <div class="abre_comilla">"</div>
        <div class="cierra_comilla">"</div>
        <div class="cita">It's hard enough to find an error in your code when you're looking for it; it's even harder when you've assumed your code is error-free.</div>
        <div class="autor">- Steve McConnell.</div>
    </div>
</div>
<div style="page-break-after:always;"></div>
<p>En el caso del programa principal, si nos piden controlar la división por cero, una mala práctica sería hacerlo a través de excepciones.</p>
<div class="box_bg_lightgray">
<p>❌ <strong>Código a evitar</strong></p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-double">double</span><span class="token punctuation">?</span></span> division <span class="token operator">=</span> <span class="token keyword keyword-default">default</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-do">do</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-try">try</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el numerador"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el divisor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">DivideByZeroException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            division <span class="token operator">=</span> numerador <span class="token operator">/</span> divisor<span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"La división es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">division</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span><span class="token punctuation">(</span><span class="token class-name">DivideByZeroException</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"No se puede dividir por cero.\n"</span> <span class="token operator">+</span>
                              <span class="token string">"Introduzca de nuevo los valores."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>division <span class="token operator">==</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="admonition tip">
<p class="admonition-title">Idea</p>
<p>En este caso <strong>es fácil de ver</strong>, porque en el ámbito del bucle do-while, estamos lanzando una excepción <strong><code>throw new DivideByZeroException();</code></strong> y capturándose en el mismo ámbito con <strong><code>catch(DivideByZeroException)</code></strong>. Cunando suceda esto, debe saltarnos una alarma ⚠️.</p>
</div>
</div>
<p><strong>¿Cual sería la implementación correcta del código anterior para no hacerlo?</strong></p>
<div style="page-break-after:always;"></div>
<div class="box_bg_lightgray">
<p>✅ <strong>Código recomendado</strong></p>
<p>Siempre es más correcto usar lógica de control (<strong>if-else</strong>) para estos casos. Por ejemplo, podríamos hacerlo de la siguiente forma...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-bool">bool</span></span> errorDivisionPorCero<span class="token punctuation">;</span>
    <span class="token keyword keyword-do">do</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el numerador"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el divisor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorDivisionPorCero <span class="token operator">=</span> divisor <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> textoError <span class="token operator">=</span> errorDivisionPorCero                    
                            <span class="token punctuation">?</span> <span class="token interpolation-string"><span class="token string">$"No se puede dividir por cero.\nIntroduzca de nuevo los valores."</span></span>
                            <span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">$"La división es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">numerador <span class="token operator">/</span> divisor</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>textoError<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>errorDivisionPorCero<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Vale, pero... <strong>¿Y si la división se hace en una función aparte que no es nuestra y ya no se ve tan claramente que el <strong><code>throw</code></strong> y <strong><code>catch</code></strong> de la misma excepción están en el mismo ámbito?</strong></p>
<div class="contenedor">
    <div class="fondo">
        <div class="abre_comilla">"</div>
        <div class="cierra_comilla">"</div>
        <div class="cita">If you're good at the debugger it means you spent a lot of time debugging. I don't want you to be good at the debugger.</div>
        <div class="autor">- Robert C. Martin.</div>
    </div>
</div>
<div style="page-break-after:always;"></div>
<div class="box_bg_lightgray">
<p>✅ <strong>Código recomendado</strong></p>
<p>Es código sería exactamente igual, pero ahora es la función <strong><code>Divide</code></strong> quien tiene una precondición de que el divisor no sea cero y en caso contrario lanza una excepción. Pero nosotros, como llamadores del método, debemos cumplir esa precondición y no llamar al método si el divisor es cero. <strong>La función debería estar documentada indicando esa precondición</strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// Divide dos números, lanzando una excepción si el divisor es cero.</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>returns</span><span class="token punctuation">&gt;</span></span>El cociente resultado de la división.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>returns</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exception</span> <span class="token attr-name">cref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>DivideByZeroException<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exception</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>remarks</span><span class="token punctuation">&gt;</span></span>El divisor se considera cero si es menor que 1e-5.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>remarks</span><span class="token punctuation">&gt;</span></span></span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-double">double</span></span> <span class="token function">Divide</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>divisor <span class="token operator">&lt;</span> <span class="token number">1e-5</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">DivideByZeroException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-return">return</span> numerador <span class="token operator">/</span> divisor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-bool">bool</span></span> errorDivisionPorCero<span class="token punctuation">;</span>
    <span class="token keyword keyword-do">do</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> numerador <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el numerador"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-double">double</span></span> divisor <span class="token operator">=</span> Consola<span class="token punctuation">.</span><span class="token function">Lee</span><span class="token punctuation">(</span><span class="token string">"Introduce el divisor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        errorDivisionPorCero <span class="token operator">=</span> divisor <span class="token operator">&lt;</span> <span class="token number">1e-5</span><span class="token punctuation">;</span>
        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> textoError <span class="token operator">=</span> errorDivisionPorCero
                            <span class="token punctuation">?</span> <span class="token interpolation-string"><span class="token string">$"No se puede dividir por cero.\nIntroduzca de nuevo los valores."</span></span>
                            <span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">$"La división es </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token function">Divide</span><span class="token punctuation">(</span>numerador<span class="token punctuation">,</span> divisor<span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>textoError<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>errorDivisionPorCero<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Fíjate que es similar al esquema que hemos seguido cuando hemos gestionado las excepciones en el ejemplo de las sesiones de usuario. Donde hemos cumplido las precondiciones de los métodos que lanzaban excepciones y <strong>no hemos usado excepciones para el control del flujo del programa</strong>.</p>
</div>
<p>Puedes descargar el código completo de este ejemplo desde el siguiente fichero: <strong><a href="assets/ejemplos/gestion_errores_correcta_ejemplo.cs">gestion_errores_correcta.cs</a></strong>.</p>
<div style="page-break-after:always;"></div>
<h4 id="excepciones-estándar-en-net">Excepciones estándar en .NET </h4>
<p>La <strong><a href="https://docs.microsoft.com/es-es/dotnet/standard/design-guidelines/using-standard-exception-types">documentación oficial</a></strong>, nos proporciona unas recomendaciones de uso de excepciones estándar ya definidas por las propias BCL.<br>
Fíjate que algunas <strong>no</strong> son recomendables capturarlas, lanzarlas o derivarlas.</p>
<p>Aunque cuando necesitemos lanzar algún tipo de excepción estándar se te indicará en el enunciado. En el siguiente diagrama tienes un resumen <strong>simplificado</strong> de las principales excepciones en .NET y las recomendaciones de uso del cuadro anterior.</p>
<p></p><p align="center" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 12.2.0 (20241103.1931)
 -->
<!-- Title: G Pages: 1 -->
<svg width="525pt" height="200pt" viewBox="0.00 0.00 525.00 200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.3 0.3) rotate(0) translate(59.36 599.33)">
<title>G</title>
<polygon fill="white" stroke="none" points="-59.36,67.33 -59.36,-599.33 1690.64,-599.33 1690.64,67.33 -59.36,67.33"></polygon>
<!-- Exception -->
<g id="node1" class="node">
<title>Exception</title>
<polygon fill="none" stroke="black" points="860.57,-430 860.57,-528 1048.88,-528 1048.88,-430 860.57,-430"></polygon>
<text text-anchor="start" x="921.28" y="-495.4" font-family="Arial" font-weight="bold" font-size="14.00">Exception</text>
<text text-anchor="start" x="919.71" y="-481.4" font-family="Arial" font-size="14.00">No generar</text>
<text text-anchor="start" x="903.76" y="-467.4" font-family="Arial" font-size="14.00">Evitar capturarla</text>
<text text-anchor="start" x="881.57" y="-453.4" font-family="Arial" font-size="14.00">Regenerar si capturada</text>
</g>
<!-- SystemException -->
<g id="node2" class="node">
<title>SystemException</title>
<polygon fill="none" stroke="black" points="750.57,-288 750.57,-386 938.88,-386 938.88,-288 750.57,-288"></polygon>
<text text-anchor="start" x="786.37" y="-353.4" font-family="Arial" font-weight="bold" font-size="14.00">SystemException</text>
<text text-anchor="start" x="809.71" y="-339.4" font-family="Arial" font-size="14.00">No generar</text>
<text text-anchor="start" x="793.76" y="-325.4" font-family="Arial" font-size="14.00">Evitar capturarla</text>
<text text-anchor="start" x="771.57" y="-311.4" font-family="Arial" font-size="14.00">Regenerar si capturada</text>
</g>
<!-- SystemException&#45;&gt;Exception -->
<g id="edge1" class="edge">
<title>SystemException-&gt;Exception</title>
<path fill="none" stroke="black" d="M885.37,-389.73C892.35,-398.61 899.66,-407.91 906.81,-417.01"></path>
<polygon fill="none" stroke="black" points="904.01,-419.12 912.94,-424.82 909.52,-414.8 904.01,-419.12"></polygon>
</g>
<!-- ApplicationException -->
<g id="node3" class="node">
<title>ApplicationException</title>
<polygon fill="none" stroke="black" points="973.17,-295 973.17,-379 1158.29,-379 1158.29,-295 973.17,-295"></polygon>
<text text-anchor="start" x="994.17" y="-346.4" font-family="Arial" font-weight="bold" font-size="14.00">ApplicationException</text>
<text text-anchor="start" x="1030.71" y="-332.4" font-family="Arial" font-size="14.00">No generar</text>
<text text-anchor="start" x="1030.71" y="-318.4" font-family="Arial" font-size="14.00">No heredar</text>
</g>
<!-- ApplicationException&#45;&gt;Exception -->
<g id="edge2" class="edge">
<title>ApplicationException-&gt;Exception</title>
<path fill="none" stroke="black" d="M1030.3,-382.68C1021.5,-393.78 1011.93,-405.85 1002.64,-417.57"></path>
<polygon fill="none" stroke="black" points="1000.03,-415.23 996.56,-425.24 1005.51,-419.58 1000.03,-415.23"></polygon>
</g>
<!-- ArgumentException -->
<g id="node4" class="node">
<title>ArgumentException</title>
<polygon fill="none" stroke="black" points="284.22,-146 284.22,-244 459.23,-244 459.23,-146 284.22,-146"></polygon>
<text text-anchor="start" x="305.22" y="-211.4" font-family="Arial" font-weight="bold" font-size="14.00">ArgumentException</text>
<text text-anchor="start" x="339.04" y="-197.4" font-family="Arial" font-size="14.00">Generable</text>
<text text-anchor="start" x="315.71" y="-183.4" font-family="Arial" font-size="14.00">Usar </text>
<text text-anchor="start" x="349.16" y="-183.4" font-family="Arial" font-style="italic" font-size="14.00">ParamName</text>
<text text-anchor="start" x="338.27" y="-169.4" font-family="Arial" font-size="14.00">Usar </text>
<text text-anchor="start" x="371.72" y="-169.4" font-family="Arial" font-style="italic" font-size="14.00">value</text>
</g>
<!-- ArgumentException&#45;&gt;SystemException -->
<g id="edge3" class="edge">
<title>ArgumentException-&gt;SystemException</title>
<path fill="none" stroke="black" d="M467.06,-235.76C478.66,-240.11 490.41,-244.3 501.73,-248 577.43,-272.74 664.34,-294.97 731.74,-310.9"></path>
<polygon fill="none" stroke="black" points="730.8,-314.28 741.33,-313.16 732.4,-307.46 730.8,-314.28"></polygon>
</g>
<!-- ArithmeticException -->
<g id="node5" class="node">
<title>ArithmeticException</title>
<polygon fill="none" stroke="black" points="518.66,-165.6 518.66,-224.4 696.8,-224.4 696.8,-165.6 518.66,-165.6"></polygon>
<text text-anchor="start" x="539.66" y="-191.8" font-family="Arial" font-weight="bold" font-size="14.00">ArithmeticException</text>
</g>
<!-- ArithmeticException&#45;&gt;SystemException -->
<g id="edge4" class="edge">
<title>ArithmeticException-&gt;SystemException</title>
<path fill="none" stroke="black" d="M662.4,-228.29C687.58,-243.17 718.23,-261.28 747.17,-278.37"></path>
<polygon fill="none" stroke="black" points="745.21,-281.28 755.6,-283.35 748.77,-275.25 745.21,-281.28"></polygon>
</g>
<!-- IndexOutOfRangeException -->
<g id="node6" class="node">
<title>IndexOutOfRangeException</title>
<polygon fill="none" stroke="black" points="730.77,-160 730.77,-230 958.68,-230 958.68,-160 730.77,-160"></polygon>
<text text-anchor="start" x="751.77" y="-197.4" font-family="Arial" font-weight="bold" font-size="14.00">IndexOutOfRangeException</text>
<text text-anchor="start" x="809.71" y="-183.4" font-family="Arial" font-size="14.00">No generar</text>
</g>
<!-- IndexOutOfRangeException&#45;&gt;SystemException -->
<g id="edge5" class="edge">
<title>IndexOutOfRangeException-&gt;SystemException</title>
<path fill="none" stroke="black" d="M844.73,-233.89C844.73,-245.85 844.73,-259.41 844.73,-272.65"></path>
<polygon fill="none" stroke="black" points="841.23,-272.64 844.73,-282.64 848.23,-272.64 841.23,-272.64"></polygon>
</g>
<!-- NullReferenceException -->
<g id="node7" class="node">
<title>NullReferenceException</title>
<polygon fill="none" stroke="black" points="992.2,-160 992.2,-230 1195.25,-230 1195.25,-160 992.2,-160"></polygon>
<text text-anchor="start" x="1013.2" y="-197.4" font-family="Arial" font-weight="bold" font-size="14.00">NullReferenceException</text>
<text text-anchor="start" x="1058.71" y="-183.4" font-family="Arial" font-size="14.00">No generar</text>
</g>
<!-- NullReferenceException&#45;&gt;SystemException -->
<g id="edge6" class="edge">
<title>NullReferenceException-&gt;SystemException</title>
<path fill="none" stroke="black" d="M1026.34,-233.89C1001.84,-247.66 973.58,-263.56 946.75,-278.64"></path>
<polygon fill="none" stroke="black" points="945.26,-275.46 938.26,-283.41 948.69,-281.56 945.26,-275.46"></polygon>
</g>
<!-- IOException -->
<g id="node8" class="node">
<title>IOException</title>
<polygon fill="none" stroke="black" points="1228.89,-165.6 1228.89,-224.4 1352.57,-224.4 1352.57,-165.6 1228.89,-165.6"></polygon>
<text text-anchor="start" x="1249.89" y="-191.8" font-family="Arial" font-weight="bold" font-size="14.00">IOException</text>
</g>
<!-- IOException&#45;&gt;SystemException -->
<g id="edge7" class="edge">
<title>IOException-&gt;SystemException</title>
<path fill="none" stroke="black" d="M1249.71,-228.29C1238.3,-235.87 1225.5,-243.14 1212.73,-248 1108.3,-287.74 1068.78,-253.46 957.77,-283.69"></path>
<polygon fill="none" stroke="black" points="956.91,-280.3 948.26,-286.41 958.83,-287.03 956.91,-280.3"></polygon>
</g>
<!-- ArgumentNullException -->
<g id="node9" class="node">
<title>ArgumentNullException</title>
<polygon fill="none" stroke="black" points="8,-4 8,-102 209.46,-102 209.46,-4 8,-4"></polygon>
<text text-anchor="start" x="29" y="-69.4" font-family="Arial" font-weight="bold" font-size="14.00">ArgumentNullException</text>
<text text-anchor="start" x="76.04" y="-55.4" font-family="Arial" font-size="14.00">Generable</text>
<text text-anchor="start" x="52.71" y="-41.4" font-family="Arial" font-size="14.00">Usar </text>
<text text-anchor="start" x="86.16" y="-41.4" font-family="Arial" font-style="italic" font-size="14.00">ParamName</text>
<text text-anchor="start" x="75.27" y="-27.4" font-family="Arial" font-size="14.00">Usar </text>
<text text-anchor="start" x="108.72" y="-27.4" font-family="Arial" font-style="italic" font-size="14.00">value</text>
</g>
<!-- ArgumentNullException&#45;&gt;ArgumentException -->
<g id="edge8" class="edge">
<title>ArgumentNullException-&gt;ArgumentException</title>
<path fill="none" stroke="black" d="M206.29,-105.93C225.92,-116.38 246.64,-127.41 266.52,-138"></path>
<polygon fill="none" stroke="black" points="264.71,-141 275.18,-142.61 268,-134.82 264.71,-141"></polygon>
</g>
<!-- ArgumentOutOfRangeException -->
<g id="node10" class="node">
<title>ArgumentOutOfRangeException</title>
<polygon fill="none" stroke="black" points="243,-4 243,-102 500.46,-102 500.46,-4 243,-4"></polygon>
<text text-anchor="start" x="264" y="-69.4" font-family="Arial" font-weight="bold" font-size="14.00">ArgumentOutOfRangeException</text>
<text text-anchor="start" x="339.04" y="-55.4" font-family="Arial" font-size="14.00">Generable</text>
<text text-anchor="start" x="315.71" y="-41.4" font-family="Arial" font-size="14.00">Usar </text>
<text text-anchor="start" x="349.16" y="-41.4" font-family="Arial" font-style="italic" font-size="14.00">ParamName</text>
<text text-anchor="start" x="338.27" y="-27.4" font-family="Arial" font-size="14.00">Usar </text>
<text text-anchor="start" x="371.72" y="-27.4" font-family="Arial" font-style="italic" font-size="14.00">value</text>
</g>
<!-- ArgumentOutOfRangeException&#45;&gt;ArgumentException -->
<g id="edge9" class="edge">
<title>ArgumentOutOfRangeException-&gt;ArgumentException</title>
<path fill="none" stroke="black" d="M371.73,-105.73C371.73,-113.87 371.73,-122.37 371.73,-130.73"></path>
<polygon fill="none" stroke="black" points="368.23,-130.5 371.73,-140.5 375.23,-130.5 368.23,-130.5"></polygon>
</g>
<!-- DivideByZeroException -->
<g id="node11" class="node">
<title>DivideByZeroException</title>
<polygon fill="none" stroke="black" points="534.15,-23.6 534.15,-82.4 733.3,-82.4 733.3,-23.6 534.15,-23.6"></polygon>
<text text-anchor="start" x="555.15" y="-49.8" font-family="Arial" font-weight="bold" font-size="14.00">DivideByZeroException</text>
</g>
<!-- DivideByZeroException&#45;&gt;ArithmeticException -->
<g id="edge10" class="edge">
<title>DivideByZeroException-&gt;ArithmeticException</title>
<path fill="none" stroke="black" d="M627.76,-86.12C624.2,-105.33 619.62,-129.98 615.74,-150.87"></path>
<polygon fill="none" stroke="black" points="612.33,-150.07 613.94,-160.54 619.21,-151.35 612.33,-150.07"></polygon>
</g>
<!-- EndOfStremException -->
<g id="node12" class="node">
<title>EndOfStremException</title>
<polygon fill="none" stroke="black" points="966.44,-23.6 966.44,-82.4 1157.02,-82.4 1157.02,-23.6 966.44,-23.6"></polygon>
<text text-anchor="start" x="987.44" y="-49.8" font-family="Arial" font-weight="bold" font-size="14.00">EndOfStremException</text>
</g>
<!-- EndOfStremException&#45;&gt;IOException -->
<g id="edge11" class="edge">
<title>EndOfStremException-&gt;IOException</title>
<path fill="none" stroke="black" d="M1118.86,-86.21C1147.31,-102.53 1182.09,-122.89 1212.73,-142 1219.56,-146.26 1226.67,-150.82 1233.69,-155.41"></path>
<polygon fill="none" stroke="black" points="1231.63,-158.24 1241.91,-160.81 1235.48,-152.39 1231.63,-158.24"></polygon>
</g>
<!-- FileNotFoundException -->
<g id="node13" class="node">
<title>FileNotFoundException</title>
<polygon fill="none" stroke="black" points="1191.18,-23.6 1191.18,-82.4 1390.28,-82.4 1390.28,-23.6 1191.18,-23.6"></polygon>
<text text-anchor="start" x="1212.18" y="-49.8" font-family="Arial" font-weight="bold" font-size="14.00">FileNotFoundException</text>
</g>
<!-- FileNotFoundException&#45;&gt;IOException -->
<g id="edge12" class="edge">
<title>FileNotFoundException-&gt;IOException</title>
<path fill="none" stroke="black" d="M1290.73,-86.12C1290.73,-105.24 1290.73,-129.75 1290.73,-150.58"></path>
<polygon fill="none" stroke="black" points="1287.23,-150.52 1290.73,-160.52 1294.23,-150.52 1287.23,-150.52"></polygon>
</g>
<!-- FileLoadException -->
<g id="node14" class="node">
<title>FileLoadException</title>
<polygon fill="none" stroke="black" points="1424.18,-23.6 1424.18,-82.4 1623.28,-82.4 1623.28,-23.6 1424.18,-23.6"></polygon>
<text text-anchor="start" x="1445.18" y="-49.8" font-family="Arial" font-weight="bold" font-size="14.00">FileNotFoundException</text>
</g>
<!-- FileLoadException&#45;&gt;IOException -->
<g id="edge13" class="edge">
<title>FileLoadException-&gt;IOException</title>
<path fill="none" stroke="black" d="M1469.98,-86.29C1435.44,-107.05 1390.4,-134.11 1354.11,-155.91"></path>
<polygon fill="none" stroke="black" points="1352.67,-152.7 1345.91,-160.85 1356.28,-158.7 1352.67,-152.7"></polygon>
</g>
</g>
</svg>
</p><p></p>
<div style="page-break-after:always;"></div>
<h2 id="anexo-i---ampliación-usando-encadenamiento-de-excepciones">Anexo I - Ampliación usando encadenamiento de excepciones </h2>
<p>En ocasiones, puedo tener la necesidad de crear un bloque <strong><code>catch</code></strong> para capturar una excepción en un ámbito, añadir un <strong>mensaje específico para ese ámbito</strong> y posteriormente <strong>relanzarla</strong> para ser capturada en otro ámbito superior. Además, este proceso se puede repetir de forma sucesiva.</p>
<p>La mayoría de constructores de excepciones de las BCL, admiten una sobrecarga con el parámetro <strong>Exception <a href="https://docs.microsoft.com/es-es/dotnet/api/system.exception.innerexception?view=net-5.0">innerException</a></strong>. (a NULL por defecto).</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-try">try</span> 
<span class="token punctuation">{</span>
    <span class="token comment">// Ámbito del try</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExcepcionTipoA</span> e<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token comment">// En este punto de control de excepciones capturamos la excepción</span>
    <span class="token comment">// del tipo ExcepcionTipoA y añadimos un mensaje específico de lo</span>
    <span class="token comment">// que estamos haciendo en el ámbito del try y la relanzamos a un</span>
    <span class="token comment">// catch en un ámbito superior donde puede haber otro punto</span>
    <span class="token comment">// de control o de recuperación de excepciones.</span>
    <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ExcepcionTipoA</span><span class="token punctuation">(</span><span class="token string">"mensaje específico en ámbito del try"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Fíjate que en al hacer <strong><code>throw new ExcepcionTipoA("mensaje específico en ámbito del try", e);</code></strong> estamos creando otro objeto <strong><code>ExcepcionTipoA</code></strong> al que le pasamos una referencia al objeto <strong><code>ExcepcionTipoA e</code></strong>, donde nos llegaba la información del error. Esto me permitirá recorrer todos los objetos excepción encadenados en el orden que se han ido relanzando y así acceder a mensajes específicos en cada ámbito.</p>
<div class="contenedor">
    <div class="fondo">
        <div class="abre_comilla">"</div>
        <div class="cierra_comilla">"</div>
        <div class="cita">Truth can only be found in one place: the code.</div>
        <div class="autor">- Robert C. Martin.</div>
    </div>
</div>
<div style="page-break-after:always;"></div>
<h3 id="caso-de-uso-de-encadenamiento-de-excepciones">Caso de uso de encadenamiento de excepciones </h3>
<p>Veamos un caso de uso de encadenamiento de excepciones a través del siguiente esquema, donde desde el Main se iría llamando a métodos de diferentes objetos para realizar una tarea. Tenemos un <strong><code>Método_D</code></strong> que es usado en <strong>dos ramas diferentes de la pila de llamadas</strong> y que puede generar la excepción/error <strong><code>E</code></strong></p>
<p></p><p align="center" class="dot"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?-->

<!-- Generated by graphviz version 12.2.0 (20241103.1931)
 -->
<!-- Title: G Pages: 1 -->
<svg width="525pt" height="450pt" viewBox="0.00 0.00 525.00 450.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.6 0.6) rotate(0) translate(21.5 733.6)">
<title>G</title>
<!-- n0 -->
<g id="node1" class="node">
<title>n0</title>
<polygon fill="snow" stroke="gray" points="360.87,-713.2 251.13,-713.2 251.13,-617.2 360.87,-617.2 360.87,-713.2"></polygon>
<polygon fill="none" stroke="gray" points="364.87,-717.2 247.13,-717.2 247.13,-613.2 364.87,-613.2 364.87,-717.2"></polygon>
<text text-anchor="middle" x="306" y="-686.2" font-family="Arial" font-size="14.00" fill="red">Main</text>
<text text-anchor="middle" x="306" y="-669.4" font-family="Arial" font-size="14.00" fill="red">Punto de</text>
<text text-anchor="middle" x="306" y="-652.6" font-family="Arial" font-size="14.00" fill="red">recuperación</text>
<text text-anchor="middle" x="306" y="-635.8" font-family="Arial" font-size="14.00" fill="red">catch E</text>
</g>
<!-- n1 -->
<g id="node2" class="node">
<title>n1</title>
<polygon fill="whitesmoke" stroke="gray" points="214,-561.8 160,-561.8 160,-525.8 214,-525.8 214,-561.8"></polygon>
</g>
<!-- n0&#45;&gt;n1 -->
<g id="edge1" class="edge">
<title>n0-&gt;n1</title>
<path fill="none" stroke="lightgray" d="M254.84,-612.87C238.68,-596.66 221.69,-579.61 208.75,-566.62"></path>
<polygon fill="lightgray" stroke="lightgray" points="210.01,-565.41 205.24,-563.11 207.54,-567.88 210.01,-565.41"></polygon>
</g>
<!-- n2 -->
<g id="node3" class="node">
<title>n2</title>
<polygon fill="whitesmoke" stroke="gray" points="286,-561.8 232,-561.8 232,-525.8 286,-525.8 286,-561.8"></polygon>
</g>
<!-- n0&#45;&gt;n2 -->
<g id="edge2" class="edge">
<title>n0-&gt;n2</title>
<path fill="none" stroke="gray" stroke-width="2" d="M285.8,-612.87C279.64,-597.23 273.17,-580.8 268.13,-568.01"></path>
<polygon fill="gray" stroke="gray" stroke-width="2" points="270.35,-568.86 266.89,-564.85 267.1,-570.14 270.35,-568.86"></polygon>
</g>
<!-- n3 -->
<g id="node4" class="node">
<title>n3</title>
<polygon fill="whitesmoke" stroke="gray" points="495,-561.8 441,-561.8 441,-525.8 495,-525.8 495,-561.8"></polygon>
</g>
<!-- n0&#45;&gt;n3 -->
<g id="edge3" class="edge">
<title>n0-&gt;n3</title>
<path fill="none" stroke="lightgray" d="M365.3,-619.65C368.24,-617.46 371.15,-615.3 374,-613.2 395.66,-597.2 420.29,-579.29 438.89,-565.81"></path>
<polygon fill="lightgray" stroke="lightgray" points="439.73,-567.37 442.75,-563.02 437.67,-564.54 439.73,-567.37"></polygon>
</g>
<!-- n21 -->
<g id="node8" class="node">
<title>n21</title>
<polygon fill="whitesmoke" stroke="gray" points="126,-444.4 72,-444.4 72,-408.4 126,-408.4 126,-444.4"></polygon>
</g>
<!-- n2&#45;&gt;n21 -->
<g id="edge4" class="edge">
<title>n2-&gt;n21</title>
<path fill="none" stroke="lightgray" d="M239.93,-525.41C234.57,-520.72 228.65,-515.75 223,-511.4 193,-488.29 157,-464.29 131.54,-447.89"></path>
<polygon fill="lightgray" stroke="lightgray" points="132.7,-446.55 127.54,-445.33 130.81,-449.5 132.7,-446.55"></polygon>
</g>
<!-- n22 -->
<g id="node9" class="node">
<title>n22</title>
<polygon fill="snow" stroke="gray" points="377.2,-474.4 234.8,-474.4 234.8,-378.4 377.2,-378.4 377.2,-474.4"></polygon>
<text text-anchor="middle" x="306" y="-447.4" font-family="Arial" font-size="14.00" fill="red">Método_A</text>
<text text-anchor="middle" x="306" y="-430.6" font-family="Arial" font-size="14.00" fill="red">Punto de</text>
<text text-anchor="middle" x="306" y="-413.8" font-family="Arial" font-size="14.00" fill="red">control</text>
<text text-anchor="middle" x="306" y="-397" font-family="Arial" font-size="14.00" fill="red">catch E → thorw E</text>
</g>
<!-- n2&#45;&gt;n22 -->
<g id="edge5" class="edge">
<title>n2-&gt;n22</title>
<path fill="none" stroke="gray" stroke-width="2" d="M265.94,-525.77C270.82,-513.77 277.66,-496.98 284.3,-480.67"></path>
<polygon fill="gray" stroke="gray" stroke-width="2" points="285.33,-482.79 285.6,-477.5 282.09,-481.47 285.33,-482.79"></polygon>
</g>
<!-- n31 -->
<g id="node5" class="node">
<title>n31</title>
<polygon fill="whitesmoke" stroke="gray" points="466,-444.4 412,-444.4 412,-408.4 466,-408.4 466,-444.4"></polygon>
</g>
<!-- n3&#45;&gt;n31 -->
<g id="edge6" class="edge">
<title>n3-&gt;n31</title>
<path fill="none" stroke="lightgray" d="M463.72,-525.77C458.76,-506.03 450.55,-473.36 444.96,-451.13"></path>
<polygon fill="lightgray" stroke="lightgray" points="446.68,-450.77 443.76,-446.34 443.28,-451.62 446.68,-450.77"></polygon>
</g>
<!-- n32 -->
<g id="node6" class="node">
<title>n32</title>
<polygon fill="whitesmoke" stroke="gray" points="538,-444.4 484,-444.4 484,-408.4 538,-408.4 538,-444.4"></polygon>
</g>
<!-- n3&#45;&gt;n32 -->
<g id="edge7" class="edge">
<title>n3-&gt;n32</title>
<path fill="none" stroke="lightgray" d="M474.34,-525.77C481.73,-505.94 493.98,-473.08 502.26,-450.84"></path>
<polygon fill="lightgray" stroke="lightgray" points="503.85,-451.59 503.96,-446.29 500.57,-450.37 503.85,-451.59"></polygon>
</g>
<!-- n33 -->
<g id="node7" class="node">
<title>n33</title>
<polygon fill="whitesmoke" stroke="gray" points="611,-444.4 557,-444.4 557,-408.4 611,-408.4 611,-444.4"></polygon>
</g>
<!-- n3&#45;&gt;n33 -->
<g id="edge8" class="edge">
<title>n3-&gt;n33</title>
<path fill="none" stroke="lightgray" d="M490.12,-525.55C506.54,-512.31 529.09,-493.17 547,-474.4 554.36,-466.69 561.77,-457.6 568.01,-449.48"></path>
<polygon fill="lightgray" stroke="lightgray" points="569.19,-450.82 570.81,-445.78 566.4,-448.71 569.19,-450.82"></polygon>
</g>
<!-- n331 -->
<g id="node15" class="node">
<title>n331</title>
<polygon fill="whitesmoke" stroke="gray" points="724,-341.4 670,-341.4 670,-305.4 724,-305.4 724,-341.4"></polygon>
</g>
<!-- n33&#45;&gt;n331 -->
<g id="edge14" class="edge">
<title>n33-&gt;n331</title>
<path fill="none" stroke="lightgray" d="M603.43,-408.04C622.59,-390.91 651.93,-364.68 672.64,-346.17"></path>
<polygon fill="lightgray" stroke="lightgray" points="673.76,-347.52 676.32,-342.88 671.43,-344.91 673.76,-347.52"></polygon>
</g>
<!-- n332 -->
<g id="node16" class="node">
<title>n332</title>
<polygon fill="whitesmoke" stroke="gray" points="611,-341.4 557,-341.4 557,-305.4 611,-305.4 611,-341.4"></polygon>
</g>
<!-- n33&#45;&gt;n332 -->
<g id="edge15" class="edge">
<title>n33-&gt;n332</title>
<path fill="none" stroke="lightgray" d="M584,-408.27C584,-391.73 584,-366.54 584,-348.08"></path>
<polygon fill="lightgray" stroke="lightgray" points="585.75,-348.13 584,-343.13 582.25,-348.13 585.75,-348.13"></polygon>
</g>
<!-- n211 -->
<g id="node10" class="node">
<title>n211</title>
<polygon fill="whitesmoke" stroke="gray" points="126,-341.4 72,-341.4 72,-305.4 126,-305.4 126,-341.4"></polygon>
</g>
<!-- n21&#45;&gt;n211 -->
<g id="edge9" class="edge">
<title>n21-&gt;n211</title>
<path fill="none" stroke="lightgray" d="M99,-408.27C99,-391.73 99,-366.54 99,-348.08"></path>
<polygon fill="lightgray" stroke="lightgray" points="100.75,-348.13 99,-343.13 97.25,-348.13 100.75,-348.13"></polygon>
</g>
<!-- n212 -->
<g id="node11" class="node">
<title>n212</title>
<polygon fill="whitesmoke" stroke="gray" points="54,-341.4 0,-341.4 0,-305.4 54,-305.4 54,-341.4"></polygon>
</g>
<!-- n21&#45;&gt;n212 -->
<g id="edge10" class="edge">
<title>n21-&gt;n212</title>
<path fill="none" stroke="lightgray" d="M86.79,-408.27C74.68,-391.29 56.09,-365.21 42.85,-346.64"></path>
<polygon fill="lightgray" stroke="lightgray" points="44.48,-345.91 40.15,-342.85 41.63,-347.94 44.48,-345.91"></polygon>
</g>
<!-- n22&#45;&gt;n0 -->
<g id="edge30" class="edge">
<title>n22-&gt;n0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M306,-474.66C306,-511.02 306,-561.61 306,-601.38"></path>
<polygon fill="red" stroke="red" points="302.5,-601.3 306,-611.3 309.5,-601.3 302.5,-601.3"></polygon>
<text text-anchor="middle" x="343.52" y="-560" font-family="Arial" font-size="18.00" fill="red">E(a+b+d)</text>
<text text-anchor="middle" x="343.52" y="-538.4" font-family="Arial" font-size="18.00" fill="red">o</text>
<text text-anchor="start" x="306" y="-516.8" font-family="Arial" font-size="18.00" fill="red">E(a+c+d)</text>
</g>
<!-- n221 -->
<g id="node12" class="node">
<title>n221</title>
<polygon fill="whitesmoke" stroke="gray" points="270,-341.4 216,-341.4 216,-305.4 270,-305.4 270,-341.4"></polygon>
</g>
<!-- n22&#45;&gt;n221 -->
<g id="edge11" class="edge">
<title>n22-&gt;n221</title>
<path fill="none" stroke="#63b8ff" stroke-width="2" d="M276.53,-378.15C269.85,-367.44 263.04,-356.53 257.32,-347.36"></path>
<polygon fill="#63b8ff" stroke="#63b8ff" stroke-width="2" points="259.65,-347.78 255.52,-344.47 256.68,-349.63 259.65,-347.78"></polygon>
</g>
<!-- n222 -->
<g id="node13" class="node">
<title>n222</title>
<polygon fill="whitesmoke" stroke="gray" points="534,-341.4 480,-341.4 480,-305.4 534,-305.4 534,-341.4"></polygon>
</g>
<!-- n22&#45;&gt;n222 -->
<g id="edge12" class="edge">
<title>n22-&gt;n222</title>
<path fill="none" stroke="#36648b" stroke-width="2" d="M377.43,-389.51C410.37,-372.95 447.87,-354.11 474.02,-340.97"></path>
<polygon fill="#36648b" stroke="#36648b" stroke-width="2" points="473.37,-343.26 477.05,-339.45 471.79,-340.13 473.37,-343.26"></polygon>
</g>
<!-- n223 -->
<g id="node14" class="node">
<title>n223</title>
<polygon fill="whitesmoke" stroke="gray" points="198,-341.4 144,-341.4 144,-305.4 198,-305.4 198,-341.4"></polygon>
</g>
<!-- n22&#45;&gt;n223 -->
<g id="edge13" class="edge">
<title>n22-&gt;n223</title>
<path fill="none" stroke="lightgray" d="M242.85,-378.15C227.58,-366.73 212.02,-355.09 199.3,-345.57"></path>
<polygon fill="lightgray" stroke="lightgray" points="200.65,-344.4 195.6,-342.8 198.55,-347.2 200.65,-344.4"></polygon>
</g>
<!-- n2211 -->
<g id="node17" class="node">
<title>n2211</title>
<polygon fill="snow" stroke="gray" points="312.2,-268.4 169.8,-268.4 169.8,-172.4 312.2,-172.4 312.2,-268.4"></polygon>
<text text-anchor="middle" x="241" y="-241.4" font-family="Arial" font-size="14.00" fill="red">Método_B</text>
<text text-anchor="middle" x="241" y="-224.6" font-family="Arial" font-size="14.00" fill="red">Punto de</text>
<text text-anchor="middle" x="241" y="-207.8" font-family="Arial" font-size="14.00" fill="red">control</text>
<text text-anchor="middle" x="241" y="-191" font-family="Arial" font-size="14.00" fill="red">catch E → thorw E</text>
</g>
<!-- n221&#45;&gt;n2211 -->
<g id="edge16" class="edge">
<title>n221-&gt;n2211</title>
<path fill="none" stroke="#63b8ff" stroke-width="2" d="M242.66,-305.27C242.49,-296.8 242.28,-286.06 242.06,-275.13"></path>
<polygon fill="#63b8ff" stroke="#63b8ff" stroke-width="2" points="243.84,-276.67 242,-271.71 240.35,-276.74 243.84,-276.67"></polygon>
</g>
<!-- n2212 -->
<g id="node18" class="node">
<title>n2212</title>
<polygon fill="whitesmoke" stroke="gray" points="152,-238.4 98,-238.4 98,-202.4 152,-202.4 152,-238.4"></polygon>
</g>
<!-- n221&#45;&gt;n2212 -->
<g id="edge17" class="edge">
<title>n221-&gt;n2212</title>
<path fill="none" stroke="lightgray" d="M215.51,-307.46C198.75,-297.61 177.47,-283.73 161,-268.4 153.15,-261.09 145.72,-251.93 139.67,-243.65"></path>
<polygon fill="lightgray" stroke="lightgray" points="141.3,-242.91 136.97,-239.86 138.45,-244.94 141.3,-242.91"></polygon>
</g>
<!-- n2221 -->
<g id="node19" class="node">
<title>n2221</title>
<polygon fill="whitesmoke" stroke="gray" points="544,-238.4 490,-238.4 490,-202.4 544,-202.4 544,-238.4"></polygon>
</g>
<!-- n222&#45;&gt;n2221 -->
<g id="edge18" class="edge">
<title>n222-&gt;n2221</title>
<path fill="none" stroke="lightgray" d="M508.7,-305.27C510.33,-288.73 512.83,-263.54 514.66,-245.08"></path>
<polygon fill="lightgray" stroke="lightgray" points="516.39,-245.27 515.15,-240.12 512.91,-244.93 516.39,-245.27"></polygon>
</g>
<!-- n2222 -->
<g id="node20" class="node">
<title>n2222</title>
<polygon fill="whitesmoke" stroke="gray" points="616,-238.4 562,-238.4 562,-202.4 616,-202.4 616,-238.4"></polygon>
</g>
<!-- n222&#45;&gt;n2222 -->
<g id="edge19" class="edge">
<title>n222-&gt;n2222</title>
<path fill="none" stroke="lightgray" d="M522.15,-305.08C531.23,-294.58 542.94,-280.85 553,-268.4 559.53,-260.32 566.51,-251.3 572.57,-243.34"></path>
<polygon fill="lightgray" stroke="lightgray" points="573.67,-244.78 575.3,-239.74 570.88,-242.67 573.67,-244.78"></polygon>
</g>
<!-- n2223 -->
<g id="node21" class="node">
<title>n2223</title>
<polygon fill="snow" stroke="gray" points="472.2,-268.4 329.8,-268.4 329.8,-172.4 472.2,-172.4 472.2,-268.4"></polygon>
<text text-anchor="middle" x="401" y="-241.4" font-family="Arial" font-size="14.00" fill="red">Método_C</text>
<text text-anchor="middle" x="401" y="-224.6" font-family="Arial" font-size="14.00" fill="red">Punto de</text>
<text text-anchor="middle" x="401" y="-207.8" font-family="Arial" font-size="14.00" fill="red">control</text>
<text text-anchor="middle" x="401" y="-191" font-family="Arial" font-size="14.00" fill="red">catch E → thorw E</text>
</g>
<!-- n222&#45;&gt;n2223 -->
<g id="edge20" class="edge">
<title>n222-&gt;n2223</title>
<path fill="none" stroke="#36648b" stroke-width="2" d="M489.02,-305.27C479.55,-296.24 467.38,-284.65 455.13,-272.98"></path>
<polygon fill="#36648b" stroke="#36648b" stroke-width="2" points="457.64,-272.95 452.81,-270.77 455.22,-275.48 457.64,-272.95"></polygon>
</g>
<!-- n3311 -->
<g id="node23" class="node">
<title>n3311</title>
<polygon fill="whitesmoke" stroke="gray" points="832,-238.4 778,-238.4 778,-202.4 832,-202.4 832,-238.4"></polygon>
</g>
<!-- n331&#45;&gt;n3311 -->
<g id="edge21" class="edge">
<title>n331-&gt;n3311</title>
<path fill="none" stroke="lightgray" d="M723.7,-305.01C737.91,-295.13 755.23,-282.03 769,-268.4 776.5,-260.97 783.78,-251.94 789.8,-243.79"></path>
<polygon fill="lightgray" stroke="lightgray" points="790.98,-245.15 792.49,-240.08 788.14,-243.1 790.98,-245.15"></polygon>
</g>
<!-- n3312 -->
<g id="node24" class="node">
<title>n3312</title>
<polygon fill="whitesmoke" stroke="gray" points="688,-238.4 634,-238.4 634,-202.4 688,-202.4 688,-238.4"></polygon>
</g>
<!-- n331&#45;&gt;n3312 -->
<g id="edge22" class="edge">
<title>n331-&gt;n3312</title>
<path fill="none" stroke="lightgray" d="M690.89,-305.27C684.95,-288.58 675.86,-263.1 669.27,-244.6"></path>
<polygon fill="lightgray" stroke="lightgray" points="670.97,-244.17 667.65,-240.04 667.68,-245.34 670.97,-244.17"></polygon>
</g>
<!-- n3313 -->
<g id="node25" class="node">
<title>n3313</title>
<polygon fill="whitesmoke" stroke="gray" points="760,-238.4 706,-238.4 706,-202.4 760,-202.4 760,-238.4"></polygon>
</g>
<!-- n331&#45;&gt;n3313 -->
<g id="edge23" class="edge">
<title>n331-&gt;n3313</title>
<path fill="none" stroke="lightgray" d="M703.11,-305.27C709.05,-288.58 718.14,-263.1 724.73,-244.6"></path>
<polygon fill="lightgray" stroke="lightgray" points="726.32,-245.34 726.35,-240.04 723.03,-244.17 726.32,-245.34"></polygon>
</g>
<!-- n2211&#45;&gt;n22 -->
<g id="edge31" class="edge">
<title>n2211-&gt;n22</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M264.42,-268.7C269.7,-280.5 274.93,-293.26 279,-305.4 285.6,-325.13 291.09,-347.22 295.36,-367.02"></path>
<polygon fill="red" stroke="red" points="291.88,-367.51 297.35,-376.58 298.74,-366.08 291.88,-367.51"></polygon>
<text text-anchor="middle" x="316.21" y="-318" font-family="Arial" font-size="18.00" fill="red">E(b+d)</text>
</g>
<!-- n22111 -->
<g id="node22" class="node">
<title>n22111</title>
<polygon fill="whitesmoke" stroke="gray" points="276,-135.4 222,-135.4 222,-99.4 276,-99.4 276,-135.4"></polygon>
</g>
<!-- n2211&#45;&gt;n22111 -->
<g id="edge24" class="edge">
<title>n2211-&gt;n22111</title>
<path fill="none" stroke="#63b8ff" stroke-width="2" d="M244.74,-172.15C245.57,-161.74 246.41,-151.15 247.12,-142.14"></path>
<polygon fill="#63b8ff" stroke="#63b8ff" stroke-width="2" points="248.72,-144.04 247.38,-138.91 245.24,-143.76 248.72,-144.04"></polygon>
</g>
<!-- n2223&#45;&gt;n22 -->
<g id="edge32" class="edge">
<title>n2223-&gt;n22</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M380.05,-268.86C370.18,-290.98 358.15,-317.61 347,-341.4 342.99,-349.95 338.68,-358.96 334.42,-367.77"></path>
<polygon fill="red" stroke="red" points="331.34,-366.1 330.12,-376.63 337.64,-369.16 331.34,-366.1"></polygon>
<text text-anchor="middle" x="390.17" y="-318" font-family="Arial" font-size="18.00" fill="red">E(c+d)</text>
</g>
<!-- n22231 -->
<g id="node26" class="node">
<title>n22231</title>
<polygon fill="whitesmoke" stroke="gray" points="492,-135.4 438,-135.4 438,-99.4 492,-99.4 492,-135.4"></polygon>
</g>
<!-- n2223&#45;&gt;n22231 -->
<g id="edge25" class="edge">
<title>n2223-&gt;n22231</title>
<path fill="none" stroke="#36648b" stroke-width="2" d="M430.94,-172.15C437.73,-161.44 444.64,-150.53 450.45,-141.36"></path>
<polygon fill="#36648b" stroke="#36648b" stroke-width="2" points="451.09,-143.61 452.29,-138.45 448.14,-141.74 451.09,-143.61"></polygon>
</g>
<!-- n22232 -->
<g id="node27" class="node">
<title>n22232</title>
<polygon fill="whitesmoke" stroke="gray" points="348,-135.4 294,-135.4 294,-99.4 348,-99.4 348,-135.4"></polygon>
</g>
<!-- n2223&#45;&gt;n22232 -->
<g id="edge26" class="edge">
<title>n2223-&gt;n22232</title>
<path fill="none" stroke="lightgray" d="M363.58,-172.15C354.93,-161.24 346.12,-150.12 338.78,-140.85"></path>
<polygon fill="lightgray" stroke="lightgray" points="340.28,-139.92 335.8,-137.08 337.53,-142.09 340.28,-139.92"></polygon>
</g>
<!-- n22233 -->
<g id="node28" class="node">
<title>n22233</title>
<polygon fill="whitesmoke" stroke="gray" points="420,-135.4 366,-135.4 366,-99.4 420,-99.4 420,-135.4"></polygon>
</g>
<!-- n2223&#45;&gt;n22233 -->
<g id="edge27" class="edge">
<title>n2223-&gt;n22233</title>
<path fill="none" stroke="lightgray" d="M397.26,-172.15C396.43,-161.74 395.59,-151.15 394.88,-142.14"></path>
<polygon fill="lightgray" stroke="lightgray" points="396.64,-142.25 394.51,-137.41 393.16,-142.53 396.64,-142.25"></polygon>
</g>
<!-- n222311 -->
<g id="node29" class="node">
<title>n222311</title>
<polygon fill="snow" stroke="gray" points="430.69,-62.4 337.31,-62.4 337.31,0 430.69,0 430.69,-62.4"></polygon>
<text text-anchor="middle" x="384" y="-35.4" font-family="Arial" font-size="14.00" fill="red">Método_D</text>
<text text-anchor="middle" x="384" y="-18.6" font-family="Arial" font-size="14.00" fill="red">throw E</text>
</g>
<!-- n22111&#45;&gt;n222311 -->
<g id="edge28" class="edge">
<title>n22111-&gt;n222311</title>
<path fill="none" stroke="#63b8ff" stroke-width="2" d="M276.32,-99.36C292.24,-89.43 312.84,-76.58 331.75,-64.79"></path>
<polygon fill="#63b8ff" stroke="#63b8ff" stroke-width="2" points="331.15,-67.22 334.47,-63.09 329.3,-64.25 331.15,-67.22"></polygon>
</g>
<!-- n22231&#45;&gt;n222311 -->
<g id="edge29" class="edge">
<title>n22231-&gt;n222311</title>
<path fill="none" stroke="#36648b" stroke-width="2" d="M448.22,-98.95C439.38,-89.77 428.21,-78.16 417.68,-67.21"></path>
<polygon fill="#36648b" stroke="#36648b" stroke-width="2" points="420.04,-67.14 415.31,-64.75 417.52,-69.56 420.04,-67.14"></polygon>
</g>
<!-- n222311&#45;&gt;n2211 -->
<g id="edge33" class="edge">
<title>n222311-&gt;n2211</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M337.12,-32.76C288.58,-36.15 214.93,-49.81 179,-99.4 164.92,-118.83 172,-141.9 185.58,-162.6"></path>
<polygon fill="red" stroke="red" points="182.69,-164.57 191.34,-170.68 188.39,-160.51 182.69,-164.57"></polygon>
<text text-anchor="middle" x="196" y="-112" font-family="Arial" font-size="18.00" fill="red">E(d)</text>
</g>
<!-- n222311&#45;&gt;n2223 -->
<g id="edge34" class="edge">
<title>n222311-&gt;n2223</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M430.94,-46.22C456.5,-56.52 485.92,-73.35 501,-99.4 514.91,-123.44 501.69,-147.45 480.82,-167.61"></path>
<polygon fill="red" stroke="red" points="478.68,-164.82 473.6,-174.12 483.37,-170.01 478.68,-164.82"></polygon>
<text text-anchor="middle" x="523.73" y="-112" font-family="Arial" font-size="18.00" fill="red">E(d)</text>
</g>
<!-- n222312 -->
<g id="node30" class="node">
<title>n222312</title>
<polygon fill="whitesmoke" stroke="gray" points="437,-683.2 383,-683.2 383,-647.2 437,-647.2 437,-683.2"></polygon>
</g>
</g>
</svg>
</p><p></p>
<p>Si sólo tuviera un punto de recuperación de errores (catch) en el <strong><code>Main</code></strong> al producirse el la excepción <strong><code>E(d)</code></strong> en <strong><code>Método_D</code></strong>, no sabría por donde se ha producido. Sin embargo, si vamos añadiendo <em>'<strong><code>catch</code></strong> de control'</em> donde relanzamos la misma excepción, añadiendo una capa de información de que proceso estamos haciendo en ese momento. El <em>'<strong><code>catch</code></strong> de contol'</em> en el <strong><code>Método_A</code></strong>, si nos fijamos, puede relanzar la excepción añadiendo información de cada uno de los <em>'<strong><code>catch</code></strong> de contol'</em> por donde ha pasado <strong><code>E(a+b+d) o E(a+c+d)</code></strong> y saber de forma más específica en un <em>'<strong><code>catch</code></strong> de mensaje o recuperación'</em> del <strong><code>Main</code></strong>, por donde se ha producido el error.</p>
<div style="page-break-after:always;"></div>
<p>Una posible implementación esquemática del la situación descrita sería:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">E</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Exception</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token function">E</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> message<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword keyword-base">base</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token function">E</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> message<span class="token punctuation">,</span> <span class="token class-name">Exception</span> innerException<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword keyword-base">base</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> innerException<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">JerarquiaDeLlamadas</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Metodo_D</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// En algún punto de pude lanzar la excepción</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">E</span><span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Metodo_C</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-try">try</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// En algún punto de este código en su jerarquía de llamadas,</span>
            <span class="token comment">// se llamará a Metodo_D()</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token comment">// Catch de control en C</span>
        <span class="token punctuation">{</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">E</span><span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Metodo_B</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-try">try</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// En algún punto de este código en su jerarquía de llamadas,</span>
            <span class="token comment">// se llamará a Metodo_D()</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token comment">// Catch de control en B</span>
        <span class="token punctuation">{</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">E</span><span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Metodo_A</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-try">try</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// En algún punto de este código en su jerarquía de llamadas,</span>
            <span class="token comment">// o bien se llemará a Metodo_B() o a Metodo_C()</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">E</span> e<span class="token punctuation">)</span> <span class="token comment">// Catch de control en A</span>
        <span class="token punctuation">{</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">E</span><span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code>    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-try">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// En algún punto de este código en su jerarquía de llamadas,</span>
            <span class="token comment">// se llamará a Metodo_A()</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">?</span> e<span class="token punctuation">)</span> <span class="token comment">// Catch de mensaje o recuperación en Main</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">StringBuilder</span> mensaje <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                mensaje<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e <span class="token operator">=</span> e<span class="token punctuation">.</span>InnerException <span class="token keyword keyword-as">as</span> <span class="token class-name">E</span><span class="token punctuation">;</span>
                <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
                    mensaje<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>mensaje<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
      
      
    
    
    
    
    
    
  
    </body></html>