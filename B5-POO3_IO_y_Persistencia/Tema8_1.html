<!DOCTYPE html><html><head>
      <title>Programación 1º DAM Tema 8.1</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v19/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview .caso_estudio {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .ejercicio {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="tema-81">Tema 8.1 </h1>
<p>Descargar estos apuntes en <a href="./Tema8_1.pdf">pdf</a> o <a href="./Tema8_1.html">html</a></p>
<h2 id="índice">Índice </h2>

<div class="md-toc">
<div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#definiciones-básicas" class="md-toc-link">
            <p>Definiciones básicas</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#gestión-de-rutas-en-net" class="md-toc-link"><p>Gestión de rutas en .NET</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#clase-path" class="md-toc-link"><p>Clase Path</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#operaciones-con-rutas" class="md-toc-link">
            <p>Operaciones con rutas</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#gestión-de-archivos-y-directorios" class="md-toc-link"><p>Gestión de archivos y directorios</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#clases-de-utilidad-file-y-directory" class="md-toc-link"><p>Clases de utilidad File y Directory</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ejemplo-de-uso-de-file-y-directory" class="md-toc-link">
            <p>Ejemplo de uso de File y Directory</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#clases-fileinfo-y-directoryinfo" class="md-toc-link"><p>Clases FileInfo y DirectoryInfo</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#ejemplos-de-uso-de-fileinfo-y-directoryinfo" class="md-toc-link">
            <p>Ejemplos de uso de FileInfo y DirectoryInfo</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
<div style="page-break-after:always;"></div>
<h2 id="definiciones-básicas">Definiciones básicas </h2>
<p>El siguiente <em>'pre-conocimiento'</em> será necesario tenerlo presente para abordar el siguiente tema. Por pertenecer los siguiente conceptos al currículo del módulo de <strong>'<em>Sistemas Informáticos</em>'</strong>, únicamente vamos a enumerar los conceptos que vamos a necesitar.</p>
<ul>
<li>
<p>Un <strong>archivo o fichero</strong> informático es un conjunto de bytes que son almacenados en un dispositivo.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
<li>
<p>En informática, <strong>una ruta (path, en inglés)</strong> es la forma de referenciar un archivo informático o directorio en un sistema de archivos de un sistema operativo determinado.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
<li>
<p>Las <strong>rutas absolutas</strong> señalan la ubicación de un archivo o directorio desde el <strong>directorio raíz</strong> del sistema de archivos.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
<li>
<p>Las <strong>rutas relativas</strong> señalan la ubicación de un archivo o directorio a partir de nuestra <strong>posición actual</strong> en el sistema de archivos.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
</ul>
<h2 id="gestión-de-rutas-en-net">Gestión de rutas en .NET </h2>
<p>Al tratarse .NET de un Framework <strong>multiplataforma</strong>, dispondrá de una serie de <strong>clases de utilidad para el manejo de rutas</strong> de forma '<em>transparente</em>' al <strong>Sistema Operativo (SO)</strong> en el que estemos ejecutando.</p>
<h3 id="clase-path">Clase Path </h3>
<p>Esta clase nos proporcionará de forma abstracta las siguientes propiedades, que pueden tomar valores diferentes dependiendo del SO donde estemos ejecutando.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Campo</th>
<th style="text-align:left">Parte de la ruta que su valor representa</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><code>DirectorySeparatorChar</code></strong></td>
<td style="text-align:left">Separador de directorios. En Windows es <code>\</code>, en Unix es <code>/</code> y Macintosh es <code>:</code></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AltDirectorySeparatorChar</code></strong></td>
<td style="text-align:left">Carácter alternativo usable como separador de directorios. En Windows y Macintosh es <code>/</code>, - mientras que en Unix es <code>\</code></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>PathSeparator</code></strong></td>
<td style="text-align:left">Separador entre rutas. Aunque en los sistemas operativos más comunes es ; podría variar en otros.</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>VolumeSeparatorChar</code></strong></td>
<td style="text-align:left">Separador de unidades lógicas. En Windows y Macintosh es : (por ejemplo <code>C:\datos</code>) y en Unix <code>/</code></td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo:</strong> Si en lugar de asignar el siguiente literal en el código ...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta <span class="token operator">=</span> <span class="token string">@"\datos\fichero.txt"</span><span class="token punctuation">;</span>
</code></pre><p>escribimos...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name"><span class="token keyword keyword-char">char</span></span> s <span class="token operator">=</span> Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">datos</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">fichero.txt"</span></span><span class="token punctuation">;</span>
</code></pre><p>Conseguiremos que la variable <strong><code>ruta</code></strong> almacene el formato de la misma según corresponda al sistema operativo sobre el que se ejecute el código anterior. Es decir, mientras que en <strong>Windows</strong> contendría <strong><code>\datos\fichero.txt</code></strong>, en <strong>Linux o Mac OSX</strong> contendría <strong><code>/datos/fichero.txt</code></strong></p>
<h4 id="operaciones-con-rutas">Operaciones con rutas </h4>
<p>Si te fijas en el ejemplo anterior, ocurre que en Windows el carácter usado como separador de directorios <strong><code>\</code></strong> coincide con el que C# usa como indicador de secuencias de escape. Por eso es incorrecto indicar literales de cadena para rutas como <strong><code>"C:\datos"</code></strong>, ya que C# entendería que estamos intentando escapar el caracter <strong><code>d</code></strong>.</p>
<p>En su lugar hay tres alternativas:</p>
<ol>
<li>
<p>Usar el campo independiente del sistema operativo <strong><code>$"C:{Path.DirectorySeparatorChar}datos"</code></strong></p>
</li>
<li>
<p>Duplicar los caracteres de los literales para que dejen de considerarse<br>
secuencias de escape. Así, la ruta de ejemplo anterior quedaría... <strong><code>"C:\\datos"</code></strong></p>
</li>
<li>
<p>Lo que hemos hecho en nuestro ejemplo que consiste en especificar la ruta mediante un literal de cadena plano, pues en ellos no se tienen en cuenta las secuencias de escape. Así, ahora la ruta del ejemplo quedaría ... como <strong><code>@"C:\datos"</code></strong>.<br>
Esta opción es la más simple, si sabemos cual es el SO donde vamos a ejecutar.</p>
</li>
</ol>
<div style="page-break-after:always;"></div>
<ul>
<li>
<p>Obtener la ruta con el <strong>directorio <em>'padre'</em></strong> o <strong>null</strong> si es raíz.</p>
<p><strong>string Path.<a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.path.getdirectoryname?view=net-5.0#System_IO_Path_GetDirectoryName_System_String_">GetDirectoryName</a>(string path)</strong></p>
<ul>
<li><strong><code>GetDirectoryName(@"C:\MyDir\MySubDir\myfile.ext")</code></strong> devuelve <strong><code>"C:\MyDir\MySubDir"</code></strong></li>
<li><strong><code>GetDirectoryName(@"C:\MyDir\MySubDir")</code></strong> devuelve <strong><code>"C:\MyDir"</code></strong></li>
<li><strong><code>GetDirectoryName(@"C:\MyDir\")</code></strong> devuelve <strong><code>"C:\MyDir"</code></strong></li>
<li><strong><code>GetDirectoryName(@"C:\MyDir")</code></strong> devuelve <strong><code>"C:\"</code></strong></li>
<li><strong><code>GetDirectoryName(@"C:\")</code></strong> devuelve <strong><code>null</code></strong></li>
</ul>
</li>
<li>
<p>Obtener el archivo o directorio del final de la ruta. (vacío si acaba en separador)</p>
<p><strong>string Path.<a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.path.getfilename?view=net-5.0#System_IO_Path_GetFileName_System_String_">GetFileName</a>(string path)</strong></p>
<ul>
<li><strong><code>GetFileName(@"C:\MyDir\MySubDir\myfile.ext")</code></strong> devuelve <strong><code>"myfile.ext"</code></strong></li>
<li><strong><code>GetFileName(@"C:\MyDir\MySubDir")</code></strong> devuelve <strong><code>"MySubDir"</code></strong></li>
<li><strong><code>GetFileName(@"C:\MyDir\")</code></strong> devuelve <strong><code>""</code></strong> (Cadena vacía)</li>
</ul>
</li>
<li>
<p>Combinar un <strong>DirectoryName path1</strong> y un <strong>FileName path2</strong> para formar <strong>una nueva ruta</strong>.</p>
<blockquote>
<p>⚠️ <strong>Aviso:</strong> Siempre que <strong>path2</strong> no empiece por el carácter separador de directorio o de volumen.</p>
</blockquote>
<p><strong>string <a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.path.combine?view=net-5.0#System_IO_Path_Combine_System_String_System_String_">Combine</a>(string path1, string path2);</strong></p>
<ul>
<li><strong><code>Combine(@"C:\MyDir", @"myfile.ext")</code></strong> devuelve <strong><code>"C:\MyDir\myfile.ext"</code></strong></li>
<li><strong><code>Combine(@"C:\MyDir\", @"myfile.ext")</code></strong> devuelve <strong><code>"C:\MyDir\myfile.ext"</code></strong></li>
<li><strong><code>Combine(@"C:\MyDir", @"MySubDir\myfile.ext")</code></strong>  devuelve <strong><code>"C:\MyDir\MySubDir\myfile.ext"</code></strong></li>
<li><strong><code>Combine(@"C:\MyDir\", @"MySubDir\myfile.ext")</code></strong> devuelve <strong><code>"C:\MyDir\MySubDir\myfile.ext"</code></strong></li>
<li>❌ <strong><code>Combine(@"C:\MyDir\", @"\MySubDir\myfile.ext")</code></strong></li>
<li>❌ <strong><code>Combine(@"C:\MyDir\", @"C:\MySubDir\myfile.ext")</code></strong></li>
</ul>
</li>
</ul>
<div style="page-break-after:always;"></div>
<h2 id="gestión-de-archivos-y-directorios">Gestión de archivos y directorios </h2>
<h3 id="clases-de-utilidad-file-y-directory">Clases de utilidad File y Directory </h3>
<p>Ambas clases contienen gran cantidad de <strong>métodos estáticos de utilidad</strong> para hacer <strong>operaciones</strong> con ficheros/archivos y directorios/carpetas, del estilo de las que se hacen desde la <strong>línea de comandos</strong>.</p>
<p>Lógicamente los métodos definidos en <strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.directory?view=net-5.0">Directory</a></strong> realizan operaciones sobre <strong>directorios</strong> y los definidos en <strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.file?view=net-5.0">File</a></strong> sobre <strong>archivos</strong>.</p>
<blockquote>
<p>📌 <strong>Nota:</strong> Cómo no es idea de estos temas copiar la documentación de Microsoft en castellano. Es recomendable que le eches un vistazo a los enlaces del anterior párrafo para hacerte una idea de las operaciones definidas en estas clases.</p>
</blockquote>
<h4 id="ejemplo-de-uso-de-file-y-directory">Ejemplo de uso de File y Directory </h4>
<p>Veamos alguno de estos métodos a través del siguiente <strong>ejemplo comentado</strong>:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-char">char</span></span> s <span class="token operator">=</span> Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$".</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">datos</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">datos.txt"</span></span><span class="token punctuation">;</span>

    <span class="token comment">// Si no existe el directorio datos en la ruta relativa actual lo crearé.</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">GetDirectoryName</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        Directory<span class="token punctuation">.</span><span class="token function">CreateDirectory</span><span class="token punctuation">(</span><span class="token string">"datos"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Creo el fichero datos.txt vacío. Más adelante en el tema</span>
    <span class="token comment">// veremos que llamar al Close() es importante para que no</span>
    <span class="token comment">// se quede abierto.</span>
    File<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Me sitúo en el directorio datos.</span>
    Directory<span class="token punctuation">.</span><span class="token function">SetCurrentDirectory</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">GetDirectoryName</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"El fichero "</span> <span class="token operator">+</span> ruta <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Compruebo si se ha creado el fichero correctamente viendo si </span>
    <span class="token comment">// existe o no en el directorio datos (donde me acabo de situar).</span>
    <span class="token comment">// Mostraré si existe o no por pantalla.</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">GetFileName</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">?</span><span class="token string">"existe"</span> <span class="token punctuation">:</span> <span class="token string">"no existe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<h3 id="clases-fileinfo-y-directoryinfo">Clases FileInfo y DirectoryInfo </h3>
<p>Además de las clases con métodos de operaciones sobre directorios y ficheros. También dispondremos de objetos que contendrán información sobre los mismos además de permitirnos también hacer ciertas operaciones.<br>
Dichos objetos se instanciarán en memoria a través de las clases...</p>
<p><strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.directoryinfo?view=net-5.0">DirectoryInfo</a></strong> y <strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.fileinfo?view=net-5.0">FileInfo</a></strong> pues ...</p>
<ul>
<li>
<p>Me devolverán información sobre <strong>carpetas</strong> y <strong>archivos</strong> respectivamente.</p>
</li>
<li>
<p>Además de permitirme <em>'navegar</em> por el sistema de ficheros, moviéndome entre las diferentes carpetas. Me permitirán <strong>realizar acciones más precisas y con más detalle</strong> sobre el sistema de ficheros.</p>
</li>
<li>
<p><strong>Ambas clases heredarán de la clases abstracta</strong> <code>FileSystemInfo</code> que contendrá la información común a archivos y carpetas. Un ejemplo sería la fecha de creación y otras propiedades comunes.</p>
</li>
<li>
<p>La abstracción del sistema de ficheros se almacena en la clase <strong><code>FileSystemInfo</code></strong>:</p>
<ul>
<li>Se accederá a través de la sustitución de Liskov de objetos de tipo <strong><code>DirectoryInfo</code></strong> o <strong><code>FileInfo</code></strong>.</li>
</ul>
<p align="center" style="zoom:0.8" class="puml"><!--?xml version="1.0" encoding="us-ascii" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="335px" preserveAspectRatio="none" style="width:489px;height:335px;background:#FFFFFF;" version="1.1" viewBox="0 0 489 335" width="489px" zoomAndPan="magnify"><defs></defs><g><rect fill="#FFFAFA" height="110.4932" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.5;" width="214" x="263" y="111.3452"></rect><text fill="#000000" font-family="Arial" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="103" x="318.5" y="139.4771">FileSystemInfo</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="4" x="368" y="155.5757">&nbsp;</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="166" x="287" y="171.6743">Información y operaciones</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="184" x="278" y="187.7729">comunes a ambos elementos</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="149" x="295.5" y="203.8716">del sistema de ficheros.</text><rect fill="#F0F8FF" height="126.5918" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.5;" width="193" x="10" y="25"></rect><text fill="#000000" font-family="Arial" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="91" x="61" y="53.1318">DirectoryInfo</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="4" x="104.5" y="69.2305">&nbsp;</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="134" x="39.5" y="85.3291">Contiene información</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="142" x="35.5" y="101.4277">especifica de carpetas</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="163" x="25" y="117.5264">y operaciones especificas</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="113" x="50" y="133.625">sobre las mismas.</text><path d="M263,166.5918 L253,166.5918 C238,166.5918 228,88.2959 213,88.2959 L203,88.2959 " fill="none" style="stroke:#000000;stroke-width:1.0;"></path><rect fill="#F0F8FF" height="126.5918" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.5;" width="193" x="10" y="181.5918"></rect><text fill="#000000" font-family="Arial" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="53" x="80" y="209.7236">FileInfo</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="4" x="104.5" y="225.8223">&nbsp;</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="134" x="39.5" y="241.9209">Contiene información</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="140" x="36.5" y="258.0195">especifica de archivos</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="163" x="25" y="274.1182">y operaciones especificas</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="73" x="70" y="290.2168">sobre ellos.</text><path d="M263,166.5918 L253,166.5918 C238,166.5918 228,244.8877 213,244.8877 L203,244.8877 " fill="none" style="stroke:#000000;stroke-width:1.0;"></path><!--SRC=[bPBFRXD13CRlynIMkBIH6fAG8XHLg6t-54e24Kbx8Hoyiyx6OdOcyiocIb6VYaVWnV2kKWN41IwhiJtsx_FiTnaJIYhPvoLkZN2nIP02E5edo5d89WxUNCIqT_JM7EwD60l14huRW2bxii45WSoX_QQPIV3f8vO4LyBe3ea5Fn9q-nhva5FJ2J37F6TVGFUy2MSe1Vldw5qGVjHET5UE2r-IJs3rGzAKhnLs8w7o-R2XFsmuaLQUp9EvU7dGQrfVNaGV7hv2gpLXHujzJ5I-z-lGQgtyojSdAT7opnyUzX2s91e4Jt7bRIWhFG02bbc8G8vg3K5BEJc8N8z2q6NMR3Sa8RQLfq1qR2bp5TNKKVE6GVP7w52NOl84_1jzfQWjMTPPpKoBigM42lj35XnlQIc6J0WSHYWvbgW2_kBNM_yd6iLkU1V-1KtEDMjValhYu24pT-ZJtMmAEvAehT1jzpgzVllLoN9JmOGo_SFGwmpwdK7d78RZ9TJbKtDoCvz239LOKkl599nLjVjEpItk43vNghsa0NpQahyTVNXEmDZlM49Z47DxFpjUUDq_k-O42n9L0lSpCw8rLYvfXmsryGPmjvoSlJ5Jz4M5XSwcQ8RggIJx0OmNlm00]--></g></svg></p><ul>
<li>Una ejemplo de esta información común detallada. Es el campo <strong><code>Attributes</code></strong> del sistema de ficheros.<br>
El campo <strong><code>Attributes</code></strong> es una máscara creada a partir del <strong>Enum <a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.fileattributes?view=net-5.0">FileAttributes</a></strong>. Con información común a ficheros y directorios.
<blockquote>
<p>📣 <strong>Nota:</strong> Échale un vistazo a los bits de la máscara en el enlace del tipo.</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<p>Aunque sería inabordable tratar todas los casos de uso de estos objetos. Vamos a ver un par ejemplos y un caso de uso.</p>
<div style="page-break-after:always;"></div>
<h4 id="ejemplos-de-uso-de-fileinfo-y-directoryinfo">Ejemplos de uso de FileInfo y DirectoryInfo </h4>
<p><strong>Ejemplo 1:</strong></p>
<p>Supongamos una función que recibe la ruta al fichero del sistema Windows 10 <strong><code>C:\Windows\write.exe</code></strong> y nos muestra la información común almacenada en la clase abstracta <strong><code>FileSystemInfo</code></strong> sobre él.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-class">class</span> <span class="token class-name">EjemploFileInfo</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> <span class="token function">ObtenInformacion</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> rutaAFichero<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Obtenemos la información del fichero y </span>
        <span class="token comment">// hacemos una sustitución a la superclase.</span>
        <span class="token class-name">FileSystemInfo</span> f <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">FileInfo</span><span class="token punctuation">(</span>rutaAFichero<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">StringBuilder</span> informacion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Añadimos información del fichero.</span>
        <span class="token comment">// Fíjate que f.Attributes muestra todos </span>
        <span class="token comment">// los valores dele enum añadidos a la máscara.</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">.</span>Exists<span class="token punctuation">)</span>
            informacion<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Nombre completo: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>FullName</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Nombre : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Extensión : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>Extension</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Fecha creación: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>CreationTime</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Fecha último acceso: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>LastAccessTime</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Fecha última modificación: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>LastWriteTime</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"Atributos: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>Attributes</span><span class="token punctuation">}</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-else">else</span> 
            informacion<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">"Archivo no encontrado"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-return">return</span> informacion<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">ObtenInformacion</span><span class="token punctuation">(</span><span class="token string">@"C:\Windows\write.exe"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<p><strong>Ejemplo 2:</strong></p>
<p>Supongamos un programa que me liste lo que contiene el directorio '<em>HOME</em>' de un usuario para diferentes SO, indicándome si lo encontrado es un archivo o una carpeta.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//La siguiente expresión está fuera del alcance de este curso pero por resumir</span>
    <span class="token comment">// lo que hace diremos que ...</span>
    <span class="token comment">// Si me estoy ejecutando en Unix, Linux y MacOS X tomo el valor de la</span>
    <span class="token comment">// carpeta de usuario de la variable HOME, en caso contrário de la</span>
    <span class="token comment">// ubicación que indique Windows en su variable de ambiente.</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> home <span class="token operator">=</span> Environment<span class="token punctuation">.</span>OSVersion<span class="token punctuation">.</span>Platform <span class="token operator">==</span> <span class="token return-type class-name">PlatformID<span class="token punctuation">.</span>Unix          
                  <span class="token punctuation">?</span></span> Environment<span class="token punctuation">.</span><span class="token function">GetEnvironmentVariable</span><span class="token punctuation">(</span><span class="token string">"HOME"</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">"."</span>
                  <span class="token punctuation">:</span> Environment<span class="token punctuation">.</span><span class="token function">ExpandEnvironmentVariables</span><span class="token punctuation">(</span><span class="token string">"%HOMEDRIVE%%HOMEPATH%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code>    <span class="token comment">// Compruebo si existe la ruta devuelta por el entorno.</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>home<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Me sitúo en el directorio home.</span>
        Directory<span class="token punctuation">.</span><span class="token function">SetCurrentDirectory</span><span class="token punctuation">(</span>home<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Instancio el objeto de tipo DirectoryInfo con la información de la carpeta.</span>
        <span class="token class-name">DirectoryInfo</span> infoCarpeta <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">DirectoryInfo</span><span class="token punctuation">(</span>home<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Obtengo información de todos los objetos que hay en dicha carpeta </span>
        <span class="token comment">// ya sean otras capetas o archivos. </span>
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code>        <span class="token comment">// Para eso llamo a GetFileSystemInfos() que me</span>
        <span class="token comment">// devuelve un array de FileSystemInfo con dicha información.</span>
        <span class="token class-name">FileSystemInfo<span class="token punctuation">[</span><span class="token punctuation">]</span></span> infosEnFS <span class="token operator">=</span> infoCarpeta<span class="token punctuation">.</span><span class="token function">GetFileSystemInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Si hubiera querido ver si hay otras carpetas hubiera hecho...</span>
        <span class="token comment">// -&gt; DirectoryInfo[] infoCarpetas = infoCarpeta.GetDirectories();</span>
        <span class="token comment">// De forma análoga si hubiera querido coger solo información de archivos...</span>
        <span class="token comment">// -&gt; FileInfo[] infoArchivos = infoCarpeta.GetFiles();</span>
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code>        <span class="token comment">// Recorro el array.</span>
        <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token class-name">FileSystemInfo</span> infoEnFS <span class="token keyword keyword-in">in</span> infosEnFS<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Compruebo si en la máscara el item que estoy recorriendo </span>
            <span class="token comment">// me indica que es una carpeta.</span>
            <span class="token class-name"><span class="token keyword keyword-bool">bool</span></span> esCarpeta <span class="token operator">=</span> <span class="token punctuation">(</span>infoEnFS<span class="token punctuation">.</span>Attributes <span class="token operator">&amp;</span> FileAttributes<span class="token punctuation">.</span>Directory<span class="token punctuation">)</span> 
                              <span class="token operator">==</span> FileAttributes<span class="token punctuation">.</span>Directory<span class="token punctuation">;</span>
            <span class="token comment">// Muestro el nombre completo indicando si es un archivo o una carpeta.</span>
            <span class="token class-name"><span class="token keyword keyword-string">string</span></span> info <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token punctuation">(</span>esCarpeta <span class="token punctuation">?</span> <span class="token string">"Carpeta"</span><span class="token punctuation">:</span><span class="token string">"Archivo"</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">-&gt;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">infoEnFS<span class="token punctuation">.</span>FullName</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-else">else</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"No se ha podido encontrar la carpeta home."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="contenedor">
    <div class="fondo">
        <div class="abre_comilla">"</div>
        <div class="cierra_comilla">"</div>
        <div class="cita">I think Microsoft named .Net so it wouldn't show up in a Unix directory listing.</div>
        <div class="autor">- Oktal.</div>
    </div>
</div>
<div style="page-break-after:always;"></div>
<div class="caso_estudio">
<p>🎓 <strong>Caso de estudio:</strong></p>
<p>En el siguiente caso de estudio, vamos a crear un método llamado <strong>void OcultaDirectorio(string ruta)</strong> que reciba una ruta a una carpeta y la marque como oculta.<br>
Además, vamos a controlar las posibles excepciones que se generen y las vamos a relanzar al <strong><code>Main</code></strong>. Para ello, si hacemos <strong><code>Ctrl + Click</code></strong> sobre el constructor de <strong><code>DirectoryInfo</code></strong> podemos ver que genera las excepciones:</p>
<ul>
<li><strong><code>UnauthorizedAccessException</code></strong>: Si no tenemos permiso de acceso a la carpeta.</li>
<li><strong><code>ArgumentException</code></strong>: Si la ruta contiene algún caracter inválido.</li>
<li><strong><code>PathTooLongException</code></strong>: Si la ruta es demasiado larga para el SO.</li>
</ul>
<p>Además de las anteriores, generaré yo la excepción <strong><code>FileNotFoundException</code></strong> si no existe la ruta que recibe el método por parámetro.<br>
Una <strong>propuesta de solución</strong> podría ser la siguiente ...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">OcultaDirectorio</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> log <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$"Ocultando el directorio '</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ruta</span><span class="token punctuation">}</span></span><span class="token string">'"</span></span><span class="token punctuation">;</span>
    <span class="token comment">// Mensaje para la consola de depuración.</span>
    Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-try">try</span> 
    <span class="token punctuation">{</span>
        <span class="token class-name">FileSystemInfo</span> d <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">DirectoryInfo</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Genero la excepción indicándo lo que estoy haciendo y además le añado</span>
        <span class="token comment">// como innerException otra instáncia donde indico realmente el error.</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>d<span class="token punctuation">.</span>Exists<span class="token punctuation">)</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">FileNotFoundException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> 
                  <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">FileNotFoundException</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"El directorio '</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ruta</span><span class="token punctuation">}</span></span><span class="token string">' no existe"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Añado con un OR de bit el atributo Hidden (Oculto) a la máscara de </span>
        <span class="token comment">// atributos del FileSystemInfo del directorio.</span>
        d<span class="token punctuation">.</span>Attributes <span class="token operator">|=</span> FileAttributes<span class="token punctuation">.</span>Hidden<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnauthorizedAccessException</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">UnauthorizedAccessException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArgumentException</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ArgumentException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code>    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">PathTooLongException</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">PathTooLongException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Ahora defino un <strong><code>Main</code></strong> donde voy a usar el método definido de tal manera que:</p>
<ol>
<li>Primero creo un directorio llamado <strong><code>'oculto'</code></strong> donde estoy ejecutando la aplicación.</li>
<li>Posteriormente lo ocultaré llamando al método <strong><code>OcultaDirectorio</code></strong>.<br>
Además, capturo cualquier excepción que se pueda producir, tanto creando el directorio prueba, como llamándo al método para ocultarlo,</li>
</ol>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span> 
    <span class="token punctuation">{</span>
        <span class="token class-name">DirectoryInfo</span> d <span class="token operator">=</span> Directory<span class="token punctuation">.</span><span class="token function">CreateDirectory</span><span class="token punctuation">(</span><span class="token string">"oculto"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Fíjate que Directory.CreateDirectory(..) devuelve un DirectoryInfo con la</span>
        <span class="token comment">// información del directorio que acabo de crear y que aprovecho para </span>
        <span class="token comment">// pasar la información de la ruta completa a OcultaDirectorio(...)</span>
        <span class="token function">OcultaDirectorio</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">?</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            e <span class="token operator">=</span> e<span class="token punctuation">.</span>InnerException<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>En este caso de estudio, se propone hacer las siguientes modificaciones...</p>
<ol>
<li>
<p>Ejecutaló y comprueba si se ha creado un directorio oculto llamado <em>'oculto'</em>.</p>
</li>
<li>
<p>Intenta ocultar un directorio inexistente.</p>
</li>
<li>
<p>Revoca todos los permisos a tu usuario para esa carpeta y prueba a ocultarla.</p>
<blockquote>
<p>📌 <strong>Nota:</strong> En el <strong><a href="https://answers.microsoft.com/es-es/windows/forum/all/windows-10-como-quito-los-permisos-de/86863693-988f-4546-b516-2e4298e2586f">siguiente enlace</a></strong> puede ver somo se quitan los permisos al Administrador en Windows 10.<br>
<strong>Intenta hacer lo mismo pero solo para tu usuario</strong>.</p>
</blockquote>
</li>
</ol>
</div> <!-- fin caso de estudio -->

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>