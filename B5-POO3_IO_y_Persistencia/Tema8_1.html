<!DOCTYPE html><html><head>
      <title>Programaci&#xF3;n 1&#xBA; DAM Tema 8.1</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
.markdown-preview.markdown-preview .slides > section {
  height: 100%;
  font-size: 90%;
  overflow-y: auto !important;
}
.markdown-preview.markdown-preview .slide code {
  color: yellow;
}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header undefined" id="tema-81">Tema 8.1</h1>

<p>Descargar estos apuntes en <a href="./Tema8_1.pdf">pdf</a> o <a href="./Tema8_1.html">html</a></p>
<h2 class="mume-header undefined" id="%C3%ADndice">&#xCD;ndice</h2>

<ol>
<li><a href="#definiciones-b%C3%A1sicas">Definiciones b&#xE1;sicas</a></li>
<li><a href="#gesti%C3%B3n-de-rutas-en-net">Gesti&#xF3;n de rutas en .NET</a>
<ol>
<li><a href="#clase-path">Clase Path</a>
<ol>
<li><a href="#operaciones-con-rutas">Operaciones con rutas</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="#gesti%C3%B3n-de-archivos-y-directorios">Gesti&#xF3;n de archivos y directorios</a>
<ol>
<li><a href="#clases-de-utilidad-file-y-directory">Clases de utilidad File y Directory</a>
<ol>
<li><a href="#ejemplo-de-uso-de-file-y-directory">Ejemplo de uso de File y Directory</a></li>
</ol>
</li>
<li><a href="#clases-fileinfo-y-directoryinfo">Clases FileInfo y DirectoryInfo</a>
<ol>
<li><a href="#ejemplos-de-uso-de-fileinfo-y-directoryinfo">Ejemplos de uso de FileInfo y DirectoryInfo</a></li>
<li><a href="#mortar_board-caso-de-estudio-de-gesti%C3%B3n-de-archivos-y-directorios">&#x1F393; Caso de estudio de gesti&#xF3;n de archivos y directorios</a></li>
</ol>
</li>
</ol>
</li>
</ol>
<div style="page-break-after:always;"></div>
<h2 class="mume-header" id="definiciones-b%C3%A1sicas">Definiciones b&#xE1;sicas</h2>

<p>El siguiente <em>&apos;pre-conocimiento&apos;</em> ser&#xE1; necesario tenerlo presente para abordar el siguiente tema. Por pertenecer los siguiente conceptos al curr&#xED;culo del m&#xF3;dulo de <strong>&apos;<em>Sistemas Inform&#xE1;ticos</em>&apos;</strong>, &#xFA;nicamente vamos a enumerar los conceptos que vamos a necesitar.</p>
<ul>
<li>
<p>Un <strong>archivo o fichero</strong> inform&#xE1;tico es un conjunto de bytes que son almacenados en un dispositivo.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
<li>
<p>En inform&#xE1;tica, <strong>una ruta (path, en ingl&#xE9;s)</strong> es la forma de referenciar un archivo inform&#xE1;tico o directorio en un sistema de archivos de un sistema operativo determinado.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
<li>
<p>Las <strong>rutas absolutas</strong> se&#xF1;alan la ubicaci&#xF3;n de un archivo o directorio desde el <strong>directorio ra&#xED;z</strong> del sistema de archivos.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
<li>
<p>Las <strong>rutas relativas</strong> se&#xF1;alan la ubicaci&#xF3;n de un archivo o directorio a partir de nuestra <strong>posici&#xF3;n actual</strong> en el sistema de archivos.<br>
(<em>Fuente Wikipedia</em>)</p>
</li>
</ul>
<h2 class="mume-header" id="gesti%C3%B3n-de-rutas-en-net">Gesti&#xF3;n de rutas en .NET</h2>

<p>Al tratarse .NET de un Framework <strong>multiplataforma</strong>, dispondr&#xE1; de una serie de <strong>clases de utilidad para el manejo de rutas</strong> de forma &apos;<em>transparente</em>&apos; al <strong>Sistema Operativo (SO)</strong> en el que estemos ejecutando.</p>
<h3 class="mume-header" id="clase-path">Clase Path</h3>

<p>Esta clase nos proporcionar&#xE1; de forma abstracta las siguientes propiedades, que pueden tomar valores diferentes dependiendo del SO donde estemos ejecutando.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Campo</th>
<th style="text-align:left">Parte de la ruta que su valor representa</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><code>DirectorySeparatorChar</code></strong></td>
<td style="text-align:left">Separador de directorios. En Windows es <code>\</code>, en Unix es <code>/</code> y Macintosh es <code>:</code></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>AltDirectorySeparatorChar</code></strong></td>
<td style="text-align:left">Car&#xE1;cter alternativo usable como separador de directorios. En Windows y Macintosh es <code>/</code>, - mientras que en Unix es <code>\</code></td>
</tr>
<tr>
<td style="text-align:left"><strong><code>PathSeparator</code></strong></td>
<td style="text-align:left">Separador entre rutas. Aunque en los sistemas operativos m&#xE1;s comunes es ; podr&#xED;a variar en otros.</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>VolumeSeparatorChar</code></strong></td>
<td style="text-align:left">Separador de unidades l&#xF3;gicas. En Windows y Macintosh es : (por ejemplo <code>C:\datos</code>) y en Unix <code>/</code></td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo:</strong> Si en lugar de asignar el siguiente literal en el c&#xF3;digo ...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta <span class="token operator">=</span> <span class="token string">@&quot;\datos\fichero.txt&quot;</span><span class="token punctuation">;</span>
</pre><p>escribimos...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token class-name"><span class="token keyword keyword-char">char</span></span> s <span class="token operator">=</span> Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">datos</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">fichero.txt&quot;</span></span><span class="token punctuation">;</span>
</pre><p>Conseguiremos que la variable <strong><code>ruta</code></strong> almacene el formato de la misma seg&#xFA;n corresponda al sistema operativo sobre el que se ejecute el c&#xF3;digo anterior. Es decir, mientras que en <strong>Windows</strong> contendr&#xED;a <strong><code>\datos\fichero.txt</code></strong>, en <strong>Linux o Mac OSX</strong> contendr&#xED;a <strong><code>/datos/fichero.txt</code></strong></p>
<h4 class="mume-header" id="operaciones-con-rutas">Operaciones con rutas</h4>

<p>Si te fijas en el ejemplo anterior, ocurre que en Windows el car&#xE1;cter usado como separador de directorios <strong><code>\</code></strong> coincide con el que C# usa como indicador de secuencias de escape. Por eso es incorrecto indicar literales de cadena para rutas como <strong><code>&quot;C:\datos&quot;</code></strong>, ya que C# entender&#xED;a que estamos intentando escapar el caracter <strong><code>d</code></strong>.</p>
<p>En su lugar hay tres alternativas:</p>
<ol>
<li>
<p>Usar el campo independiente del sistema operativo <strong><code>$&quot;C:{Path.DirectorySeparatorChar}datos&quot;</code></strong></p>
</li>
<li>
<p>Duplicar los caracteres de los literales para que dejen de considerarse<br>
secuencias de escape. As&#xED;, la ruta de ejemplo anterior quedar&#xED;a... <strong><code>&quot;C:\\datos&quot;</code></strong></p>
</li>
<li>
<p>Lo que hemos hecho en nuestro ejemplo que consiste en especificar la ruta mediante un literal de cadena plano, pues en ellos no se tienen en cuenta las secuencias de escape. As&#xED;, ahora la ruta del ejemplo quedar&#xED;a ... como <strong><code>@&quot;C:\datos&quot;</code></strong>.<br>
Esta opci&#xF3;n es la m&#xE1;s simple, si sabemos cual es el SO donde vamos a ejecutar.</p>
</li>
</ol>
<div style="page-break-after:always;"></div>
<ul>
<li>
<p>Obtener la ruta con el <strong>directorio <em>&apos;padre&apos;</em></strong> o <strong>null</strong> si es ra&#xED;z.</p>
<p><strong>string Path.<a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.path.getdirectoryname?view=net-5.0#System_IO_Path_GetDirectoryName_System_String_">GetDirectoryName</a>(string path)</strong></p>
<ul>
<li><strong><code>GetDirectoryName(@&quot;C:\MyDir\MySubDir\myfile.ext&quot;)</code></strong> devuelve <strong><code>&quot;C:\MyDir\MySubDir&quot;</code></strong></li>
<li><strong><code>GetDirectoryName(@&quot;C:\MyDir\MySubDir&quot;)</code></strong> devuelve <strong><code>&quot;C:\MyDir&quot;</code></strong></li>
<li><strong><code>GetDirectoryName(@&quot;C:\MyDir\&quot;)</code></strong> devuelve <strong><code>&quot;C:\MyDir&quot;</code></strong></li>
<li><strong><code>GetDirectoryName(@&quot;C:\MyDir&quot;)</code></strong> devuelve <strong><code>&quot;C:\&quot;</code></strong></li>
<li><strong><code>GetDirectoryName(@&quot;C:\&quot;)</code></strong> devuelve <strong><code>null</code></strong></li>
</ul>
</li>
<li>
<p>Obtener el archivo o directorio del final de la ruta. (vac&#xED;o si acaba en separador)</p>
<p><strong>string Path.<a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.path.getfilename?view=net-5.0#System_IO_Path_GetFileName_System_String_">GetFileName</a>(string path)</strong></p>
<ul>
<li><strong><code>GetFileName(@&quot;C:\MyDir\MySubDir\myfile.ext&quot;)</code></strong> devuelve <strong><code>&quot;myfile.ext&quot;</code></strong></li>
<li><strong><code>GetFileName(@&quot;C:\MyDir\MySubDir&quot;)</code></strong> devuelve <strong><code>&quot;MySubDir&quot;</code></strong></li>
<li><strong><code>GetFileName(@&quot;C:\MyDir\&quot;)</code></strong> devuelve <strong><code>&quot;&quot;</code></strong> (Cadena vac&#xED;a)</li>
</ul>
</li>
<li>
<p>Combinar un <strong>DirectoryName path1</strong> y un <strong>FileName path2</strong> para formar <strong>una nueva ruta</strong>.</p>
<blockquote>
<p>&#x26A0;&#xFE0F; <strong>Nota:</strong> Siempre que <strong>path2</strong> no empiece por el car&#xE1;cter separador de directorio o de volumen.</p>
</blockquote>
<p><strong>string <a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.path.combine?view=net-5.0#System_IO_Path_Combine_System_String_System_String_">Combine</a>(string path1, string path2);</strong></p>
<ul>
<li><strong><code>Combine(@&quot;C:\MyDir&quot;, @&quot;myfile.ext&quot;)</code></strong> devuelve <strong><code>&quot;C:\MyDir\myfile.ext&quot;</code></strong></li>
<li><strong><code>Combine(@&quot;C:\MyDir\&quot;, @&quot;myfile.ext&quot;)</code></strong> devuelve <strong><code>&quot;C:\MyDir\myfile.ext&quot;</code></strong></li>
<li><strong><code>Combine(@&quot;C:\MyDir&quot;, @&quot;MySubDir\myfile.ext&quot;)</code></strong>  devuelve <strong><code>&quot;C:\MyDir\MySubDir\myfile.ext&quot;</code></strong></li>
<li><strong><code>Combine(@&quot;C:\MyDir\&quot;, @&quot;MySubDir\myfile.ext&quot;)</code></strong> devuelve <strong><code>&quot;C:\MyDir\MySubDir\myfile.ext&quot;</code></strong></li>
<li>&#x274C; <strong><code>Combine(@&quot;C:\MyDir\&quot;, @&quot;\MySubDir\myfile.ext&quot;)</code></strong></li>
<li>&#x274C; <strong><code>Combine(@&quot;C:\MyDir\&quot;, @&quot;C:\MySubDir\myfile.ext&quot;)</code></strong></li>
</ul>
</li>
</ul>
<div style="page-break-after:always;"></div>
<h2 class="mume-header" id="gesti%C3%B3n-de-archivos-y-directorios">Gesti&#xF3;n de archivos y directorios</h2>

<h3 class="mume-header" id="clases-de-utilidad-file-y-directory">Clases de utilidad File y Directory</h3>

<p>Ambas clases contienen gran cantidad de <strong>m&#xE9;todos est&#xE1;ticos de utilidad</strong> para hacer <strong>operaciones</strong> con ficheros/archivos y directorios/carpetas, del estilo de las que se hacen desde la <strong>l&#xED;nea de comandos</strong>.</p>
<p>L&#xF3;gicamente los m&#xE9;todos definidos en <strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.directory?view=net-5.0">Directory</a></strong> realizan operaciones sobre <strong>directorios</strong> y los definidos en <strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.file?view=net-5.0">File</a></strong> sobre <strong>archivos</strong>.</p>
<blockquote>
<p><strong>Nota:</strong> C&#xF3;mo no es idea de estos temas copiar la documentaci&#xF3;n de Microsoft en castellano. Es recomendable que le eches un vistazo a los enlaces del anterior p&#xE1;rrafo para hacerte una idea de las operaciones definidas en estas clases.</p>
</blockquote>
<h4 class="mume-header" id="ejemplo-de-uso-de-file-y-directory">Ejemplo de uso de File y Directory</h4>

<p>Veamos alguno de estos m&#xE9;todos a trav&#xE9;s del siguiente <strong>ejemplo comentado</strong>:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-char">char</span></span> s <span class="token operator">=</span> Path<span class="token punctuation">.</span>DirectorySeparatorChar<span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$&quot;.</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">datos</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">datos.txt&quot;</span></span><span class="token punctuation">;</span>

    <span class="token comment">// Si no existe el directorio datos en la ruta relativa actual lo crear&#xE9;.</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">GetDirectoryName</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        Directory<span class="token punctuation">.</span><span class="token function">CreateDirectory</span><span class="token punctuation">(</span><span class="token string">&quot;datos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Creo el fichero datos.txt vac&#xED;o. M&#xE1;s adelante en el tema</span>
    <span class="token comment">// veremos que llamar al Close() es importante para que no</span>
    <span class="token comment">// se quede abierto.</span>
    File<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Me sit&#xFA;o en el directorio datos.</span>
    Directory<span class="token punctuation">.</span><span class="token function">SetCurrentDirectory</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">GetDirectoryName</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">s</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Console<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">&quot;El fichero &quot;</span> <span class="token operator">+</span> ruta <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Compruebo si se ha creado el fichero correctamente viendo si </span>
    <span class="token comment">// existe o no en el directorio datos (donde me acabo de situar).</span>
    <span class="token comment">// Mostrar&#xE9; si existe o no por pantalla.</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>File<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>Path<span class="token punctuation">.</span><span class="token function">GetFileName</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">?</span><span class="token string">&quot;existe&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;no existe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><div style="page-break-after:always;"></div>
<h3 class="mume-header" id="clases-fileinfo-y-directoryinfo">Clases FileInfo y DirectoryInfo</h3>

<p>Adem&#xE1;s de las clases con m&#xE9;todos de operaciones sobre directorios y ficheros. Tambi&#xE9;n dispondremos de objetos que contendr&#xE1;n informaci&#xF3;n sobre los mismos adem&#xE1;s de permitirnos tambi&#xE9;n hacer ciertas operaciones.<br>
Dichos objetos se instanciar&#xE1;n en memoria a trav&#xE9;s de las clases...</p>
<p><strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.directoryinfo?view=net-5.0">DirectoryInfo</a></strong> y <strong><a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.fileinfo?view=net-5.0">FileInfo</a></strong> pues ...</p>
<ul>
<li>
<p>Me devolver&#xE1;n informaci&#xF3;n sobre <strong>carpetas</strong> y <strong>archivos</strong> respectivamente.</p>
</li>
<li>
<p>Adem&#xE1;s de permitirme <em>&apos;navegar</em> por el sistema de ficheros, movi&#xE9;ndome entre las diferentes carpetas. Me permitir&#xE1;n <strong>realizar acciones m&#xE1;s precisas y con m&#xE1;s detalle</strong> sobre el sistema de ficheros.</p>
</li>
<li>
<p><strong>Ambas clases heredar&#xE1;n de la clases abstracta</strong> <code>FileSystemInfo</code> que contendr&#xE1; la informaci&#xF3;n com&#xFA;n a archivos y carpetas. Un ejemplo ser&#xED;a la fecha de creaci&#xF3;n y otras propiedades comunes.</p>
</li>
<li>
<p>La abstracci&#xF3;n del sistema de ficheros se almacena en la clase <strong><code>FileSystemInfo</code></strong>:</p>
<ul>
<li>Se acceder&#xE1; a trav&#xE9;s de la sustituci&#xF3;n de Liskov de objetos de tipo <strong><code>DirectoryInfo</code></strong> o <strong><code>FileInfo</code></strong>.</li>
</ul>
<p align="center" style="zoom:0.8"><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" contentscripttype="application/ecmascript" contentstyletype="text/css" height="335px" preserveAspectRatio="none" style="width:496px;height:335px;background:#FFFFFF;" version="1.1" viewBox="0 0 496 335" width="496px" zoomAndPan="magnify"><defs><filter height="300%" id="f16zo7l63bh4vn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFAFA" filter="url(#f16zo7l63bh4vn)" height="110.4932" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.5;" width="214" x="263" y="111.3452"/><text fill="#000000" font-family="Arial" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="103" x="318.5" y="139.4771">FileSystemInfo</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="0" x="372" y="155.5757"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="166" x="287" y="171.6743">Informaci&#xF3;n y operaciones</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="184" x="278" y="187.7729">comunes a ambos elementos</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="149" x="295.5" y="203.8716">del sistema de ficheros.</text><rect fill="#F0F8FF" filter="url(#f16zo7l63bh4vn)" height="126.5918" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.5;" width="193" x="10" y="25"/><text fill="#000000" font-family="Arial" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="91" x="61" y="53.1318">DirectoryInfo</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="0" x="108.5" y="69.2305"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="134" x="39.5" y="85.3291">Contiene informaci&#xF3;n</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="142" x="35.5" y="101.4277">especifica de carpetas</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="163" x="25" y="117.5264">y operaciones especificas</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="113" x="50" y="133.625">sobre las mismas.</text><path d="M263,166.5918 L253,166.5918 C238,166.5918 228,88.2959 213,88.2959 L203,88.2959 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><rect fill="#F0F8FF" filter="url(#f16zo7l63bh4vn)" height="126.5918" rx="12.5" ry="12.5" style="stroke:#000000;stroke-width:1.5;" width="193" x="10" y="181.5918"/><text fill="#000000" font-family="Arial" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="53" x="80" y="209.7236">FileInfo</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="0" x="108.5" y="225.8223"/><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="134" x="39.5" y="241.9209">Contiene informaci&#xF3;n</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="140" x="36.5" y="258.0195">especifica de archivos</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="163" x="25" y="274.1182">y operaciones especificas</text><text fill="#000000" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="73" x="70" y="290.2168">sobre ellos.</text><path d="M263,166.5918 L253,166.5918 C238,166.5918 228,244.8877 213,244.8877 L203,244.8877 " fill="none" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[67eadec79a77fa2da0d8f470ea10fcc2]
@startmindmap
right to left direction
<style>
mindmapDiagram {
  Linecolor black
  FontName Arial
  FontSize 14
  node {
    Padding 15
    Margin 15
    HorizontalAlignment center
    BackGroundColor white
  }
}
</style>

*[#snow] **FileSystemInfo**\n\nInformación y operaciones\ncomunes a ambos elementos\ndel sistema de ficheros.

**[#aliceblue] **DirectoryInfo**\n\nContiene información\nespecifica de carpetas\ny operaciones especificas\nsobre las mismas.
**[#aliceblue] **FileInfo**\n\nContiene información\nespecifica de archivos\ny operaciones especificas\nsobre ellos.

@endmindmap

PlantUML version 1.2021.12(Tue Oct 05 18:01:58 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: es
Country: ES
--></g></svg></p><ul>
<li>Una ejemplo de esta informaci&#xF3;n com&#xFA;n detallada. Es el campo <strong><code>Attributes</code></strong> del sistema de ficheros.<br>
El campo <strong><code>Attributes</code></strong> es una m&#xE1;scara creada a partir del <strong>Enum <a href="https://docs.microsoft.com/es-es/dotnet/api/system.io.fileattributes?view=net-5.0">FileAttributes</a></strong>. Con informaci&#xF3;n com&#xFA;n a ficheros y directorios.
<blockquote>
<p>&#x1F4E3; <strong>Nota:</strong> &#xC9;chale un vistazo a los bits de la m&#xE1;scara en el enlace del tipo.</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<p>Aunque ser&#xED;a inabordable tratar todas los casos de uso de estos objetos. Vamos a ver un par ejemplos y un caso de uso.</p>
<div style="page-break-after:always;"></div>
<h4 class="mume-header" id="ejemplos-de-uso-de-fileinfo-y-directoryinfo">Ejemplos de uso de FileInfo y DirectoryInfo</h4>

<p><strong>Ejemplo 1:</strong></p>
<p>Supongamos una funci&#xF3;n que recibe la ruta al fichero del sistema Windows 10 <strong><code>C:\Windows\write.exe</code></strong> y nos muestra la informaci&#xF3;n com&#xFA;n almacenada en la clase abstracta <strong><code>FileSystemInfo</code></strong> sobre &#xE9;l.</p>
<pre data-role="codeBlock" data-info="csharp {class=&quot;line-numbers&quot;}" class="language-csharp line-numbers"><span class="token keyword keyword-class">class</span> <span class="token class-name">EjemploFileInfo</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> <span class="token function">ObtenInformacion</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> rutaAFichero<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Obtenemos la informaci&#xF3;n del fichero y </span>
        <span class="token comment">// hacemos una sustituci&#xF3;n a la superclase.</span>
        <span class="token class-name">FileSystemInfo</span> f <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">FileInfo</span><span class="token punctuation">(</span>rutaAFichero<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">StringBuilder</span> informacion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// A&#xF1;adimos informaci&#xF3;n del fichero.</span>
        <span class="token comment">// F&#xED;jate que f.Attributes muestra todos </span>
        <span class="token comment">// los valores dele enum a&#xF1;adidos a la m&#xE1;scara.</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">.</span>Exists<span class="token punctuation">)</span>
            informacion<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Nombre completo: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>FullName</span><span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Nombre : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>Name</span><span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Extensi&#xF3;n : </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>Extension</span><span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Fecha creaci&#xF3;n: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>CreationTime</span><span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Fecha &#xFA;ltimo acceso: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>LastAccessTime</span><span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Fecha &#xFA;ltima modificaci&#xF3;n: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>LastWriteTime</span><span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span>
                       <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;Atributos: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">f<span class="token punctuation">.</span>Attributes</span><span class="token punctuation">}</span></span><span class="token string">\n&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-else">else</span> 
            informacion<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token string">&quot;Archivo no encontrado&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-return">return</span> informacion<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">ObtenInformacion</span><span class="token punctuation">(</span><span class="token string">@&quot;C:\Windows\write.exe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><div style="page-break-after:always;"></div>
<p><strong>Ejemplo 2:</strong></p>
<p>Supongamos un programa que me liste lo que contiene el directorio &apos;<em>HOME</em>&apos; de un usuario para diferentes SO, indic&#xE1;ndome si lo encontrado es un archivo o una carpeta.</p>
<pre data-role="codeBlock" data-info="csharp {class=&quot;line-numbers&quot;}" class="language-csharp line-numbers"><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//La siguiente expresi&#xF3;n est&#xE1; fuera del alcance de este curso pero por resumir</span>
    <span class="token comment">// lo que hace diremos que ...</span>
    <span class="token comment">// Si me estoy ejecutando en Unix, Linux y MacOS X tomo el valor de la</span>
    <span class="token comment">// carpeta de usuario de la variable HOME, en caso contr&#xE1;rio de la</span>
    <span class="token comment">// ubicaci&#xF3;n que indique Windows en su variable de ambiente.</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> home <span class="token operator">=</span> Environment<span class="token punctuation">.</span>OSVersion<span class="token punctuation">.</span>Platform <span class="token operator">==</span> <span class="token return-type class-name">PlatformID<span class="token punctuation">.</span>Unix          
                  <span class="token punctuation">?</span></span> Environment<span class="token punctuation">.</span><span class="token function">GetEnvironmentVariable</span><span class="token punctuation">(</span><span class="token string">&quot;HOME&quot;</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">&quot;.&quot;</span>
                  <span class="token punctuation">:</span> Environment<span class="token punctuation">.</span><span class="token function">ExpandEnvironmentVariables</span><span class="token punctuation">(</span><span class="token string">&quot;%HOMEDRIVE%%HOMEPATH%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Compruebo si existe la ruta devuelta por el entorno.</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>Directory<span class="token punctuation">.</span><span class="token function">Exists</span><span class="token punctuation">(</span>home<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Me sit&#xFA;o en el directorio home.</span>
        Directory<span class="token punctuation">.</span><span class="token function">SetCurrentDirectory</span><span class="token punctuation">(</span>home<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Instancio el objeto de tipo DirectoryInfo con la informaci&#xF3;n de la carpeta.</span>
        <span class="token class-name">DirectoryInfo</span> infoCarpeta <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">DirectoryInfo</span><span class="token punctuation">(</span>home<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Obtengo informaci&#xF3;n de todos los objetos que hay en dicha carpeta ya sean</span>
        <span class="token comment">// otras capetas o archivos. Para eso llamo a GetFileSystemInfos() que me</span>
        <span class="token comment">// devuelve un array de FileSystemInfo con dicha informaci&#xF3;n.</span>
        <span class="token class-name">FileSystemInfo<span class="token punctuation">[</span><span class="token punctuation">]</span></span> infosEnFS <span class="token operator">=</span> infoCarpeta<span class="token punctuation">.</span><span class="token function">GetFileSystemInfos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Si hubiera querido ver si hay otras carpetas hubiera hecho...</span>
        <span class="token comment">// -&gt; DirectoryInfo[] infoCarpetas = infoCarpeta.GetDirectories();</span>
        <span class="token comment">// De forma an&#xE1;loga si hubiera querido coger solo informaci&#xF3;n de archivos...</span>
        <span class="token comment">// -&gt; FileInfo[] infoArchivos = infoCarpeta.GetFiles();</span>

        <span class="token comment">// Recorro el array.</span>
        <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token class-name">FileSystemInfo</span> infoEnFS <span class="token keyword keyword-in">in</span> infosEnFS<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Compruebo si en la m&#xE1;scara el item que estoy recorriendo </span>
            <span class="token comment">// me indica que es una carpeta.</span>
            <span class="token class-name"><span class="token keyword keyword-bool">bool</span></span> esCarpeta <span class="token operator">=</span> <span class="token punctuation">(</span>infoEnFS<span class="token punctuation">.</span>Attributes <span class="token operator">&amp;</span> FileAttributes<span class="token punctuation">.</span>Directory<span class="token punctuation">)</span> 
                              <span class="token operator">==</span> FileAttributes<span class="token punctuation">.</span>Directory<span class="token punctuation">;</span>
            <span class="token comment">// Muestro el nombre completo indicando si es un archivo o una carpeta.</span>
            <span class="token class-name"><span class="token keyword keyword-string">string</span></span> info <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token punctuation">(</span>esCarpeta <span class="token punctuation">?</span> <span class="token string">&quot;Carpeta&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;Archivo&quot;</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">-&gt;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">infoEnFS<span class="token punctuation">.</span>FullName</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">;</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-else">else</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;No se ha podido encontrar la carpeta home.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre><div style="page-break-after:always;"></div>
<h4 class="mume-header" id="mortar_board-caso-de-estudio-de-gesti%C3%B3n-de-archivos-y-directorios">&#x1F393; Caso de estudio de gesti&#xF3;n de archivos y directorios</h4>

<p>En el siguiente caso de estudio, vamos a crear un m&#xE9;todo llamado <strong>void OcultaDirectorio(string ruta)</strong> que reciba una ruta a una carpeta y la marque como oculta.<br>
Adem&#xE1;s, vamos a controlar las posibles excepciones que se generen y las vamos a relanzar al <strong><code>Main</code></strong>. Para ello, si hacemos <strong><code>Ctrl + Click</code></strong> sobre el constructor de <strong><code>DirectoryInfo</code></strong> podemos ver que genera las excepciones:</p>
<ul>
<li><strong><code>UnauthorizedAccessException</code></strong>: Si no tenemos permiso de acceso a la carpeta.</li>
<li><strong><code>ArgumentException</code></strong>: Si la ruta contiene alg&#xFA;n caracter inv&#xE1;lido.</li>
<li><strong><code>PathTooLongException</code></strong>: Si la ruta es demasiado larga para el SO.</li>
</ul>
<p>Adem&#xE1;s de las anteriores, generar&#xE9; yo la excepci&#xF3;n <strong><code>FileNotFoundException</code></strong> si no existe la ruta que recibe el m&#xE9;todo por par&#xE1;metro.<br>
Una <strong>propuesta de soluci&#xF3;n</strong> podr&#xED;a ser la siguiente ...</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">OcultaDirectorio</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> ruta<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> log <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$&quot;Ocultando el directorio &apos;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ruta</span><span class="token punctuation">}</span></span><span class="token string">&apos;&quot;</span></span><span class="token punctuation">;</span>
    <span class="token comment">// Mensaje para la consola de depuraci&#xF3;n.</span>
    Debug<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-try">try</span> 
    <span class="token punctuation">{</span>
        <span class="token class-name">FileSystemInfo</span> d <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">DirectoryInfo</span><span class="token punctuation">(</span>ruta<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Genero la excepci&#xF3;n indic&#xE1;ndo lo que estoy haciendo y adem&#xE1;s le a&#xF1;ado</span>
        <span class="token comment">// como innerException otra inst&#xE1;ncia donde indico realmente el error.</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>d<span class="token punctuation">.</span>Exists<span class="token punctuation">)</span>
            <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">FileNotFoundException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> 
                  <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">FileNotFoundException</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$&quot;El directorio &apos;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">ruta</span><span class="token punctuation">}</span></span><span class="token string">&apos; no existe&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// A&#xF1;ado con un OR de bit el atributo Hidden (Oculto) a la m&#xE1;scara de </span>
        <span class="token comment">// atributos del FileSystemInfo del directorio.</span>
        d<span class="token punctuation">.</span>Attributes <span class="token operator">|=</span> FileAttributes<span class="token punctuation">.</span>Hidden<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnauthorizedAccessException</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">UnauthorizedAccessException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArgumentException</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ArgumentException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">PathTooLongException</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">PathTooLongException</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><div style="page-break-after:always;"></div>
<p>Ahora defino un <strong><code>Main</code></strong> donde voy a usar el m&#xE9;todo definido de tal manera que:</p>
<ol>
<li>Primero creo un directorio llamado <strong><code>&apos;oculto&apos;</code></strong> donde estoy ejecutando la aplicaci&#xF3;n.</li>
<li>Posteriormente lo ocultar&#xE9; llamando al m&#xE9;todo <strong><code>OcultaDirectorio</code></strong>.<br>
Adem&#xE1;s, capturo cualquier excepci&#xF3;n que se pueda producir, tanto creando el directorio prueba, como llam&#xE1;ndo al m&#xE9;todo para ocultarlo,</li>
</ol>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp"><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span> 
    <span class="token punctuation">{</span>
        <span class="token class-name">DirectoryInfo</span> d <span class="token operator">=</span> Directory<span class="token punctuation">.</span><span class="token function">CreateDirectory</span><span class="token punctuation">(</span><span class="token string">&quot;oculto&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// F&#xED;jate que Directory.CreateDirectory(..) devuelve un DirectoryInfo con la</span>
        <span class="token comment">// informaci&#xF3;n del directorio que acabo de crear y que aprovecho para </span>
        <span class="token comment">// pasar la informaci&#xF3;n de la ruta completa a OcultaDirectorio(...)</span>
        <span class="token function">OcultaDirectorio</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>FullName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">?</span> e<span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            e <span class="token operator">=</span> e<span class="token punctuation">.</span>InnerException<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>En este caso de estudio, se propone hacer las siguientes modificaciones...</p>
<ol>
<li>Ejecutal&#xF3; y comprueba si se ha creado un directorio oculto llamado <em>&apos;oculto&apos;</em>.</li>
<li>Intenta ocultar un directorio inexistente.</li>
<li>Revoca todos los permisos a tu usuario para esa carpeta y prueba a ocultarla.
<blockquote>
<p>&#x1F4E3; <strong>Nota:</strong> En el <strong><a href="https://answers.microsoft.com/es-es/windows/forum/all/windows-10-como-quito-los-permisos-de/86863693-988f-4546-b516-2e4298e2586f">siguiente enlace</a></strong> puede ver somo se quitan los permisos al Administrador en Windows 10.<br>
<strong>Intenta hacer lo mismo pero solo para tu usuario</strong>.</p>
</blockquote>
</li>
</ol>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>