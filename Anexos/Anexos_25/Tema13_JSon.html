<!DOCTYPE html><html><head>
      <title>Funcionales Interesantes del Lenguaje C#</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v19/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview .caso_estudio {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .resumen {
  background-color: #d6d6d6;
  border: 2px solid #b0b0b0;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .ejercicio {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}
.markdown-preview.markdown-preview .cabeceras_examen {
  background-color: #fcfcfc;
  border: 2px solid #b7bbb7;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
  color: black;
  font-size: 8pt;
}
.markdown-preview.markdown-preview .ejercicio_control {
  background-color: #f9faf9;
  border: 2px solid #b4b7b4;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="tema-13-json">Tema 13 JSon </h1>
<p>Descargar estos apuntes en <a href="./Tema13_JSon.pdf">pdf</a> o <a href="./Tema13_JSon.html">html</a></p>
<h2 id="índice">Índice </h2>

<div class="md-toc">
<details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#serialización-de-objetos" class="md-toc-link"><p>Serialización de Objetos</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#persistencia" class="md-toc-link"><p>Persistencia</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#concepto-de-anotación-o-atributo" class="md-toc-link">
            <p>Concepto de Anotación o Atributo</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#serialización-a-json" class="md-toc-link"><p>Serialización a JSON</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#qué-es-json" class="md-toc-link">
            <p>¿Qué es JSON?</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#json-en-csharp" class="md-toc-link">
            <p>JSON en CSharp</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#propiedades-opcionales" class="md-toc-link">
            <p>Propiedades Opcionales</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    
</div>
<div style="page-break-after:always;"></div>
<h3 id="serialización-de-objetos">Serialización de Objetos </h3>
<h4 id="persistencia">Persistencia </h4>
<p>Se define por persistencia en el mundo de la POO, como la <strong>capacidad que tienen los objetos de sobrevivir al proceso padre que los creo</strong>. Esto decir, que su ciclo de vida excede de la del programa que lo instanció.</p>
<p>La persistencia permite al programador pues almacenar, transferir y recuperar fácilmente el estado de los objetos.</p>
<p><strong>¿Cómo podemos conseguir la persistencia?</strong></p>
<p>La forma más común de conseguirlo es mediante la <strong>serialización</strong>.</p>
<p>La serialización es el proceso de convertir el estado de un objeto a un formato que se pueda <strong>almacenar</strong> o <strong>transportar</strong>. Normalmente el proceso producirá una <strong>secuencia</strong> de bytes o texto de marcado.</p>
<p>El complemento de la serialización es la <strong>deserialización</strong>, que convierte una secuencia de bytes o texto de marcado a un objeto. Ambos procesos pues permiten almacenar y transferir fácilmente datos.</p>
<p><strong>¿A qué serializaremos una clase?</strong></p>
<p>.NET ofrece dos tecnologías de serialización:</p>
<ul>
<li>
<p>La <strong>serialización binaria</strong> conserva la fidelidad de tipos, lo que resulta útil para conservar el estado de un objeto entre distintas llamadas a una aplicación. Puedes serializar un objeto en una secuencia de bytes que cómo hemos visto podemos pasar a disco, la memoria, a través de la red, etc. Ejemplos ...</p>
<ul>
<li>Compartir un objeto entre distintas aplicaciones '<em>serializándolo</em>' en el Portapapeles.</li>
<li>Hacer <strong>streaming</strong> de vídeo serializando objetos con información de<br>
vídeo comprimido a través de la red.</li>
</ul>
<blockquote>
<p>⚠️ <strong>Aviso</strong>: En las últimas versiones de .NET se recomienda usar la serialización binaria sólo para casos muy específicos, como la comunicación entre aplicaciones .NET y ha sido marcada como <strong>peligrosa</strong> y <strong>obsoleta</strong>. Es por eso que en estos apuntes no se tratará la serialización binaria.</p>
</blockquote>
</li>
<li>
<p>La <strong>serialización a lenguajes de marcado</strong> como:</p>
<ul>
<li>
<p>La <strong>serialización a XML</strong> sólo serializa las propiedades públicas y los campos, y no conserva la fidelidad de tipos. Esto resulta útil cuando desea proporcionar o consumir datos sin restringir la aplicación que utiliza los datos.</p>
</li>
<li>
<p>La <strong>serialización a alguna notación de objetos</strong> estándar cada vez más comunes y cuya función sería la misma que el XML pero menos '<em>verbosas</em>' y más fáciles de leer y/o modificar para humanos. Los más comunes son:</p>
<ul>
<li><strong>JSON</strong>: Definir configuraciones o consumo de datos a través de microservicios web o bases de datos NoSQL.</li>
<li><strong>YAML</strong>: Muy usado para definir archivos de configuración de sistemas.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>La gran mayoría de librerías de serialización de objetos en .NET y en otros lenguajes utilizan el concepto de <strong>anotaciones</strong> o <strong>atributos</strong> para definir cómo se serializará un objeto. Es por eso, que antes de empezar a serializar un objeto, deberemos entender qué son las anotaciones o atributos.</p>
<h5 id="concepto-de-anotación-o-atributo">Concepto de Anotación o Atributo </h5>
<blockquote>
<p>✋ <strong>Importante</strong>: Las <strong>anotaciones</strong> son muy comunes en lenguajes como Java o Kotlin y básicamente son metadatos que se pueden añadir a clases, métodos, campos, etc. y <strong>modificar el comportamiento justo del elemento al que antecede</strong>. En C# se les denomina <strong>atributos</strong> aunque este término <strong>puede ser confuso</strong>, pues también es usado en la Programación Orientada a Objetos para hacer referencia a los que nosotros hemos llamado <strong>campos</strong> y <strong>propiedades</strong>.</p>
</blockquote>
<p>Una <strong><a href="https://learn.microsoft.com/es-es/dotnet/csharp/advanced-topics/reflection-and-attributes/attribute-tutorial">atributo</a></strong> pues en .NET, es una etiqueta de la sintaxis <strong><code>[nombre]</code></strong> que podremos aplicar a un ensamblado, clase, constructor, enumeración, campo, interfaz, método, etc… y que <strong>genera información en el ensamblado</strong> en forma de metadatos heredando de la clase <strong><code>Attribute</code></strong>.</p>
<p>Por ejemplo, el atributo <strong><code>[Obsolete]</code></strong> es un atributo que se puede aplicar a un método o a una clase y que indica que el método o la clase están obsoletos y que no deberían usarse.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Obsolete</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"Este método está obsoleto. Utilice en su lugar el método X"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">MetodoObsoleto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Código del método }</span>
</code></pre><p>Otro ejemplo sería el atributo <strong><code>[NotNull]</code></strong> que se puede aplicar a un parámetro de un método y que indica que el parámetro no puede ser nulo incluso si el tipo de dato del parámetro es un tipo de dato que puede ser nulo.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Metodo</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">NotNull</span></span><span class="token punctuation">]</span> <span class="token class-name"><span class="token keyword keyword-string">string</span><span class="token punctuation">?</span></span> parametro<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Código del método }</span>
</code></pre><p>En el ejemplo anterior, el atributo <strong><code>[NotNull]</code></strong> indica que el parámetro <strong><code>parametro</code></strong> no puede ser nulo.</p>
<h4 id="serialización-a-json">Serialización a JSON </h4>
<p>La serialización a JSON es un proceso que convierte un objeto en una cadena JSON y viceversa. JSON es un formato de texto que es fácil de leer y escribir para los humanos y fácil de analizar y generar para las máquinas.</p>
<h5 id="qué-es-json">¿Qué es JSON? </h5>
<p>Aunque este tema se tratará con más profundidad en el módulo de LM y en segundo curso. Vamos ha realizar un resumen rápido sobre dicho formato para entenderlo por por encima.</p>
<p><strong>JSON</strong> (Javascript Object Notation) es un formato ligero de intercambio de datos entre clientes y servidores, basado en la sintaxis de Javascript para representar estructuras en forma organizada. Es un formato en texto plano independiente de todo lenguaje de programación, es más, soporta el intercambio de datos en gran variedad de lenguajes. El estándar de JSON se especifica en el <strong><a href="https://datatracker.ietf.org/doc/html/rfc7159">RFC 7159</a></strong> y se ha estandarizado en la <strong><a href="https://ecma-international.org/publications-and-standards/standards/ecma-404/">ECMA-404</a></strong>. Así pues, puedes consultar la especificación del RFC para profundizar más en él.</p>
<h6 id="tipos-de-datos-en-json">Tipos de datos en JSON </h6>
<p>Similar a la estructuración de datos primitivos y complejos en los lenguajes de programación, JSON establece varios tipos de datos: <strong><code>cadenas</code></strong>, <strong><code>números</code></strong>, <strong><code>booleanos</code></strong>, <strong><code>arrays</code></strong> y <strong><code>objetos</code></strong>. El propósito es crear objetos que contengan varios atributos compuestos como pares clave valor. Donde la clave es un nombre que identifique el uso del valor que lo acompaña. Veamos un ejemplo:</p>
<div class="flotante" ,="" style="align-items: center;">
<div class="flotante_izq">
<p>El JSON de ejemplo estña compuesto por los datos de un <strong>estudiante</strong>. Los objetos JSON contienen sus atributos entre llaves <strong><code>{}</code></strong>, al igual que un bloque de código en Javascript, donde cada atributo debe ir separado por coma <strong><code>,</code></strong> para diferenciar cada par. La sintaxis de los pares debe contener dos puntos <strong><code>:</code></strong> para dividir la clave del valor. El nombre del par debe tratarse como cadena y añadirle <strong>comillas dobles</strong>.</p>
</div>
<div class="flotante_der">
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
   <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">101</span><span class="token punctuation">,</span>
   <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Carlos"</span><span class="token punctuation">,</span>
   <span class="token property">"estaActivo"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   <span class="token property">"notas"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2.3</span><span class="token punctuation">,</span> <span class="token number">4.3</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>
<p>Si te fijas en nuestro ejemplo, este trae un ejemplo de cada tipo de dato:</p>
<ul>
<li>
<p><strong><code>id</code></strong> es de tipo entero, ya que contiene un número que representa el código del estudiante.</p>
</li>
<li>
<p><strong><code>nombre</code></strong> es un string. Usa comillas dobles para definirlas.</p>
</li>
<li>
<p><strong><code>estaActivo</code></strong> es un tipo booleano que representa si el estudiante se encuentra en la institución educativa o no. Usa las palabras reservadas <strong><code>true</code></strong> y <strong><code>false</code></strong> para declarar el valor.</p>
</li>
<li>
<p><strong><code>notas</code></strong> es un arreglo de números reales. El conjunto de sus elementos debes incluirlos dentro de corchetes <strong><code>[ ]</code></strong> y separarlos por coma.</p>
</li>
</ul>
<div class="flotante" ,="" style="align-items: center;">
<div class="flotante_izq">
<p>Básicamente esta sería la sintaxis, pero en los documentos se pueden dar casos más complejos como objetos anidados, arrays de objetos, etc. Por ejemplo si modificamos el ejemplo anterior para que el estudiante en lugar de una array de notas numérico tenga un array de objetos con las asignaturas y sus notas, el documento JSON quedaría así:</p>
<p>Fíjate que el documento tiene un <strong>objeto raíz</strong> que contiene el resto de objetos. En nuestro caso el objeto raíz es un estudiante. Pero también podríamos tener un array de estudiantes directamente en el documento JSON.</p>
</div>
<div class="flotante_der">
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
   <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">101</span><span class="token punctuation">,</span>
   <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Carlos"</span><span class="token punctuation">,</span>
   <span class="token property">"estaActivo"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
   <span class="token property">"asignaturas"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
         <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Matemáticas"</span><span class="token punctuation">,</span>
         <span class="token property">"nota"</span><span class="token operator">:</span> <span class="token number">4.5</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
         <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Lengua"</span><span class="token punctuation">,</span>
         <span class="token property">"nota"</span><span class="token operator">:</span> <span class="token number">5.0</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>
<h5 id="json-en-csharp">JSON en CSharp </h5>
<p>C# dentro de las BCL y dentro del espacio de nombres <strong><code>System.Text.Json</code></strong> define una serie de clases que nos permiten trabajar con JSON. EN concreto nos centraremos en la clase <strong><code>JsonSerializer</code></strong> que nos permitirá serializar y deserializar objetos a JSON y se define en el espacio de nombres <strong><code>System.Text.Json.Serialization</code></strong>.</p>
<p>Supongamos el siguiente <strong><code>record</code></strong> con datos de un estudiante:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-record">record</span> <span class="token class-name">Estudiante</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> Nombre<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Apellido<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-int">int</span></span> Edad<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="flotante" ,="" style="align-items: center;">
<div class="flotante_izq">
<p>Si la serializamos tal cual a JSON, obtendremos un JSON como el del ejemplo usando como claves los nombres de las propiedades del record en PascalCase y el convenio en JSON es usar camelCase. Para cambiar el nombre de la clave asociada a una propiedad, podemos usar la anotación/atributo <strong><code>[JsonPropertyName]</code></strong> de la siguiente manera ...</p>
</div>
<div class="flotante_der">
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
  <span class="token property">"Nombre"</span><span class="token operator">:</span> <span class="token string">"Carlos"</span><span class="token punctuation">,</span>
  <span class="token property">"Apellido"</span><span class="token operator">:</span> <span class="token string">"García"</span><span class="token punctuation">,</span>
  <span class="token property">"Edad"</span><span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>
<div class="flotante" ,="" style="align-items: center;">
<div class="flotante_izq">
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-record">record</span> <span class="token class-name">Estudiante</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"nombre"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Nombre<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"apellido"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Apellido<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"edad"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-int">int</span></span> Edad<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<div class="flotante_der">
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
  <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Carlos"</span><span class="token punctuation">,</span>
  <span class="token property">"apellido"</span><span class="token operator">:</span> <span class="token string">"García"</span><span class="token punctuation">,</span>
  <span class="token property">"edad"</span><span class="token operator">:</span> <span class="token number">18</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>
<p>Si quisiéramos serializar los datos de varios estudiantes en un documento JSON con un único objeto raíz, podríamos hacerlo a través de un <strong><code>record</code></strong> que contenga una colección de estudiantes como puede ser una clase completa con un nombre de clase, un tutor y una colección de estudiantes.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-record">record</span> <span class="token class-name">Clase</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"nombre"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Nombre<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"tutor"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Tutor<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"alumnos"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>Estudiante<span class="token punctuation">&gt;</span></span> Estudiantes<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-override">override</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> <span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Nombre</span><span class="token punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">Tutor</span><span class="token punctuation">}</span></span><span class="token string">)\n\n"</span></span> <span class="token operator">+</span>
        <span class="token keyword keyword-string">string</span><span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> Estudiantes<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> <span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">a</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Para aplicar algunos de los conceptos que hemos visto en otros temas, como son el principio OCP (SOLID) y los métodos de extensión. Vamos a definir los métodos de serialización y deserialización en una clase estática que llamaremos <strong><code>ClaseJson</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">ClaseJson</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name">Clase<span class="token punctuation">?</span></span> <span class="token function">Recupera</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> path<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-using">using</span> <span class="token class-name">FileStream</span> s <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Open<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Read<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Deserializamos el objeto JSON en el documento a un objeto de la clase o tipo Clase</span>
        <span class="token keyword keyword-return">return</span> JsonSerializer<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Deserialize</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Clase<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Método de extensión que serializa un objeto de la clase Clase a un documento JSON</span>
    <span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Guarda</span><span class="token punctuation">(</span><span class="token keyword keyword-this">this</span> <span class="token class-name">Clase</span> clase<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-string">string</span></span> path<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-using">using</span> <span class="token class-name">FileStream</span> s <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> FileMode<span class="token punctuation">.</span>Create<span class="token punctuation">,</span> FileAccess<span class="token punctuation">.</span>Write<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JsonSerializerOptions</span> options <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Indentará la cadena con el JSON para hacerla más legible</span>
            WriteIndented <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token comment">// No permitirá comas al final de los arrays</span>
            AllowTrailingCommas <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token comment">// Codificará los caracteres Unicode básicos y los de la página de códigos ISO-8859-1 (Latin-1).</span>
            <span class="token comment">// lo normal es hacer Encoder = JavaScriptEncoder.Create(UnicodeRanges.All),</span>
            Encoder <span class="token operator">=</span> JavaScriptEncoder<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>
                UnicodeRanges<span class="token punctuation">.</span>BasicLatin<span class="token punctuation">,</span>
                UnicodeRanges<span class="token punctuation">.</span>Latin1Supplement<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// Ignorará una propiedad si su valor es null </span>
            DefaultIgnoreCondition <span class="token operator">=</span> JsonIgnoreCondition<span class="token punctuation">.</span>WhenWritingNull
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        JsonSerializer<span class="token punctuation">.</span><span class="token function">Serialize</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> clase<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Ahora ya podríamos serializar y deserializar objetos de la clase <strong><code>Clase</code></strong> a JSON de la siguiente manera:</p>
<div class="flotante" ,="" style="align-items: center;">
<div class="flotante_izq">
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Clase</span> clase <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>
            <span class="token named-parameter punctuation">Nombre</span><span class="token punctuation">:</span> <span class="token string">"1º DAM"</span><span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">Tutor</span><span class="token punctuation">:</span> <span class="token string">"Juan"</span><span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">Estudiantes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
                <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token string">"Pepa"</span><span class="token punctuation">,</span> <span class="token string">"Pérez"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token string">"María"</span><span class="token punctuation">,</span> <span class="token string">"Peláez"</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token string">"Rosa"</span><span class="token punctuation">,</span> <span class="token string">"López"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        clase<span class="token punctuation">.</span><span class="token function">Guarda</span><span class="token punctuation">(</span><span class="token string">"1DAM.json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Clase<span class="token punctuation">?</span></span> c <span class="token operator">=</span> ClaseJson<span class="token punctuation">.</span><span class="token function">Recupera</span><span class="token punctuation">(</span><span class="token string">"1DAM.json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>
            c<span class="token punctuation">?.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
            <span class="token operator">??</span> <span class="token string">"No se ha podido recuperar la clase"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<div class="flotante_der">
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
    <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"1º DAM"</span><span class="token punctuation">,</span>
    <span class="token property">"tutor"</span><span class="token operator">:</span> <span class="token string">"Juan"</span><span class="token punctuation">,</span>
    <span class="token property">"alumnos"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Pepa"</span><span class="token punctuation">,</span>
            <span class="token property">"apellido"</span><span class="token operator">:</span> <span class="token string">"Pérez"</span><span class="token punctuation">,</span>
            <span class="token property">"edad"</span><span class="token operator">:</span> <span class="token number">25</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"María"</span><span class="token punctuation">,</span>
            <span class="token property">"apellido"</span><span class="token operator">:</span> <span class="token string">"Peláez"</span><span class="token punctuation">,</span>
            <span class="token property">"edad"</span><span class="token operator">:</span> <span class="token number">22</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Rosa"</span><span class="token punctuation">,</span>
            <span class="token property">"apellido"</span><span class="token operator">:</span> <span class="token string">"López"</span><span class="token punctuation">,</span>
            <span class="token property">"edad"</span><span class="token operator">:</span> <span class="token number">26</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>
<p>Podremos comprobar que al recuperar el objeto de la clase <strong><code>Clase</code></strong> de un documento JSON, se ha recuperado correctamente.</p>
<div style="page-break-after:always;"></div>
<h5 id="propiedades-opcionales">Propiedades Opcionales </h5>
<p>Pude darse el caso de que queramos que una propiedad de un objeto sea opcional. Para ello, fíjate que en las opciones de serialización hemos añadido la propiedad <strong><code>DefaultIgnoreCondition</code></strong> con el valor <strong><code>JsonIgnoreCondition.WhenWritingNull</code></strong>. Esto hará que si una propiedad de un objeto es <strong><code>null</code></strong>, no se serialice en el documento JSON. Además, al deserializar el objeto, si esta propiedad no existe en el documento JSON, se inicializará a <strong><code>null</code></strong>.</p>
<p>Por ejemplo, supongamos que modificamos el record <strong><code>Estudiante</code></strong> para que tenga una propiedad que será un objeto de tipo <strong><code>Direccion</code></strong> que <strong>sera opcional y por tanto anulable con valor por defecto a null</strong>.</p>
<div class="flotante" ,="" style="align-items: center;">
<div class="flotante_izq">
<pre data-role="codeBlock" data-info="csharp {highlight=9}" class="language-csharp csharp" data-line="9"><code><span class="token keyword keyword-record">record</span> <span class="token class-name">Estudiante</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"nombre"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Nombre<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"apellido"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Apellido<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"edad"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-int">int</span></span> Edad<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"direccion"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name">Direccion<span class="token punctuation">?</span></span> Direccion <span class="token operator">=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div class="line-highlight-wrapper">







<div aria-hidden="true" class="line-highlight" data-range="9" data-start="9">
</div></div></pre></div>
<div class="flotante_der">
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-record">record</span> <span class="token class-name">Direccion</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"calle"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Calle<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"numero"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-int">int</span></span> Numero<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"ciudad"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Ciudad<span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"pais"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> Pais<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
</div>
<p>Básicamente ya podríamos serializar y deserializar objetos de la clase <strong><code>Estudiante</code></strong> igual que antes. Teniendo en cuenta eso sí que la propiedad <strong><code>Direccion</code></strong> es opcional y por tanto podría ser <strong><code>null</code></strong> al leerse del documento JSON.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name">Clase</span> clase <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>
    <span class="token named-parameter punctuation">Nombre</span><span class="token punctuation">:</span> <span class="token string">"1º DAM"</span><span class="token punctuation">,</span>
    <span class="token named-parameter punctuation">Tutor</span><span class="token punctuation">:</span> <span class="token string">"Juan"</span><span class="token punctuation">,</span>
    <span class="token named-parameter punctuation">Estudiantes</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token string">"Rosa"</span><span class="token punctuation">,</span> <span class="token string">"López"</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token string">"Juan"</span><span class="token punctuation">,</span> <span class="token string">"Gómez"</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token string">"Calle Falsa"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token string">"Elche"</span><span class="token punctuation">,</span> <span class="token string">"España"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="flotante" ,="" style="align-items: top;">
<div class="flotante_izq">
<p>Se añadirán un objeto JSON anidado para la propiedad <strong><code>direccion</code></strong> en aquellos estudiantes que la tengan distinta de <strong><code>null</code></strong> y a la hora de deserializar el objeto, si la propiedad <strong><code>direccion</code></strong> no existe en el documento JSON, se inicializará a <strong><code>null</code></strong> y es por eso que sea anulable.</p>
<p>Por ejemplo si la edad fuera opcional, como es un campo numérico tendremos dos opciones, o bien lo inicializamos a <strong><code>null</code></strong> y el campo pasaría a ser de tipo <strong><code>int?</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">property</span><span class="token punctuation">:</span> <span class="token class-name">JsonPropertyName</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">"edad"</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token class-name"><span class="token keyword keyword-int">int</span><span class="token punctuation">?</span></span> Edad <span class="token operator">=</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">,</span>
</code></pre></div>
<div class="flotante_der">
<pre data-role="codeBlock" data-info="json" class="language-json json"><code><span class="token punctuation">{</span>
    <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"1º DAM"</span><span class="token punctuation">,</span>
    <span class="token property">"tutor"</span><span class="token operator">:</span> <span class="token string">"Juan"</span><span class="token punctuation">,</span>
    <span class="token property">"alumnos"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Rosa"</span><span class="token punctuation">,</span>
            <span class="token property">"apellido"</span><span class="token operator">:</span> <span class="token string">"López"</span><span class="token punctuation">,</span>
            <span class="token property">"edad"</span><span class="token operator">:</span> <span class="token number">26</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"nombre"</span><span class="token operator">:</span> <span class="token string">"Juan"</span><span class="token punctuation">,</span>
            <span class="token property">"apellido"</span><span class="token operator">:</span> <span class="token string">"Gómez"</span><span class="token punctuation">,</span>
            <span class="token property">"edad"</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
            <span class="token property">"direccion"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">"calle"</span><span class="token operator">:</span> <span class="token string">"Calle Falsa"</span><span class="token punctuation">,</span>
                <span class="token property">"numero"</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
                <span class="token property">"ciudad"</span><span class="token operator">:</span> <span class="token string">"Elche"</span><span class="token punctuation">,</span>
                <span class="token property">"pais"</span><span class="token operator">:</span> <span class="token string">"España"</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div>
</div>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>