<!DOCTYPE html><html><head>
      <title>Programación 1º DAM Tema 13</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}@font-face{font-family:"Material Icons";font-style:normal;font-weight:400;src:local("Material Icons"),local("MaterialIcons-Regular"),url("data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAAfIAAsAAAAADDAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADMAAABCsP6z7U9TLzIAAAE8AAAARAAAAFZW7kosY21hcAAAAYAAAADTAAACjtP6ytBnbHlmAAACVAAAAxgAAAQ4zRtvlGhlYWQAAAVsAAAALwAAADYRwZsnaGhlYQAABZwAAAAcAAAAJAeKAzxobXR4AAAFuAAAABIAAAA8OGQAAGxvY2EAAAXMAAAAIAAAACAG5AfwbWF4cAAABewAAAAfAAAAIAEfAERuYW1lAAAGDAAAAVcAAAKFkAhoC3Bvc3QAAAdkAAAAYgAAAK2vz7wkeJxjYGRgYOBikGPQYWB0cfMJYeBgYGGAAJAMY05meiJQDMoDyrGAaQ4gZoOIAgCKIwNPAHicY2BkPsQ4gYGVgYOpk+kMAwNDP4RmfM1gxMjBwMDEwMrMgBUEpLmmMDgwVLy4xKzzX4chhrmK4QpQmBEkBwAZygyweJzFkr0NwjAQhZ+TEP6CRUfHBEwRUWaQTICyQbpMwRCskA5RUIONxG0RnnNpKAIV4qzPku/8c353ACYAYrIjCWCuMAh2ptf0/hiL3p/gyPUWa3osqlt0L1zu9r71z8dGrJRykFoauXQd932Lj5vhG+MjxGeYI8MKETObMpslf5EyP8tg+vHun5r539PvlvXzaVhRFVQDTPEWKVQR90KhnnC5Ek67vUKN4VuFasM/ldARj43CCkCsEjpJSoVVgRyU0GVSK6wUpFFCx8lFgX0BiXpRPQB4nE2TTWjcRhTH3xttpDhxN7uxPlp3u/FK7moRPixafRijNosxSw/LUsIwNcaEHPZggo/FmEKMCKWU4kNOOftQSlhE8alnH0Ix9BqWnHooPRrTQ0+mnu2bXTu2pPdGM9LM/6c3fwECTM4gBBMYQNqxzLrZAjqYSlqu2TAHZQA0/DQJH6FtzqGDnvbt4Ggwvzw/nL8EfH8kW0fsuRqhgWXZnY7M1picaUL7Du5BHeDzMIl83dAt016wH1qmvtSMo5R6YRJHTR//FXsff/nj/tc/5K9P5d+nP22+fFK5u7v3K39SW3y+OtDKO3L85vD09PD9z5X17a2N1g4tqk01RlqX7gyoEmnsWQtVr4rtZMmukEaFBZxzefkCn11cyKMLZgshRwgTYNoLNXCBz2ja7HvZG7hDpPSNfoo5vs0knK/9hb+rNpu+8kHPgk/Ao4kK3tWtTpSEtvkA9c+wE6UaUdwieNkaHg55tBEtRiEPw1s0+FtrtTcc9two2lhMknV7PZF/cs6+uUFTmpTGbEx7sQCPSLOttHS3GRltqp7SNzVSKzl6aWnZT/CX5k6/v9N3Hh8fHBwffJVjhrC6OgH5dkIt/tPsq+d/PD5Qz7G7efzq1THFjdZVPe/N6ulQ3JnDWSE5junsFsVIiFwL/htf1S5gJ3BfOcUxfHKLnzqpFpyfZ9cX+/5WB6a+Y0pHpzkNrYNVDwMsikK+y7WuLCRg/oFHkA8VT3rDg5ZnU6ktzzINymV0m74Xd5pfIGXyFeVEQSShkzqG7TBBa2OxVRKitLXv7h3uuftXnXq7lz2tZ/WnWa9dx9dCjDhHzmuVQATlmljr9dZErUydSo2Hbi/b1vXtrOeGCk2/8s3ZlO8+ueJT8BVlw5pGw2oYccdSiHHqx0RlabHqdNR9jAETl6PreJcPBnnfpTLnOQ8C3OV8AmQGzouV1iZdeb5SSIoVc8W8/kcDtksUH5FrU6/aqBqNWcMEzxG4DAQ14qRQhi9mWU0rzepKezbjfgCwQKxVYq5ajRgpRqy45CqwkJydcEkbTkvRz8P5/2ZpDTN4nGNgZGBgAOKb6v+/xvPbfGXgZmEAgeuB2kkI+v8bFgbmKiCXg4EJJAoAPyAKhQB4nGNgZGBg1vmvwxDDwgACQJKRARXwAwAzZQHQeJxjYQCCFAYGFgbSMQAcWACdAAAAAAAAAAwALgBgAIQAmADSAQgBIgE8AVABoAHeAfwCHHicY2BkYGDgZ7BgYGMAASYg5gJCBob/YD4DAA/hAWQAeJxlkbtuwkAURMc88gApQomUJoq0TdIQzEOpUDokKCNR0BuzBiO/tF6QSJcPyHflE9Klyyekz2CuG8cr7547M3d9JQO4xjccnJ57vid2cMHqxDWc40G4Tv1JuEF+Fm6ijRfhM+oz4Ra6eBVu4wZvvMFpXLIa40PYQQefwjVc4Uu4Tv1HuEH+FW7i1mkKn6Hj3Am3sHC6wm08Ou8tpSZGe1av1PKggjSxPd8zJtSGTuinyVGa6/Uu8kxZludCmzxMEzV0B6U004k25W35fj2yNlCBSWM1paujKFWZSbfat+7G2mzc7weiu34aczzFNYGBhgfLfcV6iQP3ACkSaj349AxXSN9IT0j16JepOb01doiKbNWt1ovippz6sVYYwsXgX2rGVFIkq7Pl2PNrI6qW6eOshj0xaSq9mpNEZIWs8LZUfOouNkVXxp/d5woqebeYIf4D2J1ywQB4nG3LOw6AIBAE0B384B+PAkgEa+QwNnYmHt+EpXSal5lkSBBnoP8oCFSo0aCFRIceA0ZMmLFAYSW88rmvtMUjG3RiQ9HvpfusM6zWNmtc5H/iPewha50tOt5PS/QBx2IeSwAA") format("woff")}.admonition{box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12),0 3px 1px -2px rgba(0,0,0,.2);position:relative;margin:1.5625em 0;padding:0 1.2rem;border-left:.4rem solid rgba(68,138,255,.8);border-radius:.2rem;background-color:rgba(255,255,255,.05);overflow:auto}.admonition>p{margin-top:.8rem}.admonition>.admonition-title{margin:0 -1.2rem;padding:.8rem 1.2rem .8rem 3.6rem;border-bottom:1px solid rgba(68,138,255,.2);background-color:rgba(68,138,255,.1);font-weight:700}.admonition>.admonition-title:before{position:absolute;left:1.2rem;font-size:1.5rem;color:rgba(68,138,255,.8);content:"\E3C9"}.admonition>.admonition-title:before{font-family:Material Icons;font-style:normal;font-variant:normal;font-weight:400;line-height:2rem;text-transform:none;white-space:nowrap;speak:none;word-wrap:normal;direction:ltr}.admonition.abstract,.admonition.summary,.admonition.tldr{border-left-color:rgba(0,176,255,.8)}.admonition.abstract>.admonition-title,.admonition.summary>.admonition-title,.admonition.tldr>.admonition-title{background-color:rgba(0,176,255,.1);border-bottom-color:rgba(0,176,255,.2)}.admonition.abstract>.admonition-title:before,.admonition.summary>.admonition-title:before,.admonition.tldr>.admonition-title:before{color:#00b0ff;content:"\E8D2"}.admonition.hint,.admonition.tip{border-left-color:rgba(0,191,165,.8)}.admonition.hint>.admonition-title,.admonition.tip>.admonition-title{background-color:rgba(0,191,165,.1);border-bottom-color:rgba(0,191,165,.2)}.admonition.hint>.admonition-title:before,.admonition.tip>.admonition-title:before{color:#00bfa5;content:"\E80E"}.admonition.info,.admonition.todo{border-left-color:rgba(0,184,212,.8)}.admonition.info>.admonition-title,.admonition.todo>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.info>.admonition-title:before,.admonition.todo>.admonition-title:before{color:#00b8d4;content:"\E88E"}.admonition.check,.admonition.done,.admonition.success{border-left-color:rgba(0,200,83,.8)}.admonition.check>.admonition-title,.admonition.done>.admonition-title,.admonition.success>.admonition-title{background-color:rgba(0,200,83,.1);border-bottom-color:rgba(0,200,83,.2)}.admonition.check>.admonition-title:before,.admonition.done>.admonition-title:before,.admonition.success>.admonition-title:before{color:#00c853;content:"\E876"}.admonition.faq,.admonition.help,.admonition.question{border-left-color:rgba(100,221,23,.8)}.admonition.faq>.admonition-title,.admonition.help>.admonition-title,.admonition.question>.admonition-title{background-color:rgba(100,221,23,.1);border-bottom-color:rgba(100,221,23,.2)}.admonition.faq>.admonition-title:before,.admonition.help>.admonition-title:before,.admonition.question>.admonition-title:before{color:#64dd17;content:"\E887"}.admonition.attention,.admonition.caution,.admonition.warning{border-left-color:rgba(255,145,0,.8)}.admonition.attention>.admonition-title,.admonition.caution>.admonition-title,.admonition.warning>.admonition-title{background-color:rgba(255,145,0,.1);border-bottom-color:rgba(255,145,0,.2)}.admonition.attention>.admonition-title:before{color:#ff9100;content:"\E417"}.admonition.caution>.admonition-title:before,.admonition.warning>.admonition-title:before{color:#ff9100;content:"\E002"}.admonition.fail,.admonition.failure,.admonition.missing{border-left-color:rgba(255,82,82,.8)}.admonition.fail>.admonition-title,.admonition.failure>.admonition-title,.admonition.missing>.admonition-title{background-color:rgba(255,82,82,.1);border-bottom-color:rgba(255,82,82,.2)}.admonition.fail>.admonition-title:before,.admonition.failure>.admonition-title:before,.admonition.missing>.admonition-title:before{color:#ff5252;content:"\E14C"}.admonition.bug,.admonition.danger,.admonition.error{border-left-color:rgba(255,23,68,.8)}.admonition.bug>.admonition-title,.admonition.danger>.admonition-title,.admonition.error>.admonition-title{background-color:rgba(255,23,68,.1);border-bottom-color:rgba(255,23,68,.2)}.admonition.danger>.admonition-title:before{color:#ff1744;content:"\E3E7"}.admonition.error>.admonition-title:before{color:#ff1744;content:"\E14C"}.admonition.bug>.admonition-title:before{color:#ff1744;content:"\E868"}.admonition.example,.admonition.snippet{border-left-color:rgba(0,184,212,.8)}.admonition.example>.admonition-title,.admonition.snippet>.admonition-title{background-color:rgba(0,184,212,.1);border-bottom-color:rgba(0,184,212,.2)}.admonition.example>.admonition-title:before,.admonition.snippet>.admonition-title:before{color:#00b8d4;content:"\E242"}.admonition.cite,.admonition.quote{border-left-color:rgba(158,158,158,.8)}.admonition.cite>.admonition-title,.admonition.quote>.admonition-title{background-color:rgba(158,158,158,.1);border-bottom-color:rgba(158,158,158,.2)}.admonition.cite>.admonition-title:before,.admonition.quote>.admonition-title:before{color:#9e9e9e;content:"\E244"}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
@font-face {
  font-family: 'Catamaran';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/catamaran/v19/o-0bIpQoyXQa2RxT7-5B6Ryxs2E_6n1iPHjd5a7dvg.ttf) format('truetype');
}
.markdown-preview.markdown-preview .caso_estudio {
  background-color: #f5f5f5;
  border: 2px solid #969696;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .resumen {
  background-color: #d6d6d6;
  border: 2px solid #b0b0b0;
  padding: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .ejercicio {
  background-color: #f5faf5;
  border: 2px solid #969b96;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}
.markdown-preview.markdown-preview .contenedor {
  display: flex;
  justify-content: center;
  margin: 30px auto 30px auto;
}
.markdown-preview.markdown-preview .fondo {
  background: url(https://programacioniesbalmis.github.io/Imagenes/BannersMoodle/banner.png);
  background-size: cover;
  width: 75%;
  height: 160px;
  border-radius: 10px;
  position: relative;
}
.markdown-preview.markdown-preview .cita {
  font-family: Arial;
  font-style: italic;
  font-weight: 600;
  text-align: justify;
  line-height: 1.5rem;
  opacity: 0.6;
  color: white;
  padding: 5rem;
  position: relative;
  top: 50%;
  left: 50%;
  font-size: 1.3rem;
  transform: translate(-50%, -50%);
}
.markdown-preview.markdown-preview .abre_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-left: 30px;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, -15%);
}
.markdown-preview.markdown-preview .cierra_comilla {
  font-family: "Catamaran";
  font-weight: 600;
  color: white;
  padding-right: 30px;
  right: 0%;
  position: absolute;
  font-size: 6rem;
  transform: translate(0%, 55%);
}
.markdown-preview.markdown-preview .autor {
  font-family: Arial;
  color: white;
  margin: 0px;
  padding-left: 30px;
  position: absolute;
  top: 83%;
  font-size: 1rem;
}
.markdown-preview.markdown-preview .flotante {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
  margin-bottom: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: column;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante {
    flex-direction: row;
  }
}
.markdown-preview.markdown-preview .flotante_izq {
  margin-right: 15px;
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_izq {
    width: auto;
  }
}
@media (max-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: 100%;
  }
}
@media (min-width: 550px) {
  .markdown-preview.markdown-preview .flotante_der {
    width: auto;
  }
}
.markdown-preview.markdown-preview .cabeceras_examen {
  background-color: #fcfcfc;
  border: 2px solid #b7bbb7;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
  color: black;
  font-size: 8pt;
}
.markdown-preview.markdown-preview .ejercicio_control {
  background-color: #f9faf9;
  border: 2px solid #b4b7b4;
  padding-left: 15px;
  padding-right: 15px;
  margin-top: 15px;
  margin-bottom: 15px;
  border-radius: 5px;
  box-shadow: 0 0 7px 0 rgba(78, 120, 158, 0.1);
}

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="tema-13">Tema 13 </h1>
<p>Descargar estos apuntes en <a href="./Tema13.pdf">pdf</a> o <a href="./Tema13.html">html</a></p>
<h2 id="índice">Índice </h2>

<div class="md-toc">
<div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#bases-de-datos-relacionales" class="md-toc-link">
            <p>Bases de Datos Relacionales</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#el-desfase-objeto-relacional" class="md-toc-link">
            <p>El Desfase Objeto-Relacional</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#manejo-de-la-integridad-código-vs-base-de-datos" class="md-toc-link">
            <p>Manejo de la Integridad: Código vs. Base de Datos</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#autonuméricos-vs-uuid" class="md-toc-link">
            <p>Autonuméricos vs. UUID</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:18px">
          <a href="#base-de-datos-relacional-sqlite" class="md-toc-link">
            <p>Base de datos Relacional SQLite</p>

          </a></div><details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#acceso-a-bases-de-datos-sqlite-en-c" class="md-toc-link"><p>Acceso a Bases de Datos SQLite en C#</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#instalación" class="md-toc-link">
            <p>Instalación</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#conexión" class="md-toc-link">
            <p>Conexión</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#action-queries-utilizando-el-ddl-de-sqlite" class="md-toc-link">
            <p>Action Queries utilizando el DDL de SQLite</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#action-queries-utilizando-el-dml-de-sqlite" class="md-toc-link">
            <p>Action Queries utilizando el DML de SQLite</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#consultas-utilizando-el-dql-de-sqlite" class="md-toc-link">
            <p>Consultas utilizando el DQL de SQLite</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#transacciones" class="md-toc-link">
            <p>Transacciones</p>

          </a></div>
        </div>
      </details>
    <details style="padding:0;;padding-left:0px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#patrones-básicos-de-diseño" class="md-toc-link"><p>Patrones Básicos de Diseño</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#modelando-los-datos-en-entidades" class="md-toc-link">
            <p>Modelando los datos en entidades</p>

          </a></div><details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#definiendo-un-dao" class="md-toc-link"><p>Definiendo un DAO</p>
</a>
          </summary>
        <div>
          <details style="padding:0;;padding-left:24px;" open="">
        <summary class="md-toc-link-wrapper">
          <a href="#implementando-las-operaciones-crud" class="md-toc-link"><p>Implementando las operaciones CRUD</p>
</a>
          </summary>
        <div>
          <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#create-o-insert" class="md-toc-link">
            <p>Create o Insert</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#read" class="md-toc-link">
            <p>Read</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#read-de-proyecciones-y-agregaciones-usando-dto" class="md-toc-link">
            <p>Read de proyecciones y agregaciones usando DTO</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#update" class="md-toc-link">
            <p>Update</p>

          </a></div><div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#delete" class="md-toc-link">
            <p>Delete</p>

          </a></div>
        </div>
      </details>
    
        </div>
      </details>
    <div class="md-toc-link-wrapper" style="padding:0;;display:list-item;list-style:square;margin-left:42px">
          <a href="#uso-de-los-daos" class="md-toc-link">
            <p>Uso de los DAOs</p>

          </a></div>
        </div>
      </details>
    
</div>
<div style="page-break-after:always;"></div>
<h2 id="bases-de-datos-relacionales">Bases de Datos Relacionales </h2>
<p>Las bases de datos relacionales organizan la información basándose en el modelo relacional. Este enfoque estructura los datos en tablas interconectadas, donde las relaciones se definen mediante el uso de claves primarias y claves foráneas.</p>
<ul>
<li><strong>Clave Primaria:</strong> Un atributo que distingue de manera única cada entrada dentro de una tabla.</li>
<li><strong>Clave Foránea:</strong> Un atributo en una tabla que hace referencia a la clave primaria de otra tabla, estableciendo un vínculo entre ellas.</li>
</ul>
<p>Cada tabla debe tener una clave primaria, asegurando la unicidad de sus registros. Adicionalmente, una tabla puede contener una o varias claves foráneas, que sirven para relacionarla con otras tablas.</p>
<p>Los datos dentro de cada columna de una tabla se almacenan siguiendo un formato específico, que puede ser numérico, textual, de fecha, entre otros. Cada columna también tiene un nombre que la identifica. La naturaleza de los datos almacenados en una columna puede estar sujeta a ciertas restricciones, como la obligatoriedad de no ser nula o la exigencia de unicidad. Los tipos de datos disponibles varían según el Sistema de Gestión de Bases de Datos (SGBD) empleado.</p>
<p>En esencia, una tabla se puede entender como un conjunto de registros, donde cada registro está compuesto por una serie de campos.</p>
<p>La manipulación de estas bases de datos se realiza mediante el Lenguaje de Consulta Estructurado (SQL), que facilita la creación, modificación y consulta de las tablas.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> tablaN <span class="token punctuation">(</span>  
    campo1 tipo1<span class="token punctuation">,</span>  
    campo2 tipo2<span class="token punctuation">,</span>  
    campo3 tipo3<span class="token punctuation">,</span>  
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>  
    campoI tipoI <span class="token keyword keyword-REFERENCES">REFERENCES</span> tablaM<span class="token punctuation">(</span>campoJ<span class="token punctuation">)</span><span class="token punctuation">,</span>  
    <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span> <span class="token punctuation">(</span>campo1<span class="token punctuation">)</span>  
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div style="page-break-after:always;"></div>
<h2 id="el-desfase-objeto-relacional">El Desfase Objeto-Relacional </h2>
<p>Al desarrollar aplicaciones que interactúan con bases de datos, surge una divergencia: el modelo relacional difiere del modelo orientado a objetos. El modelo relacional se centra en tablas, mientras que el modelo orientado a objetos se basa en la noción de objetos. Esta diferencia impide la utilización directa de las tablas de una base de datos relacional en un programa orientado a objetos. Además, pueden surgir incompatibilidades en los tipos de datos. En resumen, existe una falta de compatibilidad directa entre ambos modelos, lo que requiere un esfuerzo adicional para integrarlos.</p>
<p>Esto implica la necesidad de gestionar relaciones y realizar la conversión de objetos a tablas (o entidades) y viceversa cada vez que se requiera la transición entre ambos modelos: de un objeto a una fila en una tabla, y de una fila de una tabla a un objeto.</p>
<p>Para mitigar este problema, se pueden emplear <strong>mapeadores objeto-relacionales</strong> (<strong>ORM</strong>), que permiten trabajar con objetos en lugar de tablas y filas. Estos mapeadores se encargan de traducir las consultas realizadas a la base de datos en sentencias SQL, y viceversa.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> persona <span class="token punctuation">(</span>  
    id <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span> AUTOINCREMENT<span class="token punctuation">,</span>  
    nombre <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    apellidos <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    edad <span class="token keyword keyword-INTEGER">INTEGER</span>  
<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Persona</span> <span class="token punctuation">{</span>  
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-int">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> Nombre <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> Apellidos <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-int">int</span></span> Edad <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>  
</code></pre><div style="page-break-after:always;"></div>
<h2 id="manejo-de-la-integridad-código-vs-base-de-datos">Manejo de la Integridad: Código vs. Base de Datos </h2>
<p>La discrepancia entre el modelo relacional y el modelo orientado a objetos puede generar complicaciones en la gestión de la integridad de los datos. Este aspecto debe analizarse cuidadosamente, especialmente si la base de datos es compartida y las reglas de negocio de una aplicación específica no coinciden con las de otras aplicaciones que también utilizan la misma base de datos.</p>
<p>Por ejemplo, consideremos una tabla de personas y otra de direcciones (en una base de datos compartida). Si se elimina una persona, pero no se eliminan sus direcciones, se puede producir una inconsistencia en los datos (esto puede ser aceptable en ciertos escenarios, pero no en otros). Este problema se puede abordar de dos maneras:</p>
<ul>
<li><strong>Delegar la integridad a la base de datos:</strong> En este enfoque, la base de datos se encarga de eliminar las direcciones asociadas a una persona eliminada. Para lograr esto, la tabla de direcciones incluirá una clave foránea que haga referencia a la tabla de personas, y se utilizarán mecanismos de propagación en cascada. De esta forma, la eliminación de una persona desencadenará automáticamente la eliminación de sus direcciones en la base de datos.</li>
<li><strong>Gestionar la integridad mediante código:</strong> En este caso, la aplicación es responsable de eliminar las direcciones de una persona que se elimina. Esto implica que la aplicación debe consultar las direcciones de la persona en cuestión y eliminarlas individualmente. Este método ofrece mayor flexibilidad, permitiendo definir casos específicos en los que se elimina una persona pero no sus direcciones, algo que no es posible con el enfoque anterior.</li>
</ul>
<p>La elección entre estos enfoques depende del contexto específico de la aplicación, su ciclo de vida, el ciclo de vida de la base de datos, las aplicaciones que la utilicen y las reglas de negocio de cada una de ellas.</p>
<div class="contenedor">
    <div class="fondo">
        <div class="abre_comilla">"</div>
        <div class="cierra_comilla">"</div>
        <div class="cita">In order to have a decentralised database, you need to have security. In order to have security, you need to - you need to have incentives.</div>
        <div class="autor">- Vitalik Buterin (Ethereum creator)</div>
    </div>
</div>
<div style="page-break-after:always;"></div>
<h2 id="autonuméricos-vs-uuid">Autonuméricos vs. UUID </h2>
<p>Otro desafío al programar con bases de datos es la gestión de los identificadores de los registros. En el modelo relacional, estos identificadores, conocidos como claves primarias, se almacenan en una columna de la tabla y deben ser únicos.</p>
<p><strong>Nuevamente, existen dos enfoques principales</strong>: que la base de datos genere los identificadores, o que la aplicación se encargue de esta tarea. Ambas opciones presentan ventajas y desventajas.</p>
<ol>
<li>
<p>Si la base de datos genera los identificadores, se debe utilizar un tipo de dato que garantice valores únicos y no repetidos. Una opción común son los <strong>valores autoincrementales</strong>, que son enteros sin signo que se incrementan automáticamente con cada nuevo registro. Sin embargo, esto implica que el identificador de un nuevo registro no se conoce hasta que el registro se inserta en la base de datos. Esto puede ser problemático si se necesita el identificador para insertar registros relacionados, ya que sería necesario consultarlo después de la inserción inicial.</p>
</li>
<li>
<p>Si la aplicación genera los identificadores, también se requiere un tipo de dato que asegure la unicidad. Una alternativa es utilizar <strong>UUID</strong> (<strong>Identificador Único Universal</strong>), que genera identificadores únicos de forma aleatoria. Esto permite generar un identificador único para cada registro antes de insertarlo en la base de datos. Esto es una ventaja, pero también implica que la aplicación debe encargarse de almacenar y gestionar estos identificadores para su uso posterior, por ejemplo, al insertar registros relacionados que requieran el identificador como clave foránea.</p>
<p>En C# se puede generar un UUID de la siguiente manera:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token comment">// "N" es el formato de 32 caracteres sin guiones</span>
<span class="token class-name"><span class="token keyword keyword-string">string</span></span> uuid <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// "D" es el formato de 32 caracteres con guiones</span>
<span class="token class-name"><span class="token keyword keyword-string">string</span></span> uuid <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></li>
</ol>
<h2 id="base-de-datos-relacional-sqlite">Base de datos Relacional SQLite </h2>
<p>SQLite es un sistema de gestión de bases de datos relacional que se caracteriza por ser <strong>ligero</strong>, <strong>rápido</strong> y <strong>autónomo</strong>. No requiere un servidor dedicado, ya que se ejecuta directamente en el sistema operativo. Esto lo convierte en una excelente opción para aplicaciones que necesitan una base de datos local sin la complejidad de un servidor de bases de datos.</p>
<p>SQLite es compatible con la mayoría de los lenguajes de programación y sistemas operativos, lo que lo hace muy versátil. Además, es ampliamente utilizado en aplicaciones móviles, navegadores web y otros entornos donde se requiere una base de datos local.</p>
<h2 id="acceso-a-bases-de-datos-sqlite-en-c">Acceso a Bases de Datos SQLite en C# </h2>
<h3 id="instalación">Instalación </h3>
<p>Para trabajar con SQLite en C#, se puede utilizar la biblioteca <code>System.Data.SQLite</code>, que proporciona una interfaz para interactuar con bases de datos SQLite desde aplicaciones .NET.</p>
<p>Para añadir esta biblioteca a un proyecto de C#, los más sencillo es usar <strong>Nugget</strong>. Para ello, se puede ejecutar el siguiente comando en un terminal <strong>en la raíz del Workspace del proyecto</strong>:</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash bash"><code>dotnet <span class="token function">add</span> package Microsoft.Data.Sqlite
</code></pre><h3 id="conexión">Conexión </h3>
<p>Deberemos crear una única conexión a la base de datos, que se abrirá al principio de la aplicación y se cerrará al final.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name"><span class="token keyword keyword-string">string</span></span> cadenaConexion <span class="token operator">=</span> <span class="token string">"Data Source=nombreBD.db"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteConnection</span> conexion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>cadenaConexion<span class="token punctuation">)</span><span class="token punctuation">;</span>

conexion<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Operaciones con la base de datos</span>
conexion<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Como <strong><code>SqliteConnection</code></strong> implementa el interfaz <strong><code>IDisposable</code></strong>, podemos usar la sentencia <strong><code>using</code></strong> para asegurarnos de que la conexión se cierra correctamente y por tanto ya no hará falta llamar al método <strong><code>conexion.Close()</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-try">try</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> cadenaConexion <span class="token operator">=</span> <span class="token string">"Data Source=nombreBD.db"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteConnection</span> conexion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>cadenaConexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    conexion<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Operaciones con la base de datos</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">SqliteException</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<h3 id="action-queries-utilizando-el-ddl-de-sqlite">Action Queries utilizando el DDL de SQLite </h3>
<p>Las <strong>Data Definition Language (DML)</strong> son sentencias SQL que modifican la estructura de la base de datos, como <strong><code>CREATE</code></strong>, <strong><code>ALTER</code></strong> o <strong><code>DROP</code></strong>.</p>
<p>Por ejemplo, para crear una la tala <strong><code>Persona</code></strong> con los campos <strong><code>Id</code></strong>, <strong><code>Nombre</code></strong>, <strong><code>Apellidos</code></strong> y <strong><code>Edad</code></strong>, se puede utilizar la siguiente sentencia:</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name"><span class="token keyword keyword-string">string</span></span> sql <span class="token operator">=</span> <span class="token string">""</span>"
CREATE TABLE IF NOT <span class="token return-type class-name">EXISTS</span> persona <span class="token punctuation">(</span>
    id INTEGER PRIMARY <span class="token class-name">KEY</span> AUTOINCREMENT<span class="token punctuation">,</span> 
    nombre TEXT <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span> 
    apellidos TEXT <span class="token class-name">NOT</span> NULL<span class="token punctuation">,</span>
    <span class="token class-name">edad</span> INTEGER
<span class="token punctuation">)</span>
<span class="token string">""</span>"<span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Fíjate que estamos utilizando la cláusula <strong><code>using</code></strong></p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Cómo vemos en el ejemplo anterior, estamos incluyendo lenguaje SQL cómo cadena dentro de otro lenguaje como C#. Esto tiene varias desventajas:</p>
<ol>
<li>Los errores de sintaxis en el SQL no se detectan hasta que se ejecute el método <strong><code>ExecuteNonQuery()</code></strong>.</li>
<li>La cadena SQL no tiene resaltado de sintaxis ni autocompletado.</li>
<li>Si interpolamos cadenas dentro de la sentencia SQL, podemos ser vulnerables a ataques de <strong>SQL Injection</strong>.</li>
</ol>
<p>Todas estas desventajas se pueden evitar utilizando <strong>Query Builders</strong> o <strong>ORMs</strong>.</p>
</div>
<div style="page-break-after:always;"></div>
<h3 id="action-queries-utilizando-el-dml-de-sqlite">Action Queries utilizando el DML de SQLite </h3>
<p>Las <strong>Data Manipulation Language (DML)</strong> son sentencias SQL que modifican los datos de la base de datos, como <strong><code>INSERT</code></strong>, <strong><code>UPDATE</code></strong> o <strong><code>DELETE</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name"><span class="token keyword keyword-string">string</span></span> sql <span class="token operator">=</span> <span class="token string">""</span>"
INSERT <span class="token return-type class-name">INTO</span> persona <span class="token return-type class-name"><span class="token punctuation">(</span>nombre<span class="token punctuation">,</span> apellidos<span class="token punctuation">,</span> edad<span class="token punctuation">)</span></span> VALUES <span class="token punctuation">(</span>'Juan'<span class="token punctuation">,</span> 'García'<span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span>"<span class="token punctuation">;</span>
<span class="token string">""</span>"<span class="token punctuation">;</span>

<span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Si nos fijamos la forma de ejecutarlas es idéntica a las <strong>DDL</strong>.</p>
<p>También podremos <strong>parametrizar las consultas</strong> para evitar <strong>SQL Injection</strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name"><span class="token keyword keyword-string">string</span></span> sql <span class="token operator">=</span> <span class="token string">""</span>"
INSERT <span class="token return-type class-name">INTO</span> persona <span class="token return-type class-name"><span class="token punctuation">(</span>nombre<span class="token punctuation">,</span> apellidos<span class="token punctuation">,</span> edad<span class="token punctuation">)</span></span> VALUES <span class="token punctuation">(</span>@nombre<span class="token punctuation">,</span> @apellidos<span class="token punctuation">,</span> @edad<span class="token punctuation">)</span>"<span class="token punctuation">;</span>
<span class="token string">""</span>"<span class="token punctuation">;</span>

<span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@nombre"</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@apellidos"</span><span class="token punctuation">,</span> <span class="token string">"García"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@edad"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div style="page-break-after:always;"></div>
<h3 id="consultas-utilizando-el-dql-de-sqlite">Consultas utilizando el DQL de SQLite </h3>
<p>Las <strong>Data Query Language (DQL)</strong> son sentencias SQL que recuperan datos de la base de datos, como <strong><code>SELECT</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token class-name"><span class="token keyword keyword-string">string</span></span> sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM persona"</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteDataReader</span> rs <span class="token operator">=</span> comando<span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$""</span></span>"
    Id<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">.</span><span class="token function">GetInt32</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">}</span> 
    Nombre<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    Apellidos<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    Edad<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">.</span><span class="token function">GetInt32</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token string">""</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Como vemos, la forma de ejecutarlas es muy similar a las <em>Action Queries</em> pero debemos utilizar el método <strong><code>ExecuteReader()</code></strong> en lugar de <strong><code>ExecuteNonQuery()</code></strong>. Este nos devolverá un <strong><code>SqliteDataReader</code></strong> que podremos recorrer para obtener cada una de las tuplas de datos devueltas por la consulta.</p>
<p>Además de los <em><strong>getters</strong></em> que devuelven el tipo concreto de cada columna pasando el índice de la misma empezando en 0. También podemos utilizar el nombre de la columna a través de un indizador.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$""</span></span>"
    Id<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
    Nombre<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">[</span><span class="token string">"nombre"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
    Apellidos<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">[</span><span class="token string">"apellidos"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
    Edad<span class="token punctuation">:</span> <span class="token punctuation">{</span>rs<span class="token punctuation">[</span><span class="token string">"edad"</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
    <span class="token string">""</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>En este caso devuelven un <strong><code>object?</code></strong> por lo que deberemos hacer un <em>casting</em> explícito al tipo concreto o usar <strong><code>Convert.ToInt32(rs["id"])</code></strong> para convertirlo.</p>
<p>Es importante también que <strong>tengamos en cuenta si el campo es nullable o no</strong> para tenerlo en cuenta en el casting a realizar.</p>
<h3 id="transacciones">Transacciones </h3>
<p>Las transacciones son un conjunto de operaciones que se ejecutan como una sola unidad. Si una de las operaciones falla, se deshacen todas las operaciones anteriores. Esto garantiza la integridad de los datos y evita inconsistencias.</p>
<p>Esto es especialmente importante a la hora de mantener la integridad referencial en las relaciones entre tablas. Imaginemos que queremos insertar una mascota y su dueño en la tabla <strong><code>persona</code></strong>. Primero insertaremos la persona y después la mascota. Si la inserción de la <strong><code>mascota</code></strong> en la tabla mascota falla, deberemos deshacer la inserción de la persona.</p>
<p>Para el siguiente ejemplo vamos a suponer que el <strong>id</strong> de persona ya no es autonumérico sino que es de tipo cadena y se genera en la aplicación mediante un <strong>UUID</strong>.</p>
<pre data-role="codeBlock" data-info="csharp {highlight=[27,30,34]}" class="language-csharp csharp" data-line="27,30,34"><code><span class="token keyword keyword-try">try</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> id <span class="token operator">=</span> UUId<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">"N"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> sql <span class="token operator">=</span> <span class="token string">""</span>"
    INSERT <span class="token return-type class-name">INTO</span> persona <span class="token return-type class-name"><span class="token punctuation">(</span>id<span class="token punctuation">,</span> nombre<span class="token punctuation">,</span> apellidos<span class="token punctuation">,</span> edad<span class="token punctuation">)</span></span> VALUES <span class="token punctuation">(</span>@id<span class="token punctuation">,</span> @nombre<span class="token punctuation">,</span> @apellidos<span class="token punctuation">,</span> @edad<span class="token punctuation">)</span>"<span class="token punctuation">;</span>
    <span class="token string">""</span>"<span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> insertaPersona <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaPersona<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@id"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaPersona<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@nombre"</span><span class="token punctuation">,</span> <span class="token string">"Juan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaPersona<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@apellidos"</span><span class="token punctuation">,</span> <span class="token string">"García"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaPersona<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@edad"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> sqlMascota <span class="token operator">=</span> <span class="token string">""</span>"
    INSERT <span class="token return-type class-name">INTO</span> mascota <span class="token return-type class-name"><span class="token punctuation">(</span>nombre<span class="token punctuation">,</span> especie<span class="token punctuation">,</span> idPersona<span class="token punctuation">)</span></span> VALUES <span class="token punctuation">(</span>@nombre<span class="token punctuation">,</span> @especie<span class="token punctuation">,</span> @idPersona<span class="token punctuation">)</span>"<span class="token punctuation">;</span>
    <span class="token string">""</span>"<span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> insertaMascota <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>sqlMascota<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaMascota<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@nombre"</span><span class="token punctuation">,</span> <span class="token string">"Rex"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaMascota<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@especie"</span><span class="token punctuation">,</span> <span class="token string">"Perro"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaMascota<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@idPersona"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    conexion<span class="token punctuation">.</span><span class="token function">BeginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaPersona<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    insertaMascota<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    conexion<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">SqliteException</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    conexion<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code><div class="line-highlight-wrapper">

























<div aria-hidden="true" class="line-highlight" data-range="27" data-start="27">
</div></div><div class="line-highlight-wrapper">




























<div aria-hidden="true" class="line-highlight" data-range="30" data-start="30">
</div></div></pre><div style="page-break-after:always;"></div>
<p>Si nos fijamos hacemos los siguiente:</p>
<ol>
<li><strong><code>BeginTransaction()</code></strong></li>
<li>Hago los <strong><code>INSERT</code></strong>, <strong><code>DELETE</code></strong> o <strong><code>UPDATE</code></strong> que se se quedan en una caché.</li>
<li>Si durante la ejecución de las operaciones ocurre alguna excepción, se ejecuta <strong><code>Rollback()</code></strong> para deshacer todas las operaciones desde el <strong><code>BeginTransaction()</code></strong>.</li>
<li><strong><code>Commit()</code></strong> para dar por válidas todas las operaciones en caché.</li>
</ol>
<div class="caso_estudio">
<p>🎓 <strong>Caso de estudio:</strong></p>
<p><strong><a href="assets/codigo/sqlite_una_tabla_ejemplo.cs">Descargar código del caso de estudio</a></strong></p>
<ol>
<li>
<p>Vamos a crear una base de datos con <strong>SQLite</strong> con una sola tabla de <strong>libros</strong> llamada <strong><code>biblioteca_1t.db</code></strong> usando C#.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> cadenaConexion <span class="token operator">=</span> <span class="token string">"Data Source=biblioteca_1t.db"</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteConnection</span> conexion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>cadenaConexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
        conexion<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">SqliteException</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></li>
<li>
<p>A continuación, creamos un método estático <strong><code>CrearTablaLibros</code></strong> que recibe la conexión a la base de datos y crea la tabla <strong><code>libro</code></strong> borrándola si ya existe previamente.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">CrearTablaLibros</span><span class="token punctuation">(</span><span class="token class-name">SqliteConnection</span> conexion<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> borrarTabla <span class="token operator">=</span> <span class="token string">"DROP TABLE IF EXISTS libro"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token punctuation">(</span><span class="token class-name">SqliteCommand</span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>borrarTabla<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> crearTabla <span class="token operator">=</span> <span class="token string">""</span>"
        CREATE <span class="token return-type class-name">TABLE</span> libro <span class="token punctuation">(</span>
            id INTEGER PRIMARY <span class="token class-name">KEY</span> AUTOINCREMENT<span class="token punctuation">,</span> <span class="token return-type class-name">titulo</span> <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token return-type class-name">autor</span> <span class="token function">VARCHAR</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token string">""</span>"<span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token punctuation">(</span><span class="token class-name">SqliteCommand</span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>crearTabla<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>Fíjate que utilizamos la cláusula <strong><code>using</code></strong> para asegurarnos de que los recursos se liberan correctamente y les definimos un ámbito para que poder utilizar el mismo identificador de variable en ambos bloques.</p>
<p>Por último, llamamos al método <strong><code>CrearTablaLibros</code></strong> en el <strong><code>Main</code></strong> después de crear la conexión.</p>
<pre data-role="codeBlock" data-info="csharp {highlight=3}" class="language-csharp csharp" data-line="3"><code><span class="token comment">// ...</span>
conexion<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">CrearTablaLibros</span><span class="token punctuation">(</span>conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
</code><div class="line-highlight-wrapper">

<div aria-hidden="true" class="line-highlight" data-range="3" data-start="3">
</div></div></pre></li>
<li>
<p>Creamos ahora un método para insertar todos los libros.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token keyword keyword-void">void</span> Añ<span class="token function">adeLibros</span><span class="token punctuation">(</span><span class="token class-name">SqliteConnection</span> conexion<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> insertarDatos <span class="token operator">=</span> <span class="token string">""</span>"
        INSERT <span class="token return-type class-name">INTO</span> libro <span class="token return-type class-name"><span class="token punctuation">(</span>titulo<span class="token punctuation">,</span> autor<span class="token punctuation">)</span></span> VALUES
        <span class="token punctuation">(</span>'Macbeth'<span class="token punctuation">,</span> 'William Shakespeare'<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>'<span class="token return-type class-name">La</span> Celestina <span class="token punctuation">(</span>Tragicomedia de Calisto <span class="token class-name">y</span> Melibea<span class="token punctuation">)</span>'<span class="token punctuation">,</span> 'Fernando de Rojas'<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>'El Lazarillo de Tormes'<span class="token punctuation">,</span> 'Anónimo'<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>'<span class="token number">20.000</span> Leguas de Viaje Submarino'<span class="token punctuation">,</span> 'Julio Verne'<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>'Alicia en el País de las Maravillas'<span class="token punctuation">,</span> 'Lewis Carrol'<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>'Cien Años de Soledad'<span class="token punctuation">,</span> 'Gabriel García Márquez'<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>'La tempestad'<span class="token punctuation">,</span> 'William Shakespeare'<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token string">""</span>"<span class="token punctuation">;</span>

    <span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>insertarDatos<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>y lo llamamos después de crear la tabla.</p>
<pre data-role="codeBlock" data-info="csharp {highlight=4}" class="language-csharp csharp" data-line="4"><code><span class="token comment">// ...</span>
conexion<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">CrearTablaLibros</span><span class="token punctuation">(</span>conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
Añ<span class="token function">adeLibros</span><span class="token punctuation">(</span>conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
</code><div class="line-highlight-wrapper">


<div aria-hidden="true" class="line-highlight" data-range="4" data-start="4">
</div></div></pre></li>
<li>
<p>Por último, creamos un método para ver todos los libros realizando una consulta a la BD.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">VerLibros</span><span class="token punctuation">(</span><span class="token class-name">SqliteConnection</span> conexion<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> verLibros <span class="token operator">=</span> <span class="token string">"SELECT * FROM libro"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteCommand</span> query <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>verLibros<span class="token punctuation">,</span> conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name">SqliteDataReader</span> rs <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> separador <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>
        <span class="token interpolation-string"><span class="token string">$"| </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token char">'-'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span></span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token char">'-'</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">55</span></span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token keyword keyword-new">new</span><span class="token punctuation">(</span><span class="token char">'-'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">25</span></span><span class="token punctuation">}</span></span><span class="token string"> |\n"</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">StringBuilder</span> salida <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">StringBuilder</span><span class="token punctuation">(</span>separador<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"| </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token string">"Id"</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span></span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token string">"Título"</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">55</span></span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token string">"Autor"</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">25</span></span><span class="token punctuation">}</span></span><span class="token string"> |\n"</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>separador<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        salida<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>
            <span class="token interpolation-string"><span class="token string">$"| </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">rs<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">3</span></span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">rs<span class="token punctuation">[</span><span class="token string">"titulo"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">55</span></span><span class="token punctuation">}</span></span><span class="token string"> | </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">rs<span class="token punctuation">[</span><span class="token string">"autor"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">25</span></span><span class="token punctuation">}</span></span><span class="token string"> |\n"</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    salida<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>separador<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>salida<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>y lo llamamos después de añadir los libros.</p>
<pre data-role="codeBlock" data-info="csharp {highlight=5}" class="language-csharp csharp" data-line="5"><code><span class="token comment">// ...</span>
conexion<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">CrearTablaLibros</span><span class="token punctuation">(</span>conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
Añ<span class="token function">adeLibros</span><span class="token punctuation">(</span>conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">VerLibros</span><span class="token punctuation">(</span>conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
</code><div class="line-highlight-wrapper">



<div aria-hidden="true" class="line-highlight" data-range="5" data-start="5">
</div></div></pre><p>Nos debería mostrar una tabla similar a la siguiente:</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Título</th>
<th>Autor</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Macbeth</td>
<td>William Shakespeare</td>
</tr>
<tr>
<td>2</td>
<td>La Celestina (Tragicomedia de Calisto y Melibea)</td>
<td>Fernando de Rojas</td>
</tr>
<tr>
<td>3</td>
<td>El Lazarillo de Tormes</td>
<td>Anónimo</td>
</tr>
<tr>
<td>4</td>
<td>20.000 Leguas de Viaje Submarino</td>
<td>Julio Verne</td>
</tr>
<tr>
<td>5</td>
<td>Alicia en el País de las Maravillas</td>
<td>Lewis Carrol</td>
</tr>
<tr>
<td>6</td>
<td>Cien Años de Soledad</td>
<td>Gabriel García Márquez</td>
</tr>
<tr>
<td>7</td>
<td>La tempestad</td>
<td>William Shakespeare</td>
</tr>
</tbody>
</table>
</li>
</ol>
</div> <!-- fin caso de estudio -->
<h2 id="patrones-básicos-de-diseño">Patrones Básicos de Diseño </h2>
<p>El trabajo con bases de datos en aplicaciones orientadas a objetos puede beneficiarse de la aplicación de patrones de diseño. Estos patrones proporcionan soluciones probadas y eficaces a problemas comunes en el desarrollo de software.</p>
<p>Entre los más básicos es utilizar el <strong>patrón DAO</strong> con <strong>operaciones CRUD</strong>, modelando las <strong>tablas a través de clases</strong>.</p>
<p>Vamos a verlo a través de la modificación del caso de estudio anterior.</p>
<h3 id="modelando-los-datos-en-entidades">Modelando los datos en entidades </h3>
<p>En primer lugar crearemos una clase llama <strong><code>Libro</code></strong> que modelará la tabla <strong><code>libro</code></strong> definida. A esta clase la denominaremos <strong>entidad</strong>.</p>
<pre data-role="codeBlock" data-info="sql" class="language-sql sql"><code><span class="token keyword keyword-CREATE">CREATE</span> <span class="token keyword keyword-TABLE">TABLE</span> libro <span class="token punctuation">(</span>
    id <span class="token keyword keyword-INTEGER">INTEGER</span> <span class="token keyword keyword-PRIMARY">PRIMARY</span> <span class="token keyword keyword-KEY">KEY</span> AUTOINCREMENT<span class="token punctuation">,</span>
    titulo <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    autor <span class="token keyword keyword-VARCHAR">VARCHAR</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Aunque nosotros la vamos a llamar <strong><code>Libro</code></strong> en algunos casos se le puede llamar <strong><code>LibroEntity</code></strong> y definirse también usando un <strong><code>record</code></strong>.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">Libro</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-int">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> Titulo <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-string">string</span></span> Autor <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token keyword keyword-set">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="definiendo-un-dao">Definiendo un DAO </h3>
<p><strong>DAO</strong> (<strong>Data Access Object</strong>) es un patrón de diseño que se utiliza para abstraer la capa de acceso a datos de una aplicación. Este patrón permite separar la lógica de negocio de la lógica de acceso a datos, facilitando el mantenimiento y la escalabilidad del código.</p>
<p>Podemos decir que la lógica de negocio se encuentra en las entidades, en nuestro ejemplo la clase <strong><code>Libro</code></strong> y la lógica de acceso a datos en los DAOs.</p>
<p>De tal manera que desde la vista (la consola) solo se interactuará con las entidades y no con la base de datos directamente.</p>
<p>Primero vamos ha definir la clase <strong><code>LibroDAO</code></strong> que contendrá una propiedad de tipo <strong><code>SqliteConnection</code></strong> y un constructor que reciba la cadena de conexión y la abra. Además, implementará la interfaz <strong><code>IDisposable</code></strong> para cerrar la conexión y poder usar la cláusula <strong><code>using</code></strong> a la hora de crear un objeto de esta clase.</p>
<p>Por tanto, todas las operaciones sobre la BD, se realizarán usando la misma conexión.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-class">class</span> <span class="token class-name">LibroDAO</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IDisposable</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-private">private</span> <span class="token return-type class-name">SqliteConnection<span class="token punctuation">?</span></span> Conexion <span class="token punctuation">{</span> <span class="token keyword keyword-get">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token function">LibroDAO</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> cadenaConexion<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Conexion <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteConnection</span><span class="token punctuation">(</span>cadenaConexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
        Conexion<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span>Conexion <span class="token operator">!=</span> <span class="token keyword keyword-null">null</span> <span class="token operator">&amp;&amp;</span> Conexion<span class="token punctuation">.</span>State <span class="token operator">!=</span> ConnectionState<span class="token punctuation">.</span>Closed<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Conexion<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<h4 id="implementando-las-operaciones-crud">Implementando las operaciones CRUD </h4>
<p><strong>CRUD</strong> es el acrónimo de <strong>Create</strong>, <strong>Read</strong>, <strong>Update</strong> y <strong>Delete</strong>, que son las operaciones básicas que se pueden realizar sobre una base de datos. Estas operaciones trabajarán sobre objetos de la capa de negocio, en nuestro caso con objetos de la clase <strong><code>Libro</code></strong>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Inicialmente, nosotros vamos ha usar los nombres de los métodos en inglés, pero no tienen porque estar en inglés o incluso podemos utilizar sinónimos de los mismos. Por ejemplo, en lugar de <strong><code>Create</code></strong> podríamos utilizar <strong><code>Insert</code></strong>.</p>
</div>
<h5 id="create-o-insert">Create o Insert </h5>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Create</span><span class="token punctuation">(</span><span class="token class-name">Libro</span> libro<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> insertarDatos <span class="token operator">=</span> <span class="token string">"INSERT INTO libro (titulo, autor) VALUES (@titulo, @autor)"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteCommand</span><span class="token punctuation">(</span>insertarDatos<span class="token punctuation">,</span> Conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@titulo"</span><span class="token punctuation">,</span> libro<span class="token punctuation">.</span>Titulo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@autor"</span><span class="token punctuation">,</span> libro<span class="token punctuation">.</span>Autor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>Si nos fijamos en el método <strong><code>Create</code></strong>, recibe un objeto de la clase <strong><code>Libro</code></strong> y lo inserta en la tabla <strong><code>libro</code></strong>. Encapsulando la lógica de acceso a datos. En nuestro caso la consulta <strong>SQL</strong> de inserción.</p>
<div style="page-break-after:always;"></div>
<h5 id="read">Read </h5>
<p><strong><code>List&lt;Libro&gt; Read()</code></strong> sería el método más básico de lectura es el que nos devuelve todos los registros de la tabla. Una posible implementación sería la siguiente.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>Libro<span class="token punctuation">&gt;</span></span> <span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">List<span class="token punctuation">&lt;</span>Libro<span class="token punctuation">&gt;</span></span> libros <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> verLibros <span class="token operator">=</span> <span class="token string">"SELECT * FROM libro"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> query <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteCommand</span><span class="token punctuation">(</span>verLibros<span class="token punctuation">,</span> Conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> rs <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        libros<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Libro</span>
        <span class="token punctuation">{</span>
            Id <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>rs<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            Titulo <span class="token operator">=</span> rs<span class="token punctuation">[</span><span class="token string">"titulo"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">,</span>
            Autor <span class="token operator">=</span> rs<span class="token punctuation">[</span><span class="token string">"autor"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-return">return</span> libros<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>También es interesante tener un método <strong><code>Read</code></strong> que nos devuelva un libro por su <strong><code>id</code></strong> o por su <strong><code>titulo</code></strong> para realizar búsquedas simples. En las siguientes propuestas <strong><code>Libro</code></strong> es un tipo <strong>nullable</strong> para poder devolver <strong><code>null</code></strong> en caso de que no se encuentre el libro.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token return-type class-name">Libro<span class="token punctuation">?</span></span> <span class="token function">Read</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-int">int</span></span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> verLibro <span class="token operator">=</span> <span class="token string">"SELECT * FROM libro WHERE id = @id"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> query <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteCommand</span><span class="token punctuation">(</span>verLibro<span class="token punctuation">,</span> Conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@id"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> rs <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> rs<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">?</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Libro</span>
    <span class="token punctuation">{</span>
        Id <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>rs<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Titulo <span class="token operator">=</span> rs<span class="token punctuation">[</span><span class="token string">"titulo"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">,</span>
        Autor <span class="token operator">=</span> rs<span class="token punctuation">[</span><span class="token string">"autor"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
    <span class="token punctuation">}</span> 
    <span class="token punctuation">:</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token return-type class-name">Libro<span class="token punctuation">?</span></span> <span class="token function">Read</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> titulo<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> verLibro <span class="token operator">=</span> <span class="token string">"SELECT * FROM libro WHERE titulo = @titulo"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> query <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteCommand</span><span class="token punctuation">(</span>verLibro<span class="token punctuation">,</span> Conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    query<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@titulo"</span><span class="token punctuation">,</span> titulo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> rs <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword keyword-return">return</span> rs<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">?</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Libro</span>
    <span class="token punctuation">{</span>
        Id <span class="token operator">=</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>rs<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Titulo <span class="token operator">=</span> rs<span class="token punctuation">[</span><span class="token string">"titulo"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">,</span>
        Autor <span class="token operator">=</span> rs<span class="token punctuation">[</span><span class="token string">"autor"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span>
    <span class="token punctuation">}</span> 
    <span class="token punctuation">:</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<h5 id="read-de-proyecciones-y-agregaciones-usando-dto">Read de proyecciones y agregaciones usando DTO </h5>
<p><strong>DTO</strong> (<strong>Data Transfer Object</strong>) es un patrón de diseño que se utiliza para transferir datos entre subsistemas de un software. En el contexto de acceso a datos, un <strong>DTO</strong> es un objeto que se utiliza para transferir datos entre la capa de acceso a datos y la capa de presentación o lógica de negocio.</p>
<p>Por ejemplo, si queremos obtener el número de libros por autor, podemos crear un <strong>DTO</strong> llamado <strong><code>LibrosPorAutorDTO</code></strong> que contenga el nombre del autor y el número de libros que ha escrito.</p>
<p>En este caso, utilizaremos un <strong><code>record</code></strong> para definir el <strong>DTO</strong> sería la opción más adecuada.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-record">record</span> <span class="token class-name">LibrosPorAutorDTO</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-string">string</span></span> Autor<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword keyword-int">int</span></span> Titulos<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword keyword-public">public</span> <span class="token return-type class-name">List<span class="token punctuation">&lt;</span>LibrosPorAutorDTO<span class="token punctuation">&gt;</span></span> <span class="token function">ReadLibrosPorAutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> verLibros <span class="token operator">=</span> <span class="token string">""</span>"
        <span class="token class-name">SELECT</span> autor<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> AS cantidad
        FROM libro
        GROUP BY autor
        ORDER BY cantidad DESC
        <span class="token string">""</span>"<span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> query <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteCommand</span><span class="token punctuation">(</span>verLibros<span class="token punctuation">,</span> Conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> rs <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List<span class="token punctuation">&lt;</span>LibrosPorAutorDTO<span class="token punctuation">&gt;</span></span> librosXAutor <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        librosXAutor<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">LibrosPorAutorDTO</span><span class="token punctuation">(</span>
            <span class="token named-parameter punctuation">Autor</span> <span class="token punctuation">:</span> rs<span class="token punctuation">[</span><span class="token string">"autor"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">,</span>
            <span class="token named-parameter punctuation">Titulos</span> <span class="token punctuation">:</span> Convert<span class="token punctuation">.</span><span class="token function">ToInt32</span><span class="token punctuation">(</span>rs<span class="token punctuation">[</span><span class="token string">"cantidad"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-return">return</span> librosXAutor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<h5 id="update">Update </h5>
<p>En la siguiente propuesta de implementación del método <strong><code>Update</code></strong>, recibe el libro a actualizar y definimos una precondición que es que el libro tenga un <strong><code>id</code></strong> existente en la tabla.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token class-name">Libro</span> libro<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">Read</span><span class="token punctuation">(</span>libro<span class="token punctuation">.</span>Id<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ArgumentException</span><span class="token punctuation">(</span><span class="token string">"El libro no tiene un ID válido"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> actualizarDatos <span class="token operator">=</span> <span class="token string">"UPDATE libro SET titulo = @titulo, autor = @autor WHERE id = @id"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteCommand</span><span class="token punctuation">(</span>actualizarDatos<span class="token punctuation">,</span> Conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@titulo"</span><span class="token punctuation">,</span> libro<span class="token punctuation">.</span>Titulo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@autor"</span><span class="token punctuation">,</span> libro<span class="token punctuation">.</span>Autor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@id"</span><span class="token punctuation">,</span> libro<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h5 id="delete">Delete </h5>
<p>En la siguiente propuesta de implementación del método <strong><code>Delete</code></strong>, recibe el <strong><code>id</code></strong> del libro a borrar y como en el caso anterior definimos una precondición que es que el libro tenga un <strong><code>id</code></strong> existente en la tabla.</p>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword keyword-int">int</span></span> id<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">Read</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword keyword-null">null</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">ArgumentException</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"El id </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">id</span><span class="token punctuation">}</span></span><span class="token string"> no existe en la base de datos"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name"><span class="token keyword keyword-string">string</span></span> borrarDatos <span class="token operator">=</span> <span class="token string">"DELETE FROM libro WHERE id = @id"</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-using">using</span> <span class="token class-name"><span class="token keyword keyword-var">var</span></span> comando <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">SqliteCommand</span><span class="token punctuation">(</span>borrarDatos<span class="token punctuation">,</span> Conexion<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@id"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    comando<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div style="page-break-after:always;"></div>
<h3 id="uso-de-los-daos">Uso de los DAOs </h3>
<p>Puedes bajarte el código completo del ejemplo en el <strong><a href="assets/codigo/sqlite_una_tabla_ejemplo_DAO_ejemplo.cs">siguiente enlace</a></strong>:</p>
<ol>
<li>Fíjate que usamos <strong><code>using</code></strong> al definir el <strong><code>LibroDAO</code></strong> para asegurarnos de que la conexión se cierra correctamente.</li>
<li>Seguimos manteniendo el método <strong><code>CrearTablaLibros</code></strong> porque las operaciones <strong>DDL</strong> no tienen sentido que las realice el <strong>DAO</strong>.</li>
</ol>
<pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code><span class="token keyword keyword-public">public</span> <span class="token keyword keyword-static">static</span> <span class="token return-type class-name"><span class="token keyword keyword-void">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword keyword-try">try</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword keyword-string">string</span></span> cadenaConexion <span class="token operator">=</span> <span class="token string">"Data Source=biblioteca_1t.db"</span><span class="token punctuation">;</span>
        <span class="token function">CrearTablaLibros</span><span class="token punctuation">(</span>cadenaConexion<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword keyword-using">using</span> <span class="token class-name">LibroDAO</span> libroDAO <span class="token operator">=</span> <span class="token keyword keyword-new">new</span><span class="token punctuation">(</span>cadenaConexion<span class="token punctuation">)</span><span class="token punctuation">;</span>

        libroDAO<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Libro</span> <span class="token punctuation">{</span> 
            Titulo <span class="token operator">=</span> <span class="token string">"Macbeth"</span><span class="token punctuation">,</span> 
            Autor <span class="token operator">=</span> <span class="token string">"William Shakespeare"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        libroDAO<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Libro</span> <span class="token punctuation">{</span> 
            Titulo <span class="token operator">=</span> <span class="token string">"20.000 Leguas de Viaje Submarino"</span><span class="token punctuation">,</span> 
            Autor <span class="token operator">=</span> <span class="token string">"Julio Verne"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">MostrarLibros</span><span class="token punctuation">(</span>libroDAO<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Creando Hamlet..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        libroDAO<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Libro</span> <span class="token punctuation">{</span> 
            Titulo <span class="token operator">=</span> <span class="token string">"Hamlet"</span><span class="token punctuation">,</span> 
            Autor <span class="token operator">=</span> <span class="token string">"Julio Verne"</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">MostrarLibros</span><span class="token punctuation">(</span>libroDAO<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><pre data-role="codeBlock" data-info="csharp" class="language-csharp csharp"><code>        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Modificando Hamlet..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Libro</span> hamlet <span class="token operator">=</span> libroDAO<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token string">"Hamlet"</span><span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">;</span>
        hamlet<span class="token punctuation">.</span>Autor <span class="token operator">=</span> <span class="token string">"William Shakespeare"</span><span class="token punctuation">;</span>
        libroDAO<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>hamlet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">MostrarLibros</span><span class="token punctuation">(</span>libroDAO<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Borrando Hamlet..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        libroDAO<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>hamlet<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">MostrarLibros</span><span class="token punctuation">(</span>libroDAO<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Insertando Sueño de una noche de verano..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        libroDAO<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token keyword keyword-new">new</span> <span class="token constructor-invocation class-name">Libro</span> <span class="token punctuation">{</span> 
            Titulo <span class="token operator">=</span> <span class="token string">"Sueño de una noche de verano"</span><span class="token punctuation">,</span> 
            Autor <span class="token operator">=</span> <span class="token string">"William Shakespeare"</span> 
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">MostrarLibros</span><span class="token punctuation">(</span>libroDAO<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Consultando libros por autor..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">MostrarLibrosPorAutor</span><span class="token punctuation">(</span>libroDAO<span class="token punctuation">.</span><span class="token function">ReadLibrosPorAutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token keyword keyword-catch">catch</span> <span class="token punctuation">(</span><span class="token class-name">SqliteException</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
      </div>
      
      
    
    
    
    
    
    
  
    </body></html>